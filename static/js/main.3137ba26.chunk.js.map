{"version":3,"sources":["../node_modules/peerjs/dist sync","components/socket/constants.js","utils/Context.js","api/Api.js","components/redux/usersReducer.js","components/redux/appReducer.js","components/common/navbar/NavBar.js","components/redux/store.js","assets/src/preloader/preloader.gif","components/socket/socketForAVChat.js","components/common/chat/chat-control-btns/ChatControlButtons.js","components/common/chat/chat-bar/tab-panel/tab-panel-element/VoiceTabPanel.js","utils/TimeFormatter.js","components/common/chat/chat-bar/tab-panel/tab-panel-element/TextTabPanel.js","components/common/chat/chat-bar/tab-panel/tab-panel-element/UsersTabPanel.js","components/common/chat/chat-bar/tab-panel/TabPanelContainer.js","components/common/chat/chat-bar/ChatBar.js","assets/src/media/icons/voiceChatTabNotActiveIcon.png","assets/src/media/icons/voiceChatTabActiveIcon.png","assets/src/media/icons/textChatTabNotActiveIcon.png","assets/src/media/icons/textChatTabActiveIcon.png","assets/src/media/icons/usersTabNotActiveIcon.png","assets/src/media/icons/usersTabActiveIcon.png","components/common/chat/Сhat.js","utils/audioVideoContent/AudioVideoInitiator.js","components/common/peer/Peer.js","utils/audioVideoContent/VideoCreator.js","utils/audioVideoContent/ScreenShareInitiator.js","App.js","reportWebVitals.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","mainServerRoot","WSSSContext","createContext","VoiceChatButtonsContext","instance","Axios","baseURL","authAPI","get","SET_USER_DATA","GET_CURRENT_USERS_LIST","USER_JOINED","USER_LEFT","initialState","users","self","session_uuid","user_id","user_uuid","email","avatar","first_name","secon_name","last_name","phone","birthday","sex","company_uuid","company_name","company_position","company_role","system_role","isAuth","setAuthUserData","payload","type","INITIALIZED_SUCCESS","ON_LINK_GOTTEN","GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT","GET_OUTPUT_PLAYER_SCREEN_FROM_SERVER","initialized","linkIsFetched","linkForSS","onDialog","outputPlayerVoiceFromClient","outputPlayerScreemFromSS","makeStyles","theme","root","flexGrow","menuButton","marginRight","spacing","title","reducers","combineReducers","app","state","action","voice","screen","link","user","filter","u","uuid","userUuid","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunkMiddleware","__store__","startSocketIO","socket","peer","connectAndCall","disconnectFromPeer","current","io","on","console","log","setTimeout","connected","arg","args","useStyles","icon","height","width","reactmic","flex","ChatControlButtons","useContext","isAudio","setIsAudio","isVideo","setIsVideo","isScreen","startCapture","stopCapture","classes","sx","marginLeft","display","flexDirection","justifyContent","position","right","bottom","Tooltip","placement","IconButton","onClick","style","color","className","arr","toolbarRoot","backgroundColor","padding","borderTop","boxShadow","minHeight","standTitle","fontWeight","fontSize","textAlign","standName","speaker","border","VoiceTabPanel","useState","anchorEl","setAnchorEl","handleClick","event","currentTarget","handleClose","open","Boolean","undefined","Drawer","flexShrink","boxSizing","background","variant","anchor","zIndex","drawer","Typography","noWrap","component","Divider","List","marginTop","map","text","index","ListItem","disablePadding","secondaryAction","edge","ListItemButton","ListItemText","primary","secondary","Popover","onClose","PaperProps","borderRadius","anchorPosition","top","left","anchorOrigin","vertical","horizontal","transformOrigin","MenuItem","Box","timeFormatHelper","value","drawerWidth","myMessage","incomeMessage","CssTextField","styled","TextField","borderBottomColor","borderColor","TextTabPanel","messageBox","useRef","messages","setMessages","me","handleSendMessage","preventDefault","emit","useEffect","mess","from","peerUUID","currentMinutes","Date","getMinutes","currentHour","getHours","message","overflowY","dataObj","align","onSubmit","m","noValidate","autoComplete","label","inputProps","paddingRight","ref","BootstrapButton","Button","textTransform","lineHeight","fontFamily","join","ColorButton","CustomizedButtons","Stack","direction","UsersTabPanel","boxStyles","margin","TabPanelContainer","panelType","TabPanel","props","children","other","role","hidden","p","chatBarHeaderArr","notActiveTabIcon","src","activeTabIcon","panelTypes","common","selected","ChatBar","useTheme","React","setValue","borderRight","Tabs","TabIndicatorProps","onChange","newValue","textColor","el","idx","Tab","fontStyle","letterSpacing","axis","onChangeIndex","dir","Chat","getUsersFromStore","setIsScreen","userUUID","sessionToken","socketId","setSocketId","videoData","connections","setConnections","setPeer","innerStream","setInnnerStream","currentPeer","setCurrentPeer","peerIDsList","setPeerIDsList","setButtonDisabled","connect","path","setUserFromSocket","videoContainer","navigator","mediaDevices","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","video","noiseSuppression","min","ideal","max","audio","echoCancellation","then","stream","peerID","split","Peer","host","debug","port","secure","initializePeerConnection","call","answer","remoteStream","setRemoteStream","connection","err","includes","myId","createObj","videoDestination","whoseVideo","roomContainer","document","createElement","classList","add","srcObject","autoplay","controls","muted","append","createVideo","peerConnection","peerId","remove","close","conn","getDisplayMedia","cursor","videoTrack","getVideoTracks","onended","forEach","getSenders","find","s","track","kind","replaceTrack","catch","remotePeerId","enabled","getAudioTracks","voiceChatCtx","setVoiceChatCtx","Provider","Grid","flexWrap","alignItems","App","dispatch","useDispatch","a","promise","response","data","Promise","all","lobbyUUID","contextWSSS","setContextWSSS","useSelector","getConnectionType","useMemo","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.3137ba26.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 247;","//variable for main root because of GHP deploy. \r\n//Probably needs to be switched to '/'\r\nexport const mainRoot = '/chat';\r\nexport const mainServerRoot = 'getway.dev.viexpo.ru';\r\nexport const pathForPeer = '/sound/peer';\r\nexport const pathForWebSocket = '/sound/socket.io';\r\n\r\nexport const getWayWebSocket = \"wss://getway.dev.viexpo.ru/service/getway\";\r\n\r\n\r\nexport const CONST_X_VIEXPO_INTERNAL_TOKEN = 'x-viexpo-internal-token-test'\r\nexport const CONST_X_VIEXPO_SESSION_TOKEN_BODY = 'x-viexpo-session-token'\r\n\r\nexport const ToGetway_FromUnknown_AuthSocket = 0;\r\nexport const FromGetway_AuthSocket_Response = 1;\r\nexport const ToGetway_FromInternal_GetUser = 2;\r\nexport const ToGetway_FromInternal_GetUserFromSession = 3;\r\nexport const FromGetway_ToInternal_GetUserResponse = 4;\r\nexport const ToGetway_FromPlayer_GetMovementServer = 5;\r\nexport const FromGetway_FromPlayer_GetMovementServerResponse = 6;\r\nexport const ToGetway_FromPlayer_GetSoundServer = 7;\r\nexport const FromGetway_FromPlayer_GetSoundServerResponse = 8;\r\n\r\n\r\nexport const ToMovement_ToPlayerScene_PlayerTick = 9991;\r\nexport const FromMovement_FromPlayerScene_PlayerJoin = 9992;\r\nexport const FromMovement_FromPlayerScene_PlayerLeave = 9993;\r\nexport const FromMovement_FromPlayerScene_PlayerList = 9994;\r\nexport const FromMovement_FromPlayerScene_PlayerPosition = 9995;\r\nexport const FromSound_FromPlayerScene_PlayerVoice = 9996;\r\n\r\nexport const timeInterval = 1000;\r\n\r\n","import React, { createContext } from \"react\";\r\n\r\nexport const WSSSContext = createContext();\r\n\r\nexport const VoiceChatButtonsContext = createContext();","import * as Axios from 'axios';\r\n\r\n//axios base setup\r\nlet instance = Axios.create({\r\n\tbaseURL: 'https://getway.dev.viexpo.ru/api/',\r\n\t// headers: {\r\n\t// \t'x-viexpo-tenant': '0',\r\n\t// }\r\n});\r\n\r\nexport const authAPI = {\r\n\tme() {\r\n\t\treturn instance.get('account/fake/get')\r\n\t}\r\n}","import { authAPI } from \"../../api/Api\";\r\n\r\nconst SET_USER_DATA = 'SET_USER_DATA';\r\nconst GET_CURRENT_USERS_LIST = 'GET_CURRENT_USERS_LIST';\r\nconst USER_JOINED = 'USER_JOINED';\r\nconst USER_LEFT = 'USER_LEFT';\r\n\r\nconst initialState = {\r\n\tusers: [],\r\n\tself: {\r\n\t\tsession_uuid: \"\",\r\n\t\tuser_id: null,\r\n\t\tuser_uuid: \"\",\r\n\t\temail: \"\",\r\n\t\tavatar: \"\",\r\n\t\tfirst_name: \"\",\r\n\t\tsecon_name: \"\",\r\n\t\tlast_name: \"\",\r\n\t\tphone: \"\",\r\n\t\tbirthday: \"\",\r\n\t\tsex: \"\",\r\n\t\tcompany_uuid: \"\",\r\n\t\tcompany_name: \"\",\r\n\t\tcompany_position: \"\",\r\n\t\tcompany_role: null,\r\n\t\tsystem_role: null\r\n\t},\r\n\tisAuth: false\r\n}\r\n\r\nexport const usersReducer = (state = initialState, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase SET_USER_DATA:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tself: { ...action.payload },\r\n\t\t\t\tisAuth: true\r\n\t\t\t};\r\n\t\tcase GET_CURRENT_USERS_LIST:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tusers: action.users\r\n\t\t\t};\r\n\t\tcase USER_JOINED:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tusers: [...state.users, action.user]\r\n\t\t\t};\r\n\t\tcase USER_LEFT:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tusers: state.users.filter(u => u.uuid != action.userUuid)\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn state\r\n\t}\r\n}\r\n\r\n//ac\r\n\r\nexport const setAuthUserData = payload => ({ type: SET_USER_DATA, payload })\r\nexport const setUsersFromList = users => ({ type: GET_CURRENT_USERS_LIST, users })\r\nexport const setUserJoined = user => ({ type: USER_JOINED, user })\r\nexport const setUserLeft = userUuid => ({ type: USER_LEFT, userUuid })\r\n\r\n//thunk\r\nexport const getAuthUserData = () => async (dispatch) => {\r\n\tlet response = await authAPI.me();\r\n\r\n\tif (response.data.code === 0) {\r\n\t\tlet payload = response.data.response.user\r\n\t\tdispatch(setAuthUserData(payload))\r\n\t}\r\n}","import { getAuthUserData } from \"./usersReducer\";\r\n\r\nconst INITIALIZED_SUCCESS = 'INITIALIZED_SUCCESS';\r\nconst TOKEN_USER_UUID_GOTTEN = 'TOKEN_USER_UUID_GOTTEN';\r\nconst ON_LINK_GOTTEN = 'ON_LINK_GOTTEN';\r\nconst GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT = 'GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT';\r\nconst GET_OUTPUT_PLAYER_SCREEN_FROM_SERVER = 'GET_OUTPUT_PLAYER_SCREEN_FROM_SERVER';\r\n\r\n\r\nlet initialState = {\r\n\tinitialized: false,\r\n\tlinkIsFetched: false,\r\n\tlinkForSS: '',\r\n\ttype: 1,\r\n\tonDialog: false,\r\n\toutputPlayerVoiceFromClient: null,\r\n\toutputPlayerScreemFromSS: null\r\n}\r\n\r\nexport const appReducer = (state = initialState, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase INITIALIZED_SUCCESS:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tinitialized: true\r\n\t\t\t};\r\n\t\tcase GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\toutputPlayerVoiceFromClient: action.voice\r\n\t\t\t}\r\n\t\tcase GET_OUTPUT_PLAYER_SCREEN_FROM_SERVER:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\toutputPlayerScreemFromSS: action.screen\r\n\t\t\t}\r\n\t\tcase ON_LINK_GOTTEN:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tlinkIsFetched: true,\r\n\t\t\t\tlinkForSS: action.link,\r\n\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state\r\n\t}\r\n}\r\n\r\n//AC\r\nexport const setInitializedSuccess = () => ({ type: INITIALIZED_SUCCESS });\r\nexport const setLinkForSS = (link) => ({ type: ON_LINK_GOTTEN, link })\r\n// export const toggleOnDialog = () => ({ type: ON_DIALOG })\r\n// export const setOutputPlayerVoiceFromClient = (voice) => ({ type: GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT, voice })\r\nexport const setOutputPlayerScreenFromSS = (screen) => ({ type: GET_OUTPUT_PLAYER_SCREEN_FROM_SERVER, screen })\r\n\r\n//thunk\r\nexport const initializeApp = () => async (dispatch) => {\r\n\tlet promise = dispatch(getAuthUserData());\r\n\r\n\tPromise.all([promise]).then(() => {\r\n\t\tdispatch(setInitializedSuccess());\r\n\t})\r\n\r\n}","import { BufferStream } from \"buffer-stream-js\";\r\nimport React, { useCallback, useContext, useEffect, useMemo, useState } from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport MenuIcon from \"@mui/icons-material/Menu\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport Backdrop from '@mui/material/Backdrop';\r\nimport Box from '@mui/material/Box';\r\nimport Modal from '@mui/material/Modal';\r\nimport Fade from '@mui/material/Fade';\r\n\r\nimport {\r\n\tToGetway_FromUnknown_AuthSocket,\r\n\tToMovement_ToPlayerScene_PlayerTick,\r\n\tFromMovement_FromPlayerScene_PlayerJoin,\r\n\tFromMovement_FromPlayerScene_PlayerLeave,\r\n\tFromMovement_FromPlayerScene_PlayerList,\r\n\tFromSound_FromPlayerScene_PlayerVoice\r\n} from \"../../socket/constants.js\";\r\nimport { WSSSContext } from \"../../../utils/Context\";\r\nimport { setUserLeft, setUserJoined, setUsersFromList } from '../../redux/usersReducer.js';\r\nimport { WSTransferTest } from './WSTransferTest.js';\r\nimport { setOutputPlayerScreenFromSS } from \"../../redux/appReducer.js\";\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\troot: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\tmenuButton: {\r\n\t\tmarginRight: theme.spacing(2)\r\n\t},\r\n\ttitle: {\r\n\t\tflexGrow: 1\r\n\t},\r\n}));\r\nconst style = {\r\n\tposition: 'absolute',\r\n\ttop: '6%',\r\n\tright: '10%',\r\n\twidth: 400,\r\n\tmaxHeight: '70vh',\r\n\tbgcolor: 'background.paper',\r\n\tboxShadow: 24,\r\n\tp: 4,\r\n\tborder: '1px solid grey',\r\n\toverflow: 'auto'\r\n};\r\n\r\nfunction isWSOpen(ws) {\r\n\treturn ws.readyState === 1\r\n}\r\n\r\nconst readPlayerFromPlayerList = (\r\n\tbuffer,\r\n\tstartOffset,\r\n\thasPosition = false\r\n) => {\r\n\tconst userUUIDLen = hasPosition === true ? 0 : 36;\r\n\r\n\tlet uuid = \"\";\r\n\tif (hasPosition === false) {\r\n\t\tbuffer.offset = startOffset;\r\n\t\tuuid = buffer.readUtf8String(userUUIDLen);\r\n\t}\r\n\tbuffer.offset = startOffset + userUUIDLen + 0;\r\n\tconst id = buffer.readUInt32LE();\r\n\r\n\tconst position = {\r\n\t\tx: 0,\r\n\t\ty: 0,\r\n\t\tz: 0,\r\n\t};\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 0;\r\n\tposition.x = buffer.readFloatLE();\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 4;\r\n\tposition.y = buffer.readFloatLE();\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 8;\r\n\tposition.z = buffer.readFloatLE();\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 12;\r\n\tconst state = buffer.readUInt8();\r\n\r\n\treturn {\r\n\t\tuuid: uuid,\r\n\t\tid: id,\r\n\t\tposition: position,\r\n\t\tstate: state\r\n\t};\r\n};\r\n\r\n// function Video(src, append) {\r\n// \tvar v = document.createElement(\"video\");\r\n// \tif (src != \"\") {\r\n// \t\tv.src = src;\r\n// \t}\r\n// \tif (append == true) {\r\n// \t\tdocument.body.appendChild(v);\r\n// \t}\r\n// \treturn v;\r\n// }\r\n\r\n// You can then use it like this:\r\n\r\n// var video = new Video(\"YOUR_VIDEO_URL\", true);\r\n// // do whatever you want...\r\n// video.height = 280;\r\n// video.width = 500;\r\n// video.controls = \"controls\";\r\n// video.play();\r\n\r\nlet outputPlayerVoice = blobForPlay => {\r\n\tconst outputBlob = new Blob([blobForPlay], {\r\n\t\ttype: \"audio/webm;codecs=opus\",\r\n\t});\r\n\tconst fileReader = new FileReader();\r\n\tfileReader.readAsDataURL(outputBlob);\r\n\tfileReader.onloadend = () => {\r\n\r\n\t\tconst base64String = fileReader.result;\r\n\r\n\t\tconst audio = new Audio(base64String);\r\n\t\taudio.addEventListener('canplay', () => {\r\n\t\t\taudio.play();\r\n\t\t})\r\n\t};\r\n}\r\n\r\nexport const NavBar = ({ getUsersFromStore, setScreenBlob, record }) => {\r\n\tconst classes = useStyles();\r\n\r\n\tconst [openModal, setOpenModal] = useState(false);\r\n\tconst handleOpen = () => setOpenModal(true);\r\n\tconst handleClose = () => setOpenModal(false);\r\n\r\n\tconst [connected, setConnected] = useState(false);\r\n\r\n\tconst dispatch = useDispatch();\r\n\r\n\tconst { linkForSS, sessionTokenForSS, userUUID, getConnectionType, lobbyUUID } = useContext(WSSSContext)\r\n\r\n\tlet webSocketSS = null;\r\n\r\n\t//get self uuid\r\n\r\n\tconst [users, setUsers] = useState([])\r\n\tuseEffect(() => {\r\n\t\tif (linkForSS) start();\r\n\r\n\t\tfunction start() {\r\n\r\n\t\t\tconst linkSS = linkForSS ? linkForSS : console.log('Fetching the link...');\r\n\r\n\t\t\twebSocketSS = new WebSocket(linkSS);\r\n\t\t\t// получить вс из пропсов\r\n\r\n\t\t\t// if (webSocket) {\r\n\t\t\t// \twebSocket.current = webSocketSS;\r\n\t\t\t// }\r\n\t\t\twindow.webSocketSS = webSocketSS;\r\n\t\t\twebSocketSS.binaryType = \"arraybuffer\";\r\n\r\n\t\t\twebSocketSS.onopen = () => {\r\n\t\t\t\tconst array = new Uint8Array(4 + 36 + 1 + 36)\r\n\r\n\t\t\t\tconst methodBuffer = new Uint8Array(new Uint32Array([ToGetway_FromUnknown_AuthSocket]).buffer)\r\n\t\t\t\tconst sessionBuffer = new TextEncoder().encode(sessionTokenForSS)\r\n\t\t\t\tconst locationUUIDBuffer = new TextEncoder().encode(lobbyUUID) // 36 LEN частное лобби или общее\r\n\t\t\t\tarray.set(methodBuffer, 0)\r\n\t\t\t\tarray.set(sessionBuffer, 4)\r\n\t\t\t\tarray.set(new Uint8Array([getConnectionType]), 4 + 36)\r\n\t\t\t\tarray.set(locationUUIDBuffer, 4 + 36 + 1)\r\n\r\n\t\t\t\twebSocketSS.send(array);\r\n\r\n\t\t\t\tif (webSocketSS.readyState === 1) {\r\n\t\t\t\t\tsetConnected(true)\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\r\n\t\t\twebSocketSS.onmessage = buffer => {\r\n\r\n\t\t\t\tconst message = new BufferStream(buffer.data);\r\n\t\t\t\tmessage.offset = 0;\r\n\t\t\t\tconst method = message.readInt32LE();\r\n\t\t\t\tswitch (method) {\r\n\t\t\t\t\tcase FromMovement_FromPlayerScene_PlayerList:\r\n\t\t\t\t\t\tmessage.offset = 4;\r\n\t\t\t\t\t\tconst countPlayers = message.readUInt32LE();\r\n\r\n\t\t\t\t\t\tconst users = [];\r\n\t\t\t\t\t\tfor (let index = 0; index < countPlayers; index++) {\r\n\t\t\t\t\t\t\tconst user = readPlayerFromPlayerList(\r\n\t\t\t\t\t\t\t\tmessage,\r\n\t\t\t\t\t\t\t\t4 /* Method */ +\r\n\t\t\t\t\t\t\t\t4 /* Count */ +\r\n\t\t\t\t\t\t\t\tindex *\r\n\t\t\t\t\t\t\t\t(36 /* UUID */ +\r\n\t\t\t\t\t\t\t\t\t4 /* ID */ +\r\n\t\t\t\t\t\t\t\t\t(4 + 4 + 4) /* Position */ +\r\n\t\t\t\t\t\t\t\t\t1) /* Flags */\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tif (user.uuid === userUUID) {\r\n\t\t\t\t\t\t\t\tconsole.log('the uuid is the same');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tusers.push(user);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdispatch(setUsersFromList(users))\r\n\r\n\t\t\t\t\t\tconsole.log(JSON.stringify(users));\r\n\r\n\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\"Method: FromMovement_FromPlayerScene_PlayerList, count: \" +\r\n\t\t\t\t\t\t\tcountPlayers,\r\n\t\t\t\t\t\t\tusers\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase FromMovement_FromPlayerScene_PlayerJoin:\r\n\t\t\t\t\t\tconst user = readPlayerFromPlayerList(message, 4);\r\n\t\t\t\t\t\tconsole.log(\"User Join: \" + user.uuid);\r\n\t\t\t\t\t\tdispatch(setUserJoined(user))\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase FromMovement_FromPlayerScene_PlayerLeave:\r\n\t\t\t\t\t\tmessage.offset = 4;\r\n\t\t\t\t\t\tconst uuid = message.readUtf8String(36);\r\n\t\t\t\t\t\tconsole.log(\"User Leave: \" + uuid);\r\n\t\t\t\t\t\tdispatch(setUserLeft(uuid))\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase FromSound_FromPlayerScene_PlayerVoice:\r\n\t\t\t\t\t\tconst user_from_voice = readPlayerFromPlayerList(message, 4, true);\r\n\t\t\t\t\t\t// Parse Voice Body\r\n\t\t\t\t\t\tconst voiceBody = new Uint8Array(message.buffer.buffer, 21);\r\n\t\t\t\t\t\t// Play Voice Body\r\n\t\t\t\t\t\toutputPlayerVoice(voiceBody);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.log(\"Method: Unknown\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(\"WebSocket message received:\", method);\r\n\r\n\t\t\t};\r\n\r\n\t\t\twebSocketSS.onclose = (e) => {\r\n\t\t\t\tconsole.log('Sound Server Socket closed. Trying to reconnect...');\r\n\t\t\t\tconsole.log('Server closed with code => ', e.code);\r\n\r\n\t\t\t\tif (webSocketSS.readyState !== 1) {\r\n\t\t\t\t\tsetConnected(false)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (e.code !== 1005) {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tstart()\r\n\t\t\t\t\t}, 1000);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('Socket was closed by user');\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t\twebSocketSS.onerror = (err) => {\r\n\t\t\t\tconsole.log('This error happened => ', err);\r\n\t\t\t\twebSocketSS.close()\r\n\t\t\t}\r\n\r\n\t\t\tlet sendPlayerTick = (\r\n\t\t\t\tposition,\r\n\t\t\t\tstate,\r\n\t\t\t\tvoiceBody\r\n\t\t\t) => {\r\n\r\n\t\t\t\tconst array = new Uint8Array(4 + 12 + 1 + voiceBody.byteLength);\r\n\r\n\t\t\t\tconst methodBuffer = new Uint8Array(new Uint32Array([ToMovement_ToPlayerScene_PlayerTick]).buffer\r\n\t\t\t\t);\r\n\r\n\t\t\t\tarray.set(methodBuffer, 0); // before 0, after 4\r\n\r\n\t\t\t\tarray.set(new Uint8Array(new Float32Array([position.x]).buffer), 4); // before 4, after 8\r\n\t\t\t\tarray.set(new Uint8Array(new Float32Array([position.y]).buffer), 4 + 4); // before 8, after 12\r\n\t\t\t\tarray.set(new Uint8Array(new Float32Array([position.z]).buffer), 4 + 8); // before 12, after 16\r\n\r\n\t\t\t\tarray.set(new Uint8Array([state]), 4 + 12); // before 16, after 17\r\n\r\n\t\t\t\tarray.set(voiceBody, 4 + 12 + 1); // before 17, after 4\r\n\r\n\t\t\t\tif (!isWSOpen(webSocketSS)) return\r\n\t\t\t\twebSocketSS.send(array)\r\n\t\t\t};\r\n\r\n\t\t\twindow.sendPlayerTick = audioChunk => sendPlayerTick({ x: 0, y: 0, z: 0 }, 0, audioChunk)\r\n\t\t}\r\n\r\n\r\n\t}, [linkForSS]);\r\n\r\n\tuseMemo(() => {\r\n\t\tfunction pinging() {\r\n\t\t\tconst interval = setTimeout(() => {\r\n\t\t\t\tif (!record) {\r\n\t\t\t\t\twindow.sendPlayerTick(new Uint8Array());\r\n\t\t\t\t\tpinging();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tclearTimeout(interval);\r\n\t\t\t\t}\r\n\t\t\t}, 4000)\r\n\t\t}\r\n\r\n\t\tif (connected) {\r\n\t\t\tpinging();\r\n\t\t}\r\n\t}, [record, connected])\r\n\r\n\tuseMemo(() => {\r\n\t\tsetUsers(getUsersFromStore)\r\n\t\tconsole.log(users);\r\n\t}, [getUsersFromStore, users])\r\n\r\n\treturn (\r\n\t\t<div className={classes.root}>\r\n\t\t\t<AppBar position=\"static\">\r\n\t\t\t\t<Toolbar>\r\n\t\t\t\t\t{/* <IconButton\r\n\t\t\t\t\t\tedge=\"start\"\r\n\t\t\t\t\t\tclassName={classes.menuButton}\r\n\t\t\t\t\t\tcolor=\"inherit\"\r\n\t\t\t\t\t\taria-label=\"menu\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<MenuIcon />\r\n\t\t\t\t\t</IconButton> */}\r\n\t\t\t\t\t{/* {webSocket && <WSTransferTest webSocket={webSocket} />} */}\r\n\t\t\t\t\t<Typography variant=\"h6\" className={classes.title}>\r\n\t\t\t\t\t\tConnection Status:\r\n\t\t\t\t\t\t{connected ? ' Connected!' : ' Disconnected!'}\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<Button color=\"inherit\" onClick={handleOpen}>Users List</Button>\r\n\t\t\t\t\t<Modal\r\n\t\t\t\t\t\taria-labelledby=\"transition-modal-title\"\r\n\t\t\t\t\t\taria-describedby=\"transition-modal-description\"\r\n\t\t\t\t\t\topen={openModal}\r\n\t\t\t\t\t\tonClose={handleClose}\r\n\t\t\t\t\t\tcloseAfterTransition\r\n\t\t\t\t\t\tBackdropComponent={Backdrop}\r\n\t\t\t\t\t\tBackdropProps={{\r\n\t\t\t\t\t\t\ttimeout: 500,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Fade in={openModal}>\r\n\t\t\t\t\t\t\t<Box sx={style}>\r\n\t\t\t\t\t\t\t\t<Typography id=\"transition-modal-title\" variant=\"h6\" component=\"h2\">\r\n\t\t\t\t\t\t\t\t\tUsers connected:\r\n\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tgetUsersFromStore.length !== 0 ? getUsersFromStore.map(u => {\r\n\t\t\t\t\t\t\t\t\t\treturn userUUID === u.uuid ?\r\n\t\t\t\t\t\t\t\t\t\t\t<Typography id=\"transition-modal-description\" sx={{ mt: 2 }} key={u.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\tSelf: <span style={{ color: 'red' }}>{u.uuid}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\t\t<Typography id=\"transition-modal-description\" sx={{ mt: 2 }} key={u.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\tUser's UUID: <span style={{ color: 'blue' }}>{u.uuid}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\t(<Typography id=\"transition-modal-description\" sx={{ mt: 2 }}>\r\n\t\t\t\t\t\t\t\t\t\t\tWaiting for users\r\n\t\t\t\t\t\t\t\t\t\t</Typography>)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t\t</Fade>\r\n\t\t\t\t\t</Modal>\r\n\t\t\t\t</Toolbar>\r\n\t\t\t</AppBar>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { createStore, combineReducers, applyMiddleware, compose } from 'redux'\r\nimport thunkMiddleware from 'redux-thunk'\r\n\r\nimport { appReducer } from './appReducer';\r\nimport { usersReducer } from './usersReducer';\r\n\r\n\r\nlet reducers = combineReducers(\r\n\t{\r\n\t\tapp: appReducer,\r\n\t\tusers: usersReducer\r\n\t}\r\n)\r\n\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\nconst store = createStore(reducers, composeEnhancers(applyMiddleware(thunkMiddleware)));\r\n\r\nwindow.__store__ = store;\r\n\r\nexport default store;\r\n","export default __webpack_public_path__ + \"static/media/preloader.e40a641e.gif\";","export function startSocketIO(socket, peer, connectAndCall, disconnectFromPeer) {\r\n\tsocket.current.io.on('open', () => {\r\n\t\tconsole.log('Socket Opened')\r\n\t})\r\n\tsocket.current.io.on('close', () => {\r\n\t\tconsole.log('close')\r\n\t\tsetTimeout(() => {\r\n\t\t\tstartSocketIO(socket.current, peer, connectAndCall, disconnectFromPeer)\r\n\t\t}, 1000)\r\n\t})\r\n\tsocket.current.on(\"connect\", () => {\r\n\t\tconsole.log('socket connected => ', socket.current.connected);\r\n\t});\r\n\tsocket.current.on('connected_to_room', (arg) => {\r\n\t\tconsole.log(arg);\r\n\t})\r\n\tsocket.current.on('user_disconnected', (args) => {\r\n\t\tconsole.log('user_disconnected')\r\n\t\tif (args !== peer.id) {\r\n\t\t\tdisconnectFromPeer(args)\r\n\t\t}\r\n\t})\r\n\r\n}","import React, { useState, useRef, useEffect, useMemo, useCallback, useContext } from \"react\";\r\nimport { Tooltip } from '@mui/material';\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport MicIcon from \"@mui/icons-material/Mic\";\r\nimport MicOffIcon from '@mui/icons-material/MicOff';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport VideocamIcon from '@mui/icons-material/Videocam';\r\nimport VideocamOffIcon from '@mui/icons-material/VideocamOff';\r\nimport DesktopWindowsIcon from '@mui/icons-material/DesktopWindows';\r\nimport DesktopAccessDisabledIcon from '@mui/icons-material/DesktopAccessDisabled';\r\n\r\nimport \"./ChatControlButtons.css\";\r\nimport { Box } from \"@mui/system\";\r\nimport { VoiceChatButtonsContext } from \"../../../../utils/Context\";\r\n// import { setOutputPlayerVoiceFromClient, toggleOnDialog } from \"../../redux/appReducer\";\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\ticon: {\r\n\t\theight: '1em',\r\n\t\twidth: '1em'\r\n\t},\r\n\treactmic: {\r\n\t\twidth: \"80%\",\r\n\t\theight: 30\r\n\t},\r\n\tflex: {\r\n\t\tflex: 1\r\n\t}\r\n}));\r\n\r\nexport default function ChatControlButtons() {\r\n\r\n\tconst { isAudio, setIsAudio, isVideo, setIsVideo, isScreen, startCapture, stopCapture } = useContext(VoiceChatButtonsContext);\r\n\r\n\tconst startAudio = () => {\r\n\t\tsetIsAudio(true)\r\n\t};\r\n\r\n\tconst stopAudio = () => {\r\n\t\tsetIsAudio(false);\r\n\t}\r\n\tconst startVideo = () => {\r\n\t\tsetIsVideo(true)\r\n\t};\r\n\r\n\tconst stopVideo = () => {\r\n\t\tsetIsVideo(false);\r\n\t}\r\n\r\n\tconst classes = useStyles();\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Box sx={{ marginLeft: '.5em', display: 'flex', flexDirection: 'row', justifyContent: 'flex-end', position: 'absolute', right: 0, bottom: '10px' }}>\r\n\t\t\t\t{!isScreen ?\r\n\t\t\t\t\t<Tooltip title={'Демонстрация экрана отключена'} placement='top-start'>\r\n\t\t\t\t\t\t<IconButton onClick={startCapture}>\r\n\t\t\t\t\t\t\t<DesktopAccessDisabledIcon style={{ width: '.8em', height: '.8em', color: '#FF94A1' }} />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<Tooltip title={'Демонстрация экрана включена'} placement='top-start'>\r\n\t\t\t\t\t\t<IconButton onClick={stopCapture}>\r\n\t\t\t\t\t\t\t<DesktopWindowsIcon style={{ width: '.8em', height: '.8em', color: '#B5B5C3' }} />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t}\r\n\t\t\t\t{!isVideo ?\r\n\t\t\t\t\t<Tooltip title={'Видео выключено'} placement='top-start'>\r\n\t\t\t\t\t\t<IconButton onClick={startVideo}>\r\n\t\t\t\t\t\t\t<VideocamOffIcon className={classes.icon} style={{ color: '#FF94A1' }} />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<Tooltip title={'Видео включено'} placement='top-start'>\r\n\t\t\t\t\t\t<IconButton onClick={stopVideo}>\r\n\t\t\t\t\t\t\t<VideocamIcon className={classes.icon} style={{ color: '#B5B5C3' }} />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip>}\r\n\t\t\t\t{!isAudio ?\r\n\t\t\t\t\t<Tooltip title={'Звук включён'} placement='top-start'>\r\n\t\t\t\t\t\t<IconButton onClick={startAudio}>\r\n\t\t\t\t\t\t\t<MicOffIcon className={classes.icon} style={{ color: '#FF94A1' }} />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<Tooltip title={'Звук выключен'} placement='top-start'>\r\n\t\t\t\t\t\t<IconButton onClick={stopAudio}>\r\n\t\t\t\t\t\t\t<MicIcon className={classes.icon} style={{ color: '#B5B5C3' }} />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip>}\r\n\t\t\t</Box>\r\n\t\t</>\r\n\t);\r\n}\r\n","import React, { useState } from 'react'\r\nimport Box from '@mui/material/Box';\r\nimport Drawer from '@mui/material/Drawer';\r\nimport List from '@mui/material/List';\r\nimport Divider from '@mui/material/Divider';\r\nimport ListItem from '@mui/material/ListItem';\r\nimport ListItemText from '@mui/material/ListItemText';\r\nimport ListItemButton from '@mui/material/ListItemButton';\r\nimport VolumeUpIcon from '@mui/icons-material/VolumeUp';\r\nimport ChatControlButtons from '../../../chat-control-btns/ChatControlButtons'\r\nimport { Typography } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Popover from '@mui/material/Popover';\r\nimport { MenuItem } from '@mui/material';\r\nimport Toolbar from '@mui/material/Toolbar';\r\n\r\n\r\nconst drawerWidth = 435;\r\n\r\nconst arr = ['Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович',]\r\n\r\nconst useStyles = makeStyles({\r\n\ttoolbarRoot: {\r\n\t\tdisplay: 'flex',\r\n\t\twidth: '99.8%',\r\n\t\tbackgroundColor: '#fff',\r\n\t\tposition: 'fixed !important',\r\n\t\tflexDirection: 'column',\r\n\t\tjustifyContent: 'space-evenly',\r\n\t\tpadding: '0 !important',\r\n\t\tborderTop: ' 1px solid rgba(0, 0, 0, 0.12)',\r\n\t\tboxShadow: '4px 4px 15px rgba(0, 0, 0, 0.1)',\r\n\t\tminHeight: '75px !important',\r\n\t},\r\n\tstandTitle: {\r\n\t\twidth: '100%',\r\n\t\tmarginLeft: '1em',\r\n\t\tfontWeight: 700,\r\n\t\tfontSize: 18,\r\n\t\ttextAlign: 'left'\r\n\t},\r\n\tstandName: {\r\n\t\twidth: '100%',\r\n\t\tmarginLeft: '1em',\r\n\t\tfontWeight: 400,\r\n\t\tfontSize: 14,\r\n\t\ttextAlign: 'left'\r\n\t},\r\n\r\n\tspeaker: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tcolor: '#262626',\r\n\t\tborder: 'none',\r\n\t\t'&:hover': {\r\n\t\t\tbackgroundColor: '#F1F9FA !important',\r\n\t\t\tborder: 'none',\r\n\t\t\tboxShadow: 'none',\r\n\t\t},\r\n\t\t'&:active': {\r\n\t\t\tboxShadow: 'none',\r\n\t\t\tbackgroundColor: '#F1F9FA',\r\n\t\t\tborder: 'none',\r\n\t\t},\r\n\t\t'&:focus': {\r\n\t\t\tboxShadow: 'none',\r\n\t\t\tbackgroundColor: '#F1F9FA',\r\n\t\t\tborder: 'none',\r\n\t\t},\r\n\t},\r\n});\r\n\r\n//роли спикеров\r\nexport const VoiceTabPanel = () => {\r\n\tconst classes = useStyles();\r\n\tconst [anchorEl, setAnchorEl] = useState(null);\r\n\r\n\tconst handleClick = (event) => {\r\n\t\tsetAnchorEl(event.currentTarget);\r\n\t};\r\n\r\n\tconst handleClose = () => {\r\n\t\tsetAnchorEl(null);\r\n\t};\r\n\r\n\tconst open = Boolean(anchorEl);\r\n\tconst id = open ? 'simple-popover' : undefined;\r\n\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Drawer\r\n\t\t\t\tsx={{\r\n\t\t\t\t\tposition: 'relative',\r\n\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\tflexShrink: 0,\r\n\t\t\t\t\t'& .MuiDrawer-paper': {\r\n\t\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\t\theight: '80vh',\r\n\t\t\t\t\t\tboxSizing: 'border-box',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'& .MuiDrawer-paper::-webkit-scrollbar': {\r\n\t\t\t\t\t\twidth: '0px',\r\n\t\t\t\t\t\tbackground: 'transparent',\r\n\t\t\t\t\t},\r\n\t\t\t\t}}\r\n\t\t\t\tvariant=\"permanent\"\r\n\t\t\t\tanchor=\"left\"\r\n\t\t\t>\r\n\t\t\t\t<Toolbar classes={{ root: classes.toolbarRoot }} sx={{\r\n\t\t\t\t\tzIndex: (theme) => theme.zIndex.drawer + 1,\r\n\t\t\t\t\t'& .MuiDrawer-paper': {\r\n\t\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\t\tboxSizing: 'border-box',\r\n\t\t\t\t\t}\r\n\t\t\t\t}} >\r\n\t\t\t\t\t<Typography noWrap component=\"div\" className={classes.standTitle}>\r\n\t\t\t\t\t\tЗона практик\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<Typography noWrap component=\"div\" className={classes.standName}>\r\n\t\t\t\t\t\tСтенд\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t</Toolbar>\r\n\t\t\t\t<Divider />\r\n\t\t\t\t<List sx={{ marginTop: '75px' }}>\r\n\t\t\t\t\t{arr.map((text, index) => (\r\n\t\t\t\t\t\t<ListItem\r\n\t\t\t\t\t\t\tclassName={classes.speaker}\r\n\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\tdisablePadding\r\n\t\t\t\t\t\t\tsecondaryAction={\r\n\t\t\t\t\t\t\t\t<IconButton edge=\"end\" onClick={() => console.log(2)} >\r\n\t\t\t\t\t\t\t\t\t<VolumeUpIcon />\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t\t<ListItemButton className={classes.speaker} onClick={handleClick}>\r\n\t\t\t\t\t\t\t\t<ListItemText aria-describedby={id} primary={text} secondary={index % 2 === 0 ? 'Secondary text' : null} />\r\n\t\t\t\t\t\t\t</ListItemButton>\r\n\t\t\t\t\t\t\t<Popover\r\n\t\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\t\topen={open}\r\n\t\t\t\t\t\t\t\tanchorEl={anchorEl}\r\n\t\t\t\t\t\t\t\tonClose={handleClose}\r\n\t\t\t\t\t\t\t\tPaperProps={{\r\n\t\t\t\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\t\t\t\tborder: '1px solid #d5f2f5',\r\n\t\t\t\t\t\t\t\t\t\tboxShadow: 'none',\r\n\t\t\t\t\t\t\t\t\t\tborderRadius: '8px',\r\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: '#fff'\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tanchorPosition={{ top: 120, left: 700 }}\r\n\t\t\t\t\t\t\t\tanchorOrigin={{\r\n\t\t\t\t\t\t\t\t\tvertical: 'top',\r\n\t\t\t\t\t\t\t\t\thorizontal: 'right',\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\ttransformOrigin={{\r\n\t\t\t\t\t\t\t\t\tvertical: 'center',\r\n\t\t\t\t\t\t\t\t\thorizontal: 'right',\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<MenuItem>Задать вопрос в текстовом чате</MenuItem>\r\n\t\t\t\t\t\t\t\t<MenuItem>И сделать что-то ещё</MenuItem>\r\n\t\t\t\t\t\t\t\t<MenuItem>И ещё</MenuItem>\r\n\r\n\t\t\t\t\t\t\t</Popover>\r\n\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</List>\r\n\t\t\t</Drawer>\r\n\t\t\t<Box sx={{\r\n\t\t\t\tzIndex: (theme) => theme.zIndex.drawer + 1,\r\n\t\t\t}}>\r\n\t\t\t\t<ChatControlButtons />\r\n\t\t\t</Box>\r\n\t\t</>\r\n\t)\r\n}","export function timeFormatHelper(value) {\r\n\tif (value < 10) {\r\n\t\treturn '0' + value;\r\n\t} else {\r\n\t\treturn value;\r\n\t}\r\n}","import React, { useContext, useEffect, useRef, useState } from 'react'\r\nimport Box from '@mui/material/Box';\r\nimport Drawer from '@mui/material/Drawer';\r\nimport List from '@mui/material/List';\r\nimport Divider from '@mui/material/Divider';\r\nimport ListItem from '@mui/material/ListItem';\r\nimport ListItemText from '@mui/material/ListItemText';\r\nimport Button from '@mui/material/Button';\r\nimport { Typography } from '@material-ui/core';\r\nimport ChatControlButtons from '../../../chat-control-btns/ChatControlButtons'\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport IconButton from '@mui/material/IconButton';\r\n\r\nimport Toolbar from '@mui/material/Toolbar';\r\nimport { styled } from '@mui/material/styles';\r\n\r\nimport TextField from '@mui/material/TextField';\r\nimport SendIcon from '@mui/icons-material/Send';\r\nimport { VoiceChatButtonsContext } from '../../../../../../utils/Context';\r\nimport { timeFormatHelper } from '../../../../../../utils/TimeFormatter';\r\n\r\nconst drawerWidth = 435;\r\n\r\nconst useStyles = makeStyles({\r\n\ttoolbarRoot: {\r\n\t\tdisplay: 'flex',\r\n\t\twidth: '99.8%',\r\n\t\tbackgroundColor: '#fff',\r\n\t\tflexDirection: 'column',\r\n\t\tjustifyContent: 'space-evenly',\r\n\t\tpadding: '0 !important',\r\n\t\tborderTop: ' 1px solid rgba(0, 0, 0, 0.12)',\r\n\t\tboxShadow: '4px 4px 15px rgba(0, 0, 0, 0.1)',\r\n\t\tminHeight: '75px !important',\r\n\t},\r\n\tstandTitle: {\r\n\t\twidth: '100%',\r\n\t\tmarginLeft: '1em',\r\n\t\tfontWeight: 700,\r\n\t\tfontSize: 18,\r\n\t\ttextAlign: 'left'\r\n\t},\r\n\tstandName: {\r\n\t\twidth: '100%',\r\n\t\tmarginLeft: '1em',\r\n\t\tfontWeight: 400,\r\n\t\tfontSize: 14,\r\n\t\ttextAlign: 'left'\r\n\t},\r\n\tspeaker: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tcolor: '#262626',\r\n\t\tborder: 'none',\r\n\t\t'&:hover': {\r\n\t\t\tbackgroundColor: '#F1F9FA !important',\r\n\t\t\tborder: 'none',\r\n\t\t\tboxShadow: 'none',\r\n\t\t},\r\n\t\t'&:active': {\r\n\t\t\tboxShadow: 'none',\r\n\t\t\tbackgroundColor: '#F1F9FA',\r\n\t\t\tborder: 'none',\r\n\t\t},\r\n\t\t'&:focus': {\r\n\t\t\tboxShadow: 'none',\r\n\t\t\tbackgroundColor: '#F1F9FA',\r\n\t\t\tborder: 'none',\r\n\t\t},\r\n\t},\r\n\tmyMessage: {\r\n\t\tbackgroundColor: '#B1E6EA',\r\n\t\tcolor: '#272B2E',\r\n\t\tfontSize: '14px',\r\n\t\tpadding: '15px',\r\n\t\tdisplay: 'block',\r\n\t\twidth: 'fit-content',\r\n\t\tmarginLeft: 'auto',\r\n\t\tborderRadius: '8px 8px 0px 8px'\r\n\t},\r\n\tincomeMessage: {\r\n\t\tbackgroundColor: '#E9EAF0',\r\n\t\tcolor: '#272B2E',\r\n\t\tfontSize: '14px',\r\n\t\tpadding: '15px',\r\n\t\tdisplay: 'block',\r\n\t\twidth: 'fit-content',\r\n\t\tmarginRight: 'auto',\r\n\t\tborderRadius: '0px 8px 8px 8px'\r\n\t}\r\n});\r\n\r\nconst CssTextField = styled(TextField)({\r\n\t'& label.Mui-focused': {\r\n\t\tcolor: '#00AFBC',\r\n\t},\r\n\t'& .MuiInput-underline:after': {\r\n\t\tborderBottomColor: '#00AFBC',\r\n\t},\r\n\t'& .MuiOutlinedInput-root': {\r\n\t\t'& fieldset': {\r\n\t\t\tborderColor: '#b0edf5',\r\n\t\t},\r\n\t\t'&:hover fieldset': {\r\n\t\t\tborderColor: '#00AFBC',\r\n\t\t},\r\n\t\t'&.Mui-focused fieldset': {\r\n\t\t\tborderColor: '#00AFBC',\r\n\t\t},\r\n\t},\r\n});\r\n\r\nexport const TextTabPanel = () => {\r\n\tconst classes = useStyles();\r\n\tconst messageBox = useRef();\r\n\tconst { socket, messages, setMessages, me } = useContext(VoiceChatButtonsContext);\r\n\r\n\tconst handleSendMessage = (e) => {\r\n\t\te.preventDefault();\r\n\r\n\t\tif (messageBox.current.value) {\r\n\t\t\tsocket.current.emit('chatMessage', messageBox.current.value);\r\n\t\t\tmessageBox.current.value = '';\r\n\t\t} else {\r\n\t\t\treturn\r\n\t\t}\r\n\t}\r\n\tuseEffect(() => {\r\n\t\tconsole.log(messages);\r\n\t}, [messages])\r\n\tuseEffect(() => {\r\n\t\tsocket.current.on('chatMessage', (mess) => {\r\n\t\t\tconsole.log(mess);\r\n\t\t\tsetMessages(messages => ([...messages, {\r\n\t\t\t\tme: mess.from.peerUUID === me ? true : false,\r\n\t\t\t\tcurrentMinutes: timeFormatHelper(new Date().getMinutes()),\r\n\t\t\t\tcurrentHour: timeFormatHelper(new Date().getHours()),\r\n\t\t\t\tmessage: mess.message,\r\n\r\n\t\t\t}]))\r\n\t\t})\r\n\t}, [])\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Drawer\r\n\t\t\t\tsx={{\r\n\t\t\t\t\t// position: 'relative',\r\n\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\tflexShrink: 0,\r\n\t\t\t\t\t'& .MuiDrawer-paper': {\r\n\t\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\t\theight: '81vh',\r\n\t\t\t\t\t\tleft: 435,\r\n\t\t\t\t\t\tboxSizing: 'border-box',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'& .MuiDrawer-paper::-webkit-scrollbar': {\r\n\t\t\t\t\t\twidth: '0px',\r\n\t\t\t\t\t\tbackground: 'transparent',\r\n\t\t\t\t\t},\r\n\t\t\t\t}}\r\n\t\t\t\tvariant=\"permanent\"\r\n\t\t\t\tanchor=\"left\"\r\n\t\t\t>\r\n\t\t\t\t<Toolbar classes={{ root: classes.toolbarRoot }} sx={{\r\n\t\t\t\t\tzIndex: (theme) => theme.zIndex.drawer + 1,\r\n\t\t\t\t\t'& .MuiDrawer-paper': {\r\n\t\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\t\tboxSizing: 'border-box',\r\n\t\t\t\t\t}\r\n\t\t\t\t}} >\r\n\t\t\t\t\t<Typography noWrap component=\"div\" className={classes.standTitle}>\r\n\t\t\t\t\t\tЗона практик\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<Typography noWrap component=\"div\" className={classes.standName}>\r\n\t\t\t\t\t\tСтенд\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t</Toolbar>\r\n\t\t\t\t<Divider />\r\n\t\t\t\t<List\r\n\t\t\t\t\tid='chat-list'\r\n\t\t\t\t\tsx={{ overflowY: 'scroll', }} >\r\n\t\t\t\t\t{messages.map((dataObj, index) => {\r\n\t\t\t\t\t\treturn dataObj.me ?\r\n\t\t\t\t\t\t\t(<ListItem key={index}>\r\n\t\t\t\t\t\t\t\t<ListItemText>\r\n\t\t\t\t\t\t\t\t\t<Typography className={classes.myMessage}> {dataObj.message}</Typography>\r\n\t\t\t\t\t\t\t\t\t<Typography align='right' style={{ color: '#C5C7D1', fontSize: '14px' }}> {dataObj.currentHour}:{dataObj.currentMinutes}</Typography>\r\n\t\t\t\t\t\t\t\t</ListItemText>\r\n\t\t\t\t\t\t\t</ListItem>)\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t(<ListItem key={index}>\r\n\t\t\t\t\t\t\t\t<ListItemText>\r\n\t\t\t\t\t\t\t\t\t<Typography className={classes.incomeMessage}> {dataObj.message}</Typography>\r\n\t\t\t\t\t\t\t\t\t<Typography align='left' style={{ color: '#C5C7D1', fontSize: '14px' }}> {dataObj.currentHour}:{dataObj.currentMinutes}</Typography>\r\n\t\t\t\t\t\t\t\t</ListItemText>\r\n\t\t\t\t\t\t\t</ListItem>)\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t)}\r\n\t\t\t\t</List>\r\n\t\t\t</Drawer>\r\n\t\t\t<Box\r\n\t\t\t\tcomponent=\"form\"\r\n\t\t\t\tonSubmit={handleSendMessage}\r\n\t\t\t\tsx={{\r\n\t\t\t\t\t'& .MuiTextField-root': { m: 1, width: '25ch' },\r\n\t\t\t\t}}\r\n\t\t\t\tnoValidate\r\n\t\t\t\tautoComplete=\"off\"\r\n\t\t\t\tsx={{\r\n\t\t\t\t\tposition: 'fixed',\r\n\t\t\t\t\tbottom: '.5%',\r\n\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<CssTextField\r\n\t\t\t\t\tlabel=\"Введите сообщение...\"\r\n\t\t\t\t\tid=\"custom-css-outlined-input\"\r\n\t\t\t\t\tinputProps={{\r\n\t\t\t\t\t\tstyle: { paddingRight: '10%' },\r\n\t\t\t\t\t\tref: messageBox\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\twidth: '100%'\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t<Button\r\n\t\t\t\t\ttype='submit'\r\n\t\t\t\t\tonClick={handleSendMessage}\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\tposition: 'absolute',\r\n\t\t\t\t\t\tbottom: '15%',\r\n\t\t\t\t\t\tright: 0\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<SendIcon />\r\n\t\t\t\t</Button>\r\n\t\t\t</Box>\r\n\t\t</>\r\n\t)\r\n}","import React, { useState } from 'react'\r\nimport Box from '@mui/material/Box';\r\nimport Drawer from '@mui/material/Drawer';\r\nimport List from '@mui/material/List';\r\nimport Divider from '@mui/material/Divider';\r\nimport ListItem from '@mui/material/ListItem';\r\nimport ListItemText from '@mui/material/ListItemText';\r\nimport ListItemButton from '@mui/material/ListItemButton';\r\nimport { Typography } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport Popover from '@mui/material/Popover';\r\nimport { MenuItem } from '@mui/material';\r\nimport Toolbar from '@mui/material/Toolbar';\r\nimport { styled } from '@mui/material/styles';\r\nimport Button from '@mui/material/Button';\r\nimport Stack from '@mui/material/Stack';\r\nimport { purple } from '@mui/material/colors';\r\n\r\nconst drawerWidth = 435;\r\n\r\nconst arr = ['Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович', 'Иванов Иван Иванович',]\r\nconst BootstrapButton = styled(Button)({\r\n\tboxShadow: 'none',\r\n\ttextTransform: 'none',\r\n\tfontSize: 14,\r\n\tpadding: '12px 17px',\r\n\tborder: 'none',\r\n\tcolor: '#fff',\r\n\tlineHeight: 1.5,\r\n\tborderRadius: '20px',\r\n\tbackgroundColor: '#00AFBC',\r\n\tfontFamily: [\r\n\t\t'-apple-system',\r\n\t\t'BlinkMacSystemFont',\r\n\t\t'\"Segoe UI\"',\r\n\t\t'Roboto',\r\n\t\t'\"Helvetica Neue\"',\r\n\t\t'Arial',\r\n\t\t'sans-serif',\r\n\t\t'\"Apple Color Emoji\"',\r\n\t\t'\"Segoe UI Emoji\"',\r\n\t\t'\"Segoe UI Symbol\"',\r\n\t].join(','),\r\n\t'&:hover': {\r\n\t\tbackgroundColor: '#F1F9FA',\r\n\t\tcolor: '#00AFBC',\r\n\t\tborderColor: '#09d4e3',\r\n\t\tboxShadow: 'none',\r\n\t},\r\n\t'&:active': {\r\n\t\tboxShadow: 'none',\r\n\t\tcolor: '#00AFBC',\r\n\t\tbackgroundColor: '#F1F9FA',\r\n\t\tborderColor: '#09d4e3',\r\n\t},\r\n\t'&:focus': {\r\n\t\tboxShadow: '0 0 0 0.2rem rgba(9,212,227, 0.8)',\r\n\t},\r\n});\r\nconst ColorButton = styled(Button)({\r\n\tboxShadow: 'none',\r\n\ttextTransform: 'none',\r\n\tfontSize: 14,\r\n\tpadding: '12px 17px',\r\n\tborder: 'none',\r\n\tcolor: '#00AFBC',\r\n\tlineHeight: 1.5,\r\n\tborderRadius: '20px',\r\n\tbackgroundColor: '#F1F9FA',\r\n\tfontFamily: [\r\n\t\t'-apple-system',\r\n\t\t'BlinkMacSystemFont',\r\n\t\t'\"Segoe UI\"',\r\n\t\t'Roboto',\r\n\t\t'\"Helvetica Neue\"',\r\n\t\t'Arial',\r\n\t\t'sans-serif',\r\n\t\t'\"Apple Color Emoji\"',\r\n\t\t'\"Segoe UI Emoji\"',\r\n\t\t'\"Segoe UI Symbol\"',\r\n\t].join(','),\r\n\t'&:hover': {\r\n\t\tbackgroundColor: '#00AFBC',\r\n\t\tcolor: '#fff',\r\n\t\tborderColor: '#09d4e3',\r\n\t\tboxShadow: 'none',\r\n\t},\r\n\t'&:active': {\r\n\t\tboxShadow: 'none',\r\n\t\tcolor: '#fff',\r\n\t\tbackgroundColor: '#00AFBC',\r\n\t\tborderColor: '#09d4e3',\r\n\t},\r\n\t'&:focus': {\r\n\t\tboxShadow: '0 0 0 0.2rem rgba(9,212,227, 0.8)',\r\n\t},\r\n});\r\n\r\nfunction CustomizedButtons() {\r\n\treturn (\r\n\t\t<Stack spacing={2} direction=\"row\" style={{ justifyContent: 'space-evenly', width: '100%' }}>\r\n\t\t\t<ColorButton variant=\"contained\">Отправить визитку</ColorButton>\r\n\t\t\t<BootstrapButton variant=\"contained\">\r\n\t\t\t\tНаписать личное сообщение\r\n\t\t\t</BootstrapButton>\r\n\t\t</Stack>\r\n\t);\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n\ttoolbarRoot: {\r\n\t\tdisplay: 'flex',\r\n\t\twidth: '99.8%',\r\n\t\tbackgroundColor: '#fff',\r\n\t\tposition: 'fixed !important',\r\n\t\tflexDirection: 'column',\r\n\t\tjustifyContent: 'space-evenly',\r\n\t\tpadding: '0 !important',\r\n\t\tborderTop: ' 1px solid rgba(0, 0, 0, 0.12)',\r\n\t\tboxShadow: '4px 4px 15px rgba(0, 0, 0, 0.1)',\r\n\t\tminHeight: '75px !important',\r\n\t},\r\n\tstandTitle: {\r\n\t\twidth: '100%',\r\n\t\tmarginLeft: '1em',\r\n\t\tfontWeight: 700,\r\n\t\tfontSize: 18,\r\n\t\ttextAlign: 'left'\r\n\t},\r\n\tstandName: {\r\n\t\twidth: '100%',\r\n\t\tmarginLeft: '1em',\r\n\t\tfontWeight: 400,\r\n\t\tfontSize: 14,\r\n\t\ttextAlign: 'left'\r\n\t},\r\n\r\n\tspeaker: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tcolor: '#262626',\r\n\t\tborder: 'none',\r\n\t\t'&:hover': {\r\n\t\t\tbackgroundColor: '#F1F9FA !important',\r\n\t\t\tborder: 'none',\r\n\t\t\tboxShadow: 'none',\r\n\t\t},\r\n\t\t'&:active': {\r\n\t\t\tboxShadow: 'none',\r\n\t\t\tbackgroundColor: '#F1F9FA',\r\n\t\t\tborder: 'none',\r\n\t\t},\r\n\t\t'&:focus': {\r\n\t\t\tboxShadow: 'none',\r\n\t\t\tbackgroundColor: '#F1F9FA',\r\n\t\t\tborder: 'none',\r\n\t\t},\r\n\t},\r\n});\r\n\r\n\r\n//роли спикеров\r\nexport const UsersTabPanel = () => {\r\n\tconst classes = useStyles();\r\n\tconst [anchorEl, setAnchorEl] = useState(null);\r\n\r\n\tconst handleClick = (event) => {\r\n\t\tsetAnchorEl(event.currentTarget);\r\n\t};\r\n\r\n\tconst handleClose = () => {\r\n\t\tsetAnchorEl(null);\r\n\t};\r\n\r\n\tconst open = Boolean(anchorEl);\r\n\tconst id = open ? 'simple-popover' : undefined;\r\n\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Drawer\r\n\t\t\t\tsx={{\r\n\t\t\t\t\tposition: 'relative',\r\n\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\tflexShrink: 0,\r\n\t\t\t\t\t'& .MuiDrawer-paper': {\r\n\t\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\t\theight: '80vh',\r\n\t\t\t\t\t\tleft: 870,\r\n\t\t\t\t\t\tboxSizing: 'border-box',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'& .MuiDrawer-paper::-webkit-scrollbar': {\r\n\t\t\t\t\t\twidth: '0px',\r\n\t\t\t\t\t\tbackground: 'transparent',\r\n\t\t\t\t\t},\r\n\t\t\t\t}}\r\n\t\t\t\tvariant=\"permanent\"\r\n\t\t\t\tanchor=\"left\"\r\n\t\t\t>\r\n\r\n\t\t\t\t<Divider />\r\n\t\t\t\t<List sx={{ marginTop: '0' }}>\r\n\t\t\t\t\t{arr.map((text, index) => (\r\n\t\t\t\t\t\t<ListItem\r\n\t\t\t\t\t\t\tclassName={classes.speaker}\r\n\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\tdisablePadding\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<ListItemButton className={classes.speaker} onClick={handleClick}>\r\n\t\t\t\t\t\t\t\t<ListItemText aria-describedby={id} primary={text} secondary={index % 2 === 0 ? 'Secondary text' : null} />\r\n\t\t\t\t\t\t\t</ListItemButton>\r\n\t\t\t\t\t\t\t<Popover\r\n\t\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\t\topen={open}\r\n\t\t\t\t\t\t\t\tanchorEl={anchorEl}\r\n\t\t\t\t\t\t\t\tonClose={handleClose}\r\n\t\t\t\t\t\t\t\tPaperProps={{\r\n\t\t\t\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\t\t\t\tborder: '1px solid #d5f2f5',\r\n\t\t\t\t\t\t\t\t\t\tboxShadow: 'none',\r\n\t\t\t\t\t\t\t\t\t\tborderRadius: '8px',\r\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: '#fff'\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tanchorPosition={{ top: 120, left: 700 }}\r\n\t\t\t\t\t\t\t\tanchorOrigin={{\r\n\t\t\t\t\t\t\t\t\tvertical: 'top',\r\n\t\t\t\t\t\t\t\t\thorizontal: 'right',\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\ttransformOrigin={{\r\n\t\t\t\t\t\t\t\t\tvertical: 'center',\r\n\t\t\t\t\t\t\t\t\thorizontal: 'right',\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<MenuItem>Задать вопрос в текстовом чате</MenuItem>\r\n\t\t\t\t\t\t\t\t<MenuItem>И сделать что-то ещё</MenuItem>\r\n\t\t\t\t\t\t\t\t<MenuItem>И ещё</MenuItem>\r\n\r\n\t\t\t\t\t\t\t</Popover>\r\n\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</List>\r\n\t\t\t</Drawer>\r\n\t\t\t<Box sx={{\r\n\t\t\t\twidth: { drawerWidth },\r\n\t\t\t\tdisplay: 'flex',\r\n\t\t\t\tposition: 'absolute', bottom: 0,\r\n\t\t\t\tzIndex: (theme) => theme.zIndex.drawer + 1,\r\n\t\t\t}}>\r\n\t\t\t\t<CustomizedButtons />\r\n\t\t\t</Box>\r\n\t\t</>\r\n\t)\r\n}","import React from 'react'\r\nimport Box from '@mui/material/Box';\r\nimport { VoiceTabPanel } from './tab-panel-element/VoiceTabPanel';\r\nimport { TextTabPanel } from './tab-panel-element/TextTabPanel';\r\nimport { UsersTabPanel } from './tab-panel-element/UsersTabPanel';\r\n\r\nconst boxStyles = {\r\n\tdisplay: 'flex',\r\n\tposition: 'relative',\r\n\tboxSizing: 'border-box',\r\n\twidth: '435px',\r\n\theight: '90vh',\r\n\tmargin: 0,\r\n\tpadding: 0,\r\n\r\n}\r\n\r\nexport const TabPanelContainer = ({ panelType }) => {\r\n\tif (panelType === 'voice') {\r\n\t\treturn (\r\n\t\t\t<Box sx={boxStyles} >\r\n\t\t\t\t<VoiceTabPanel />\r\n\t\t\t</Box>\r\n\t\t)\r\n\t}\r\n\tif (panelType === 'text') {\r\n\t\treturn (\r\n\t\t\t<Box sx={boxStyles} >\r\n\t\t\t\t<TextTabPanel />\r\n\t\t\t</Box>\r\n\t\t)\r\n\t}\r\n\tif (panelType === 'users') {\r\n\t\treturn (\r\n\t\t\t<Box sx={boxStyles} >\r\n\t\t\t\t<UsersTabPanel />\r\n\t\t\t</Box>\r\n\t\t)\r\n\t}\r\n}","import * as React from 'react';\r\nimport SwipeableViews from 'react-swipeable-views';\r\nimport { useTheme } from '@mui/material/styles';\r\nimport AppBar from '@mui/material/AppBar';\r\nimport Tabs from '@mui/material/Tabs';\r\nimport Tab from '@mui/material/Tab';\r\nimport Box from '@mui/material/Box';\r\nimport textChatTabActiveIcon from '../../../../assets/src/media/icons/textChatTabActiveIcon.png'\r\nimport textChatTabNotActiveIcon from '../../../../assets/src/media/icons/textChatTabNotActiveIcon.png'\r\nimport voiceChatTabActiveIcon from '../../../../assets/src/media/icons/voiceChatTabActiveIcon.png'\r\nimport voiceChatTabNotActiveIcon from '../../../../assets/src/media/icons/voiceChatTabNotActiveIcon.png'\r\nimport usersTabActiveIcon from '../../../../assets/src/media/icons/usersTabActiveIcon.png'\r\nimport usersTabNotActiveIcon from '../../../../assets/src/media/icons/usersTabNotActiveIcon.png'\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport { TabPanelContainer } from './tab-panel/TabPanelContainer';\r\n\r\n\r\nfunction TabPanel(props) {\r\n\tconst { children, value, index, ...other } = props;\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\trole=\"tabpanel\"\r\n\t\t\thidden={value !== index}\r\n\t\t\tid={`full-width-tabpanel-${index}`}\r\n\t\t\taria-labelledby={`full-width-tab-${index}`}\r\n\t\t\t{...other}\r\n\t\t>\r\n\t\t\t{value === index && (\r\n\t\t\t\t<Box sx={{ p: 0 }}>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</Box>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction a11yProps(index) {\r\n\treturn {\r\n\t\tid: `full-width-tab-${index}`,\r\n\t\t'aria-controls': `full-width-tabpanel-${index}`,\r\n\t};\r\n}\r\n\r\nconst chatBarHeaderArr = [\r\n\t{\r\n\t\tnotActiveTabIcon: <img src={voiceChatTabNotActiveIcon} style={{ margin: '0 5px 0 0' }}></img>,\r\n\t\tactiveTabIcon: <img src={voiceChatTabActiveIcon} style={{ margin: '0 5px 0 0' }}></img>,\r\n\t\tlabel: 'Голосовой чат'\r\n\t},\r\n\t{\r\n\t\tnotActiveTabIcon: <img src={textChatTabNotActiveIcon} style={{ margin: '0 5px 0 0' }}></img>,\r\n\t\tactiveTabIcon: <img src={textChatTabActiveIcon} style={{ margin: '0 5px 0 0' }}></img>,\r\n\t\tlabel: 'Текстовый чат'\r\n\t},\r\n\t{\r\n\t\tnotActiveTabIcon: <img src={usersTabNotActiveIcon} style={{ margin: '0 5px 0 0' }}></img>,\r\n\t\tactiveTabIcon: <img src={usersTabActiveIcon} style={{ margin: '0 5px 0 0' }}></img>,\r\n\t\tlabel: 'Пользователи'\r\n\t}\r\n]\r\n\r\nconst panelTypes = [\r\n\t{\r\n\t\ttype: 'voice'\r\n\t},\r\n\t{\r\n\t\ttype: 'text'\r\n\t},\r\n\t{\r\n\t\ttype: 'users'\r\n\t}\r\n];\r\n\r\nconst useStyles = makeStyles({\r\n\tcommon: {\r\n\t\tcolor: '#00AFBC !important'\r\n\t},\r\n\tselected: {\r\n\t\tbackgroundColor: '#00AFBC !important',\r\n\t\tcolor: '#ffffff !important',\r\n\t},\r\n\troot: {\r\n\t\twidth: '435px',\r\n\t\tbackgroundColor: '#F1F9FA',\r\n\t\tborderRadius: '0px 8px 0px 0px'\r\n\t}\r\n});\r\n\r\nexport default function ChatBar() {\r\n\tconst theme = useTheme();\r\n\tconst [value, setValue] = React.useState(0);\r\n\r\n\tconst handleChange = (event, newValue) => {\r\n\t\tsetValue(newValue);\r\n\t};\r\n\r\n\tconst handleChangeIndex = (index) => {\r\n\t\tsetValue(index);\r\n\t};\r\n\r\n\tconst classes = useStyles();\r\n\r\n\treturn (\r\n\t\t<Box style={{ position: 'relative', height: '100vh', borderRight: '1px solid #F1F9FA' }}>\r\n\t\t\t<AppBar position=\"static\" classes={{\r\n\t\t\t\troot: classes.root\r\n\t\t\t}}>\r\n\t\t\t\t<Tabs\r\n\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\troot: classes.root\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tTabIndicatorProps={{\r\n\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\tdisplay: 'none'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\ttextColor=\"primary\"\r\n\t\t\t\t\tvariant=\"fullWidth\"\r\n\t\t\t\t\taria-label=\"full width tabs example\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tchatBarHeaderArr.map((el, idx) =>\r\n\t\t\t\t\t\t\t<Tab\r\n\t\t\t\t\t\t\t\tkey={idx}\r\n\t\t\t\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\t\t\t\troot: classes.common,\r\n\t\t\t\t\t\t\t\t\tselected: classes.selected\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\ticon={value === idx ? el.activeTabIcon : el.notActiveTabIcon}\r\n\t\t\t\t\t\t\t\tlabel={el.label}\r\n\t\t\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\t\t\ttextTransform: 'none',\r\n\t\t\t\t\t\t\t\t\tfontFamily: 'Roboto',\r\n\t\t\t\t\t\t\t\t\tfontSize: '14px',\r\n\t\t\t\t\t\t\t\t\tfontStyle: 'normal',\r\n\t\t\t\t\t\t\t\t\tfontWeight: 700,\r\n\t\t\t\t\t\t\t\t\tletterSpacing: 0,\r\n\t\t\t\t\t\t\t\t\tflexDirection: 'row',\r\n\t\t\t\t\t\t\t\t\tpadding: 0\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t{...a11yProps(idx)}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t</Tabs>\r\n\t\t\t</AppBar>\r\n\t\t\t<SwipeableViews\r\n\t\t\t\taxis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\r\n\t\t\t\tindex={value}\r\n\t\t\t\tonChangeIndex={handleChangeIndex}\r\n\t\t\t>\r\n\t\t\t\t<TabPanel children='div' value={value} index={0} dir={theme.direction}>\r\n\t\t\t\t\t<TabPanelContainer panelType={panelTypes[0].type} />\r\n\t\t\t\t</TabPanel>\r\n\t\t\t\t<TabPanel children='div' value={value} index={1} dir={theme.direction}>\r\n\t\t\t\t\t<TabPanelContainer panelType={panelTypes[1].type} />\r\n\t\t\t\t</TabPanel>\r\n\t\t\t\t<TabPanel children='div' value={value} index={2} dir={theme.direction}>\r\n\t\t\t\t\t<TabPanelContainer panelType={panelTypes[2].type} />\r\n\t\t\t\t</TabPanel>\r\n\t\t\t</SwipeableViews>\r\n\t\t</Box >\r\n\t);\r\n}","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAATCAYAAAB/TkaLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHLSURBVHgBpZRPTgIxFMa/zqBx4WK4AZ4AuAEkgHElxbh2PIF4AvQE4gmAPaawIgIGbiA3EG8wiS5MwNbXFgYQEJCXzMzrv1+/vvc6DLua6HmQYx/OuAF+Nlw1xcG2Vn/OW+fLg8MegIM3iJcKRCv2P6he7LrntnEU0KtvfeUT/BX1bn57qBAeAYVdPDGeDsAzaWB0Qq0hPR5cCDS7V5uhGojjHgHzK8dNPN1kqFqiPA2F8zeQJZbHKFGinQhVw+WhYhxUdDczEyRbVOMwfZTYL1yVjn1t1VCSpLrFRbZsN+qkCNWz09xoBNJNwFEl7Gq6AkTLlhXP9iG6gVFL5bZ9Sa0yGfFDX8nmZLP4flCGWcwVG9qviu4HxQRkXOZN3T2VfvdnPuLmqzCIUJKChR3tSAybjZJ02jCerc+U8SX6ESqThpkwb6Lt0yEqa3EKj2Afd7OOw5LuhK7XyyxBVxnPVQk8ILCuPW9xzPyZimG72b2hmvVtQ97r9/qY8hxBJd1xBGvnGCDKoXotBpsSZcCjJOw1nNlTp0jF3psD1lDIhOo3Z98cd0SK1btp66SY/6lJDJ2Crmsh488vYdjVTKYPKdayBnyWwflSeH4AEYWjVRlf4nUAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAATCAYAAAB/TkaLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAENSURBVHgBpZSBEYIwDEWD5wC4QTfQERzBDcQJxA0cgQ3qBuoEuIFuABvABjXxUvnXAwH770pzJbwkJFeimXLOpbxyXoZixZCd7sZ1sn/D9WMLmZYAbnzAqTABXH1WwTvJuAL4firwiaUO+JSQsZkDdEH5m8C3Up9SzpbqEP4TKcUMxEx5ScBTkiQFr5btA58JcCtBJFLmpsnCv/QykHGjZ/mC4pSBfdd9HQvdgF3rvoqF1mCn3oiFPsBe6/5a8qMNIooMjevGnb+JoQ3b9gTqNDAR2P3iMzqdv1Wfin5J5hfG5Avt8TuCT0ZjCsB2BFjQVLnu4rBwJvdpCcALzZWCz2B7SRU5xQoyP2OzUG+lR704IotqDQAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAUCAYAAABmvqYOAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIJSURBVHgBlVRdTttAEP5m7fSpQtwAOEHdE5RIpFLfulL73PQESU9QcoLCCaAHQG4eqkotEdsTEE5AOAEBIV6Id5jddX4c7MT5pHV249lvxvPNDGEZabqNyesECvtQtAPQGDa7gsoM9IcRNgAVTv3zDiwOZbddYX4EqB50c4yNyNPBCcDtGneGQNSs40D5Z3/wvQaxIzNg+x9Zto8aIKQXkoLsdoWNEcc94GEIrWulY4rYRxFVveZv0K0jLzK2OkjPP8qfyYLBSOIzyLiPTwe/8CLys0Ebik9KiCWvLSNauJR1USnyoqOn5mJFKTCPKyI2uciHNYgddoHGBdK/yZw8igyCWFMYn4p6Ipc4UGnQ0ZH7knKC5ZjIPv2zC+sjLoPY27eSgr3CYhzPHNhJN5B7PJyGS7I+Szq40UU1JKpImi1uFxbxu5mFoo77icNp64dE7zZBccKbYqRYqgRGGA3LThf2vwc7Ofm9CKi/ohwj+ewe1uLVKBc/4NHuBfLl5mB7A1LTk6jfuMZacPEYx8O43E4qiPhLfpJZ8qSxllt0InRmd6RQysmVkhxnUoqutHz9iiZY3frEyXwOWl85VGnsm0FdYnOcQh94/VSliX4/dE94QTcBzb5QrbTTbhjJvGD7E6thZB2HQGQOnf3zfUKoC9e1aCTSuYmvcbZ3IBIyJ17LzO1kgubV9wyfgMJZt5YNTQAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAUCAYAAABmvqYOAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFiSURBVHgBnVSBcYMwDJRzGSCdADpBGYENmk7QZIK0EySdIN0ARugG0AmSTgCdoHQC9wXyoXIxBv7uzxiL11uyMTSAtXaDIQFTMAIb8AssjTE1LQWED+CP9eMsyWcLZ3YaLlMTrET4iGEXiOXylOAndSWb5HgTcFqAqV1Yju2I8IsycJSSaFRSzq1PfOcRTmWdRcearBPFU5w7x5mdhwpMhjXXzgrleAkqq/vDTtUiNy8e+ZiNJBKj+a5iTqxrnHsMVfvCmDsOxOOB/MjB78G7R+puNqNhnbVMzjJ+yPigPmrUe41oMNdHlUsdOfFXZNrTbdTgG4XBcSc1v2/FIdwMAvWWeasVzcd17VkowWcXBD5RGHx8XZ+ubNjcipIGX8CY+n9KExBPqG/oHuK5N1KO2xJkTmPlE0dmV46a5iG0w3874AuSB9wWcokqmbe/DzMnCfV15TP+S92uuHmlitu40/cHC2mg/dMjyEcAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGjSURBVHgBlZRdTsJAEMf/u+2jJtzAHgFPYInBxCdsOAD1BMIJxBPADSzPftQ+GKNC6A3UG9QTyKORsnW2NPRrKeX/MDvpbH87O7uzDEW5s2uyNhAZNAYA8wE+gNVaoIZYATYiUF8xLwC04zpQvvEe3uwtMCkDIuyjhlIg553qmby38V23gbt3Mx63AuvKkzU+/IHO5jR+wJv21MAI39WkKIBLWYlomPlIpcAY7rxRBrLlmGxF0cWETFMRaCAMm2WgdR6QvVRCRXQD68wh7xMq6WGwyasUdF8MuiImrXVC2/wCwqdksbUepw791cst1m0P1UB5auLAjreRagFegMa15Aa4CGC1/SwiBXrTKyrwsABDJpMBZTKOrwuHmQbosLpxOTLA+9cLaJqLXQqjFnR5MGyUDzAH1qmsf3IomjZCHensloxDnp8PRPa60yRw7RioJwOrP5MAXimSdBLf2XJFaVonybIoE8+zI4762SViZvLqlO/r76olgU3spfidlAoUixn7Pw6plG3KUdm/SgVVQR2yf0VUf9tcJP1MLSf4JB9b+v8Iooi9WfNMawAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGYSURBVHgBnZRdTsJAEMdnt0008QVfMAaN9Qb1BJYLiD2BcALjCYATwA0sJyhGfZYbqCfoGoIEeYBXhXadLaX0C9rln0wm6ez+dnZ2pgAJcc6baA5fSfhHtBLsI9zY4dlypKG4oc53qyXDE0A7B+is19qOU7KHY0P4JIeCpJ7H0yY9OJpRRXlD//4y/rnbBvzKYTGRlRe/uuZy6EYzjQK7aPMdwB4oqp7xvQTqoZ4CEkIYusYWaBvjFrjLD8jSEljIScaw+Bo6A+0a7ROtHxzmyx5NLEpIWDcsQdusnLQygUGv1f1rbDRPQbGWQBQNuMvM89NBlEEisHt0rQQsqgeEdu3h1ADqGZssCDPPylYMiLBbcTDkq9ofTXRKaSeWFQfrplJuRIGiabUCQIZ2hb1o81WdQ3keNESmVIxcQRgE6wwXyFMyoFDwH0q0TQ3kVINf1Up+FBm/fs8uKBTPbi3DvDzGlyepfv3zFlUB1EFOWuBZKkK4Jv1zCPcSnjmmAjgHObFdQRVW8ytzbX+e3aXbxmnpxSILb/APeIcA6/D9TPQAAAAASUVORK5CYII=\"","import React, { useContext, useEffect, useRef, useState } from 'react'\r\nimport Box from '@mui/material/Box';\r\nimport { Grid } from '@material-ui/core';\r\nimport './Chat.css'\r\nimport { VoiceChatButtonsContext, WSSSContext } from '../../../utils/Context';\r\nimport { initializePeerConnection } from '../peer/Peer';\r\nimport { getVideoAudioStream } from '../../../utils/audioVideoContent/AudioVideoInitiator';\r\nimport { createVideo } from '../../../utils/audioVideoContent/VideoCreator';\r\nimport { getScreen } from '../../../utils/audioVideoContent/ScreenShareInitiator';\r\n\r\nimport { startSocketIO } from '../../socket/socketForAVChat';\r\nimport { mainServerRoot, pathForWebSocket } from '../../socket/constants';\r\nimport { io } from 'socket.io-client';\r\nimport ChatBar from './chat-bar/ChatBar';\r\n\r\nexport const Chat = ({ getUsersFromStore }) => {\r\n\r\n\tconst [isAudio, setIsAudio] = useState(false);\r\n\tconst [isVideo, setIsVideo] = useState(false);\r\n\tconst [isScreen, setIsScreen] = useState(false);\r\n\tconst [messages, setMessages] = useState([]);\r\n\tconst { userUUID, sessionToken } = useContext(WSSSContext);\r\n\tconst [socketId, setSocketId] = useState('');\r\n\tconst videoData = {};\r\n\tconst [connections, setConnections] = useState({})\r\n\r\n\tconst [peer, setPeer] = useState(null);\r\n\t// const [remotePeerId, setRemotePeerId] = useState('');\r\n\tconst [outcomeStream, setOutcomeStream] = useState([]);\r\n\tconst [innerStream, setInnnerStream] = useState(null);\r\n\tconst [myVideoAdded, setMyVideoAdded] = useState(false);\r\n\tconst [currentPeer, setCurrentPeer] = useState([]);\r\n\tconst [peerIDsList, setPeerIDsList] = useState([]);\r\n\tconst [buttonDisabled, setButtonDisabled] = useState(true)\r\n\tconst socket = useRef(io.connect(`https://${mainServerRoot}/`, {\r\n\t\tpath: pathForWebSocket,\r\n\t}));\r\n\r\n\r\n\r\n\tconst [userFromSocket, setUserFromSocket] = useState(null);\r\n\r\n\t//refs\r\n\tconst videoContainer = useRef();\r\n\r\n\t//initialize navigator \r\n\tuseEffect(() => {\r\n\t\tgetVideoAudioStream().then((stream) => {\r\n\t\t\tif (stream) {\r\n\t\t\t\tsetInnnerStream(stream);\r\n\t\t\t}\r\n\t\t})\r\n\t}, [])\r\n\r\n\t//initialize peer\r\n\tuseEffect(() => {\r\n\t\tif (userUUID && sessionToken) {\r\n\t\t\tsetPeer(initializePeerConnection(userUUID, sessionToken));\r\n\t\t\tsetSocketId(`${sessionToken}_9693986f-a0ad-4f50-9b98-4f740faa942c`)\r\n\t\t}\r\n\t}, [userUUID, sessionToken])\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tif (innerStream && peer) {\r\n\t\t\tsocket.current.on('user_connected', (args) => {\r\n\t\t\t\tconsole.log('User connected => ', args)\r\n\t\t\t\tif (args !== peer.id) {\r\n\t\t\t\t\tconnectAndCall(args, innerStream)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\t// socket.current.on('user_list', (args) => {\r\n\t\t\t// \tconsole.log('users in list => ', args);\r\n\t\t\t// \tsetTimeout(function () {\r\n\r\n\t\t\t// \t\tfor (let remotePeerID of args) {\r\n\t\t\t// \t\t\tif (remotePeerID !== peer.id) {\r\n\t\t\t// \t\t\t\tconnectAndCall(remotePeerID, innerStream)\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t}\r\n\t\t\t// \t}, 2000)\r\n\t\t\t// })\r\n\t\t}\r\n\t}, [innerStream, peer])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (peer && innerStream)\r\n\t\t\tpeer.on('call', (call) => {\r\n\r\n\t\t\t\tconst peerID = call.peer;\r\n\t\t\t\tif (peerID in connections) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetConnections(connections[peerID] = {\r\n\t\t\t\t\tcall: call,\r\n\t\t\t\t\tvideo: undefined,\r\n\t\t\t\t\tinnerStream: undefined,\r\n\t\t\t\t})\r\n\r\n\t\t\t\tcall.answer(innerStream);\r\n\r\n\t\t\t\tcall.on('stream', (remoteStream) => {\r\n\t\t\t\t\tif (connections[peerID].innerStream !== undefined) return;\r\n\t\t\t\t\tsetRemoteStream(remoteStream, call)\r\n\t\t\t\t});\r\n\r\n\t\t\t\tcall.on('close', () => {\r\n\t\t\t\t\tconsole.log('closed');\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t}, [peer, innerStream])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (peer && socketId) {\r\n\t\t\tstartSocketIO(socket, peer, connectAndCall, disconnectFromPeer);\r\n\t\t}\r\n\t}, [peer, socketId])\r\n\r\n\tuseEffect(() => {\r\n\t\tsocket.current.on('connected_result', (arg) => {\r\n\t\t\tconsole.log(arg);\r\n\t\t\tsetUserFromSocket(arg);\r\n\t\t})\r\n\t}, [])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (peer) {\r\n\t\t\tpeer.on('open', function (id) {\r\n\r\n\t\t\t\tsocket.current.emit('user_connected', socketId)\r\n\r\n\t\t\t\tsetPeerIDsList([...peerIDsList, id]);\r\n\t\t\t});\r\n\r\n\t\t\tpeer.on('connection', function (connection) {\r\n\t\t\t\tsetButtonDisabled(false)\r\n\t\t\t});\r\n\r\n\t\t\tpeer.on('close', () => {\r\n\t\t\t\tconsole.log('closed');\r\n\t\t\t})\r\n\r\n\t\t\tpeer.on('error', err => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t})\r\n\t\t}\r\n\t}, [peer])\r\n\r\n\tconst setRemoteStream = (remoteStream, call) => {\r\n\t\tconst peerID = call.peer;\r\n\t\tif (!peerIDsList.includes(peerID)) {\r\n\t\t\tconst video = createVideo(userUUID, videoData, { id: peerID, stream: remoteStream }, videoContainer.current, 0);\r\n\t\t\tsetCurrentPeer(currentPeer => [...currentPeer, call.peerConnection]);\r\n\t\t\tsetPeerIDsList([...peerIDsList, call.peer]);\r\n\t\t\tsetConnections(connections[peerID].innerStream = remoteStream)\r\n\t\t\tsetConnections(connections[peerID].video = video)\r\n\t\t}\r\n\t}\r\n\r\n\tconst disconnectFromPeer = (peerId) => {\r\n\t\tif (peerId in connections == false) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tconnections[peerId].video.remove();\r\n\t\t\tconnections[peerId].connection.close();\r\n\t\t\tconnections[peerId].conn.close();\r\n\t\t} catch (e) {\r\n\t\t\tconsole.log(e);\r\n\t\t}\r\n\t\tconnections[peerId] = undefined;\r\n\t\tdelete connections[peerId];\r\n\t}\r\n\r\n\tconst startCapture = () => {\r\n\t\tsetIsScreen(true);\r\n\t}\r\n\t//replace videostream and start screensharing\r\n\tuseEffect(() => {\r\n\t\tif (isScreen) {\r\n\t\t\tgetScreen().then((stream) => {\r\n\t\t\t\tif (stream) {\r\n\t\t\t\t\tconst videoTrack = stream.getVideoTracks()[0];\r\n\t\t\t\t\tvideoTrack.onended = () => {\r\n\t\t\t\t\t\tstopCapture();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tcurrentPeer.forEach(peer => peer.getSenders().find(s => s.track.kind === videoTrack.kind).replaceTrack(videoTrack));\r\n\t\t\t\t}\r\n\t\t\t}).catch(err => {\r\n\t\t\t\tconsole.log('Unable to get display media ' + err);\r\n\t\t\t})\r\n\t\t}\r\n\t}, [isScreen])\r\n\r\n\tconst stopCapture = () => {\r\n\t\tconst videoTrack = innerStream.getVideoTracks()[0];\r\n\t\tcurrentPeer.forEach(peer => peer.getSenders().find(s => s.track.kind === videoTrack.kind).replaceTrack(videoTrack))\r\n\t\tsetIsScreen(false);\r\n\t}\r\n\r\n\tconst connectAndCall = (remotePeerId, stream) => {\r\n\t\tif (remotePeerId in connections) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tsetButtonDisabled(false);\r\n\t\tlet call = peer.call(remotePeerId, stream);\r\n\t\tsetConnections(connections[remotePeerId] = {\r\n\t\t\tcall: call,\r\n\t\t\tvideo: undefined,\r\n\t\t\tinnerStream: undefined,\r\n\t\t\tconn: peer.connect(remotePeerId)\r\n\t\t})\r\n\r\n\t\tcall.on('stream', (remoteStream) => {\r\n\t\t\tif (connections[remotePeerId].innerStream !== undefined) return;\r\n\t\t\tsetRemoteStream(remoteStream, call)\r\n\t\t});\r\n\r\n\t\tcall.on('close', () => {\r\n\t\t\tsetButtonDisabled(true);\r\n\t\t})\r\n\t}\r\n\r\n\t//Control of outcoming sound and video tracks. Mute by default\r\n\t// useEffect(() => {\r\n\t// \tif (!outcomeStream) return;\r\n\r\n\t// \toutcomeStream.forEach(stream => stream.getAudioTracks().forEach(track => {\r\n\t// \t\ttrack.enabled = isAudio;\r\n\t// \t}))\r\n\t// \toutcomeStream.forEach(stream => stream.getVideoTracks().forEach(track => {\r\n\t// \t\ttrack.enabled = isVideo;\r\n\t// \t}))\r\n\r\n\t// }, [outcomeStream, isAudio, isVideo]);\r\n\r\n\r\n\t//Control of inner sound and video tracks. Mute by default\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!innerStream) return;\r\n\t\tinnerStream.getVideoTracks()[0].enabled = isVideo;\r\n\t}, [innerStream, isVideo]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!innerStream) return;\r\n\t\tinnerStream.getAudioTracks()[0].enabled = isAudio;\r\n\t}, [innerStream, isAudio]);\r\n\r\n\t//context for buttons\r\n\tconst [voiceChatCtx, setVoiceChatCtx] = useState({\r\n\t\tisAudio: null,\r\n\t\tsetIsAudio: null,\r\n\t\tisVideo: null,\r\n\t\tsetIsVideo: null,\r\n\t\tisScreen: null,\r\n\t\tstartCapture: null,\r\n\t\tstopCapture: null,\r\n\t\tsocket: null,\r\n\t\tmessages: null,\r\n\t\tsetMessages: null,\r\n\t\tme: null\r\n\t})\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tsetVoiceChatCtx({\r\n\t\t\tisAudio: isAudio,\r\n\t\t\tsetIsAudio: setIsAudio,\r\n\t\t\tisVideo: isVideo,\r\n\t\t\tsetIsVideo: setIsVideo,\r\n\t\t\tisScreen: isScreen,\r\n\t\t\tstartCapture: startCapture,\r\n\t\t\tstopCapture: stopCapture,\r\n\t\t\tsocket: socket,\r\n\t\t\tmessages: messages,\r\n\t\t\tsetMessages: setMessages,\r\n\t\t\tme: `${userUUID}_${sessionToken.split('-')[0]}`\r\n\t\t})\r\n\r\n\t}, [isAudio, isVideo, isScreen, messages, userUUID, sessionToken])\r\n\r\n\treturn (\r\n\t\t<VoiceChatButtonsContext.Provider value={voiceChatCtx}>\r\n\t\t\t<Grid >\r\n\t\t\t\t<Box sx={{ display: 'flex', flexDirection: 'row' }}>\r\n\t\t\t\t\t<ChatBar />\r\n\t\t\t\t\t<Box ref={videoContainer} sx={{ width: 'calc(100% - 435px)', display: 'flex', flexDirection: 'row', flexWrap: 'wrap', alignItems: 'flex-start', justifyContent: 'flex-start' }}>\r\n\t\t\t\t\t</Box >\r\n\t\t\t\t</Box >\r\n\t\t\t</Grid >\r\n\t\t</VoiceChatButtonsContext.Provider >\r\n\t);\r\n}","export const getVideoAudioStream = () => {\r\n\tconst myNavigator = navigator.mediaDevices.getUserMedia ||\r\n\t\tnavigator.mediaDevices.webkitGetUserMedia ||\r\n\t\tnavigator.mediaDevices.mozGetUserMedia ||\r\n\t\tnavigator.mediaDevices.msGetUserMedia;\r\n\treturn myNavigator({\r\n\t\tvideo: {\r\n\t\t\tnoiseSuppression: true,\r\n\t\t\twidth: { min: 640, ideal: 1280, max: 1920 },\r\n\t\t\theight: { min: 480, ideal: 720, max: 1080 }\r\n\t\t},\r\n\t\taudio: {\r\n\t\t\techoCancellation: true,\r\n\t\t\tnoiseSuppression: true\r\n\t\t}\r\n\t});\r\n}","import React from 'react';\r\nimport Peer from 'peerjs';\r\nimport { mainServerRoot, pathForPeer } from '../../socket/constants';\r\n\r\n\r\nexport const initializePeerConnection = (userUUID, sessionToken) => {\r\n\tconst peerID = `${userUUID}_${sessionToken.split('-')[0]}`;\r\n\treturn new Peer(peerID, {\r\n\t\thost: mainServerRoot,\r\n\t\tdebug: 1,\r\n\t\tport: 443,\r\n\t\tpath: pathForPeer,\r\n\t\tsecure: true\r\n\t});\r\n}","export const createVideo = (myId, videoContainer, createObj, videoDestination, whoseVideo) => {\r\n\tif (!videoContainer[createObj.id]) {\r\n\t\tvideoContainer[createObj.id] = { ...createObj };\r\n\r\n\t\tconst roomContainer = videoDestination;\r\n\t\tconst video = document.createElement('video');\r\n\r\n\t\t//0 for my video, 1 for incoming video\r\n\t\tif (whoseVideo === 0) {\r\n\t\t\tvideo.classList.add('internalVideo');\r\n\t\t}\r\n\t\tif (whoseVideo === 1) {\r\n\t\t\tvideo.classList.add('externalVideo');\r\n\t\t}\r\n\r\n\t\tvideo.srcObject = videoContainer[createObj.id].stream;\r\n\t\tvideo.id = createObj.id;\r\n\t\tvideo.autoplay = true;\r\n\t\tvideo.controls = true;\r\n\t\tif (myId === createObj.id) video.muted = true;\r\n\t\troomContainer.append(video);\r\n\t\treturn video\r\n\t} else {\r\n\t\treturn\r\n\t}\r\n}","export const getScreen = () => {\r\n\tconst myDispplay = navigator.mediaDevices.getDisplayMedia({\r\n\t\tvideo: {\r\n\t\t\tcursor: 'always'\r\n\t\t},\r\n\t\taudio: true\r\n\t});\r\n\treturn myDispplay\r\n}","import { useRef, useEffect, useMemo, useState } from 'react';\nimport './App.css';\nimport { NavBar } from \"./components/common/navbar/NavBar\";\nimport { Switch, Route, Redirect } from 'react-router-dom'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { getWayConnection } from './components/socket/getWayConnect';\nimport { Preloader } from './components/common/preloader/Preloader'\nimport { mainRoot, mainServerRoot, pathForWebSocket } from './components/socket/constants';\nimport { WSSSContext } from './utils/Context';\nimport { initializeApp, setLinkForSS } from './components/redux/appReducer';\nimport { Chat } from './components/common/chat/Сhat';\nimport { Main } from './components/common/main/Main'\nimport { io } from 'socket.io-client';\n\nfunction App() {\n\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    dispatch(initializeApp());\n  }, [])\n\n\n  //ref for ws\n  // const socket = useRef(io(`https://${mainServerRoot}/`, {\n  //   path: pathForWebSocket,\n  // }));\n\n  const [contextWSSS, setContextWSSS] = useState({\n    linkForSS: '',\n    sessionToken: '',\n    userUUID: '',\n    type: '',\n    lobbyUUID: ''\n  })\n\n  const [lobbyUUID, setLobbyUUID] = useState('');\n\n  //get initial data for GetWay and SoundServer\n  const linkForSS = useSelector(state => state.app.linkForSS)\n  const sessionToken = useSelector(state => state.users.self.session_uuid)\n  const userUUID = useSelector(state => state.users.self.user_uuid)\n  const getConnectionType = useSelector(state => state.app.type)\n\n\n  //get users from store\n  const getUsersFromStore = useSelector(state => state.users.users)\n\n  useMemo(() => {\n    setContextWSSS({ linkForSS, sessionToken, userUUID, getConnectionType, lobbyUUID })\n  }, [linkForSS, sessionToken, userUUID, getConnectionType, lobbyUUID])\n\n\n  return (\n    <WSSSContext.Provider value={contextWSSS}>\n      <div className=\"home\" style={{ textAlign: \"center\" }}>\n\n        {/* <NavBar\n          getUsersFromStore={getUsersFromStore}\n          record={isAudio}\n          setIsAudio={setIsAudio}\n        /> */}\n        {/* <Switch>\n          <Route exact path={mainRoot} render={() => <Main lobbyUUID={lobbyUUID} setLobbyUUID={setLobbyUUID} sessionUUID={sessionTokenForSS} />} />\n          <Route exact path={mainRoot + `/lobby/${lobbyUUID}`} render={() => <ChatBar\n            getUsersFromStore={getUsersFromStore}\n            isAudio={isAudio}\n            setIsAudio={setIsAudio}\n            isVideo={isVideo}\n            setIsVideo={setIsVideo}\n            linkForSS={linkForSS}\n          // socket={socket.current}\n          />} />\n          <Route path='*'\n            render={() => <div> 404 Page not found!</div>} />\n        </Switch> */}\n        <Chat\n          getUsersFromStore={getUsersFromStore}\n        />\n      </div>\n    </WSSSContext.Provider >\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { BrowserRouter } from 'react-router-dom'\nimport reportWebVitals from './reportWebVitals';\nimport { Provider } from 'react-redux';\nimport store from './components/redux/store'\n\n\nReactDOM.render(\n\n  <BrowserRouter>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </BrowserRouter>\n  ,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}