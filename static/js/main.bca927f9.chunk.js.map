{"version":3,"sources":["../node_modules/peerjs/dist sync","components/socket/constants.js","utils/Context.js","api/Api.js","components/redux/usersReducer.js","components/redux/appReducer.js","components/common/navbar/NavBar.js","components/common/microphone/Microphone.js","components/redux/store.js","assets/src/preloader/preloader.gif","components/common/preloader/Preloader.js","utils/audioVideoContent/AudioVideoInitiator.js","utils/audioVideoContent/VideoCreator.js","utils/TimeFormatter.js","components/common/chatRooms/chatBar.js","utils/audioVideoContent/ScreenShareInitiator.js","components/common/peer/Peer.js","components/common/main/Main.js","components/socket/getWayConnect.js","App.js","reportWebVitals.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","mainRoot","getWayWebSocket","WSSSContext","createContext","instance","Axios","baseURL","authAPI","get","SET_USER_DATA","GET_CURRENT_USERS_LIST","USER_JOINED","USER_LEFT","initialState","users","self","session_uuid","user_id","user_uuid","email","avatar","first_name","secon_name","last_name","phone","birthday","sex","company_uuid","company_name","company_position","company_role","system_role","isAuth","setAuthUserData","payload","type","INITIALIZED_SUCCESS","ON_LINK_GOTTEN","GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT","GET_OUTPUT_PLAYER_SCREEN_FROM_SERVER","initialized","linkIsFetched","linkForSS","onDialog","outputPlayerVoiceFromClient","outputPlayerScreemFromSS","setLinkForSS","link","useStyles","makeStyles","theme","root","flexGrow","menuButton","marginRight","spacing","title","style","position","top","right","width","maxHeight","bgcolor","boxShadow","p","border","overflow","readPlayerFromPlayerList","buffer","startOffset","hasPosition","userUUIDLen","uuid","offset","readUtf8String","readUInt32LE","x","y","z","readFloatLE","state","readUInt8","NavBar","getUsersFromStore","record","setScreenBlob","webSocket","classes","useState","openModal","setOpenModal","connected","setConnected","dispatch","useDispatch","useContext","sessionTokenForSS","userUUID","getConnectionType","lobbyUUID","webSocketSS","setUsers","useEffect","start","linkSS","console","log","WebSocket","current","window","binaryType","onopen","array","Uint8Array","methodBuffer","Uint32Array","sessionBuffer","TextEncoder","encode","locationUUIDBuffer","set","send","readyState","onmessage","message","BufferStream","data","method","readInt32LE","countPlayers","index","user","push","setUsersFromList","JSON","stringify","setUserJoined","userUuid","blobForPlay","outputBlob","Blob","fileReader","FileReader","readAsDataURL","onloadend","base64String","result","audio","Audio","addEventListener","play","outputPlayerVoice","onclose","setTimeout","onerror","err","close","sendPlayerTick","audioChunk","voiceBody","byteLength","Float32Array","useMemo","pinging","interval","clearTimeout","className","AppBar","Toolbar","Typography","variant","Button","color","onClick","Modal","open","onClose","closeAfterTransition","BackdropComponent","Backdrop","BackdropProps","timeout","Fade","in","Box","sx","component","length","map","u","mt","icon","height","reactmic","flex","Microphone","size","isAudio","setIsAudio","isVideo","setIsVideo","Grid","container","justifyContent","item","IconButton","reducers","combineReducers","app","action","voice","screen","filter","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunkMiddleware","__store__","Preloader","getVideoAudioStream","navigator","mediaDevices","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","video","noiseSuppression","min","ideal","max","echoCancellation","createVideo","myId","videoContainer","createObj","videoDestination","whoseVideo","roomContainer","document","createElement","classList","add","srcObject","stream","autoplay","muted","append","timeFormatHelper","value","drawerWidth","ChatBar","videoData","peer","setPeer","outcomeStream","incomeStream","setIncomeStream","setMyVideoAdded","callType","setCallType","currentPeer","setCurrentPeer","peerList","setPeerList","useRef","connection","setConnection","messages","setMessages","messageBox","getDisplayMedia","cursor","then","videoTrack","getVideoTracks","onended","stopCapture","getSenders","find","s","track","kind","replaceTrack","catch","remotePeerId","setRemotePeerId","Peer","initializePeerConnection","on","call","answer","remoteStream","includes","peerConnection","mess","me","currentMinutes","Date","getMinutes","currentHour","getHours","forEach","getAudioTracks","enabled","display","zIndex","drawer","left","noWrap","Drawer","flexShrink","boxSizing","anchor","Divider","List","marginTop","overflowY","dataObj","ListItem","ListItemText","fontWeight","m","noValidate","autoComplete","bottom","TextField","label","multiline","rows","inputProps","paddingRight","ref","preventDefault","flexDirection","maxWidth","primary","disablePadding","ListItemButton","margin","marginLeft","paragraph","marginBottom","connect","onChange","target","Main","sessionUUID","setLobbyUUID","handleConnectToGetWay","connectionType","newWS","token","dataFromGetWay","parse","undefined","lobby_uuid","ip","port","getWayConnection","handleGetLobbyUUID","useCallback","exact","to","textDecoration","Stack","direction","Input","App","a","promise","response","Promise","all","setLoaded","contextWSSS","setContextWSSS","useSelector","Provider","textAlign","path","render","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.bca927f9.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 197;","//variable for main root because of GHP deploy. \r\n//Probably needs to be switched to '/'\r\nexport const mainRoot = '/chat'\r\n\r\nexport const getWayWebSocket = \"wss://getway.dev.viexpo.ru/service/getway\";\r\n\r\n\r\nexport const CONST_X_VIEXPO_INTERNAL_TOKEN = 'x-viexpo-internal-token-test'\r\nexport const CONST_X_VIEXPO_SESSION_TOKEN_BODY = 'x-viexpo-session-token'\r\n\r\nexport const ToGetway_FromUnknown_AuthSocket = 0;\r\nexport const FromGetway_AuthSocket_Response = 1;\r\nexport const ToGetway_FromInternal_GetUser = 2;\r\nexport const ToGetway_FromInternal_GetUserFromSession = 3;\r\nexport const FromGetway_ToInternal_GetUserResponse = 4;\r\nexport const ToGetway_FromPlayer_GetMovementServer = 5;\r\nexport const FromGetway_FromPlayer_GetMovementServerResponse = 6;\r\nexport const ToGetway_FromPlayer_GetSoundServer = 7;\r\nexport const FromGetway_FromPlayer_GetSoundServerResponse = 8;\r\n\r\n\r\nexport const ToMovement_ToPlayerScene_PlayerTick = 9991;\r\nexport const FromMovement_FromPlayerScene_PlayerJoin = 9992;\r\nexport const FromMovement_FromPlayerScene_PlayerLeave = 9993;\r\nexport const FromMovement_FromPlayerScene_PlayerList = 9994;\r\nexport const FromMovement_FromPlayerScene_PlayerPosition = 9995;\r\nexport const FromSound_FromPlayerScene_PlayerVoice = 9996;\r\n\r\nexport const timeInterval = 1000;\r\n\r\n","import React, { createContext } from \"react\";\r\n\r\nexport const WSSSContext = createContext();","import * as Axios from 'axios';\r\n\r\n//axios base setup\r\nlet instance = Axios.create({\r\n\tbaseURL: 'https://getway.dev.viexpo.ru/api/',\r\n\t// headers: {\r\n\t// \t'x-viexpo-tenant': '0',\r\n\t// }\r\n});\r\n\r\nexport const authAPI = {\r\n\tme() {\r\n\t\treturn instance.get('account/fake/get')\r\n\t}\r\n}","import { authAPI } from \"../../api/Api\";\r\n\r\nconst SET_USER_DATA = 'SET_USER_DATA';\r\nconst GET_CURRENT_USERS_LIST = 'GET_CURRENT_USERS_LIST';\r\nconst USER_JOINED = 'USER_JOINED';\r\nconst USER_LEFT = 'USER_LEFT';\r\n\r\nconst initialState = {\r\n\tusers: [],\r\n\tself: {\r\n\t\tsession_uuid: \"\",\r\n\t\tuser_id: null,\r\n\t\tuser_uuid: \"\",\r\n\t\temail: \"\",\r\n\t\tavatar: \"\",\r\n\t\tfirst_name: \"\",\r\n\t\tsecon_name: \"\",\r\n\t\tlast_name: \"\",\r\n\t\tphone: \"\",\r\n\t\tbirthday: \"\",\r\n\t\tsex: \"\",\r\n\t\tcompany_uuid: \"\",\r\n\t\tcompany_name: \"\",\r\n\t\tcompany_position: \"\",\r\n\t\tcompany_role: null,\r\n\t\tsystem_role: null\r\n\t},\r\n\tisAuth: false\r\n}\r\n\r\nexport const usersReducer = (state = initialState, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase SET_USER_DATA:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tself: { ...action.payload },\r\n\t\t\t\tisAuth: true\r\n\t\t\t};\r\n\t\tcase GET_CURRENT_USERS_LIST:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tusers: action.users\r\n\t\t\t};\r\n\t\tcase USER_JOINED:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tusers: [...state.users, action.user]\r\n\t\t\t};\r\n\t\tcase USER_LEFT:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tusers: state.users.filter(u => u.uuid != action.userUuid)\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn state\r\n\t}\r\n}\r\n\r\n//ac\r\n\r\nexport const setAuthUserData = payload => ({ type: SET_USER_DATA, payload })\r\nexport const setUsersFromList = users => ({ type: GET_CURRENT_USERS_LIST, users })\r\nexport const setUserJoined = user => ({ type: USER_JOINED, user })\r\nexport const setUserLeft = userUuid => ({ type: USER_LEFT, userUuid })\r\n\r\n//thunk\r\nexport const getAuthUserData = () => async (dispatch) => {\r\n\tlet response = await authAPI.me();\r\n\r\n\tif (response.data.code === 0) {\r\n\t\tlet payload = response.data.response.user\r\n\t\tdispatch(setAuthUserData(payload))\r\n\t}\r\n}","import { getAuthUserData } from \"./usersReducer\";\r\n\r\nconst INITIALIZED_SUCCESS = 'INITIALIZED_SUCCESS';\r\nconst TOKEN_USER_UUID_GOTTEN = 'TOKEN_USER_UUID_GOTTEN';\r\nconst ON_LINK_GOTTEN = 'ON_LINK_GOTTEN';\r\nconst GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT = 'GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT';\r\nconst GET_OUTPUT_PLAYER_SCREEN_FROM_SERVER = 'GET_OUTPUT_PLAYER_SCREEN_FROM_SERVER';\r\n\r\n\r\nlet initialState = {\r\n\tinitialized: false,\r\n\tlinkIsFetched: false,\r\n\tlinkForSS: '',\r\n\ttype: 1,\r\n\tonDialog: false,\r\n\toutputPlayerVoiceFromClient: null,\r\n\toutputPlayerScreemFromSS: null\r\n}\r\n\r\nexport const appReducer = (state = initialState, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase INITIALIZED_SUCCESS:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tinitialized: true\r\n\t\t\t};\r\n\t\tcase GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\toutputPlayerVoiceFromClient: action.voice\r\n\t\t\t}\r\n\t\tcase GET_OUTPUT_PLAYER_SCREEN_FROM_SERVER:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\toutputPlayerScreemFromSS: action.screen\r\n\t\t\t}\r\n\t\tcase ON_LINK_GOTTEN:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tlinkIsFetched: true,\r\n\t\t\t\tlinkForSS: action.link,\r\n\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state\r\n\t}\r\n}\r\n\r\n//AC\r\nexport const setInitializedSuccess = () => ({ type: INITIALIZED_SUCCESS });\r\nexport const setLinkForSS = (link) => ({ type: ON_LINK_GOTTEN, link })\r\n// export const toggleOnDialog = () => ({ type: ON_DIALOG })\r\n// export const setOutputPlayerVoiceFromClient = (voice) => ({ type: GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT, voice })\r\nexport const setOutputPlayerScreenFromSS = (screen) => ({ type: GET_OUTPUT_PLAYER_SCREEN_FROM_SERVER, screen })\r\n\r\n//thunk\r\nexport const initializeApp = () => async (dispatch) => {\r\n\tlet promise = dispatch(getAuthUserData());\r\n\r\n\tPromise.all([promise]).then(() => {\r\n\t\tdispatch(setInitializedSuccess());\r\n\t})\r\n\r\n}","import { BufferStream } from \"buffer-stream-js\";\r\nimport React, { useCallback, useContext, useEffect, useMemo, useState } from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport MenuIcon from \"@mui/icons-material/Menu\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport Backdrop from '@mui/material/Backdrop';\r\nimport Box from '@mui/material/Box';\r\nimport Modal from '@mui/material/Modal';\r\nimport Fade from '@mui/material/Fade';\r\n\r\nimport {\r\n\tToGetway_FromUnknown_AuthSocket,\r\n\tToMovement_ToPlayerScene_PlayerTick,\r\n\tFromMovement_FromPlayerScene_PlayerJoin,\r\n\tFromMovement_FromPlayerScene_PlayerLeave,\r\n\tFromMovement_FromPlayerScene_PlayerList,\r\n\tFromSound_FromPlayerScene_PlayerVoice\r\n} from \"../../socket/constants.js\";\r\nimport { WSSSContext } from \"../../../utils/Context\";\r\nimport { setUserLeft, setUserJoined, setUsersFromList } from '../../redux/usersReducer.js';\r\nimport { WSTransferTest } from './WSTransferTest.js';\r\nimport { setOutputPlayerScreenFromSS } from \"../../redux/appReducer.js\";\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\troot: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\tmenuButton: {\r\n\t\tmarginRight: theme.spacing(2)\r\n\t},\r\n\ttitle: {\r\n\t\tflexGrow: 1\r\n\t},\r\n}));\r\nconst style = {\r\n\tposition: 'absolute',\r\n\ttop: '6%',\r\n\tright: '10%',\r\n\twidth: 400,\r\n\tmaxHeight: '70vh',\r\n\tbgcolor: 'background.paper',\r\n\tboxShadow: 24,\r\n\tp: 4,\r\n\tborder: '1px solid grey',\r\n\toverflow: 'auto'\r\n};\r\n\r\nfunction isWSOpen(ws) {\r\n\treturn ws.readyState === 1\r\n}\r\n\r\nconst readPlayerFromPlayerList = (\r\n\tbuffer,\r\n\tstartOffset,\r\n\thasPosition = false\r\n) => {\r\n\tconst userUUIDLen = hasPosition === true ? 0 : 36;\r\n\r\n\tlet uuid = \"\";\r\n\tif (hasPosition === false) {\r\n\t\tbuffer.offset = startOffset;\r\n\t\tuuid = buffer.readUtf8String(userUUIDLen);\r\n\t}\r\n\tbuffer.offset = startOffset + userUUIDLen + 0;\r\n\tconst id = buffer.readUInt32LE();\r\n\r\n\tconst position = {\r\n\t\tx: 0,\r\n\t\ty: 0,\r\n\t\tz: 0,\r\n\t};\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 0;\r\n\tposition.x = buffer.readFloatLE();\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 4;\r\n\tposition.y = buffer.readFloatLE();\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 8;\r\n\tposition.z = buffer.readFloatLE();\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 12;\r\n\tconst state = buffer.readUInt8();\r\n\r\n\treturn {\r\n\t\tuuid: uuid,\r\n\t\tid: id,\r\n\t\tposition: position,\r\n\t\tstate: state\r\n\t};\r\n};\r\n\r\n// function Video(src, append) {\r\n// \tvar v = document.createElement(\"video\");\r\n// \tif (src != \"\") {\r\n// \t\tv.src = src;\r\n// \t}\r\n// \tif (append == true) {\r\n// \t\tdocument.body.appendChild(v);\r\n// \t}\r\n// \treturn v;\r\n// }\r\n\r\n// You can then use it like this:\r\n\r\n// var video = new Video(\"YOUR_VIDEO_URL\", true);\r\n// // do whatever you want...\r\n// video.height = 280;\r\n// video.width = 500;\r\n// video.controls = \"controls\";\r\n// video.play();\r\n\r\nlet outputPlayerVoice = blobForPlay => {\r\n\tconst outputBlob = new Blob([blobForPlay], {\r\n\t\ttype: \"audio/webm;codecs=opus\",\r\n\t});\r\n\tconst fileReader = new FileReader();\r\n\tfileReader.readAsDataURL(outputBlob);\r\n\tfileReader.onloadend = () => {\r\n\r\n\t\tconst base64String = fileReader.result;\r\n\r\n\t\tconst audio = new Audio(base64String);\r\n\t\taudio.addEventListener('canplay', () => {\r\n\t\t\taudio.play();\r\n\t\t})\r\n\t};\r\n}\r\n\r\nexport const NavBar = ({ getUsersFromStore, setScreenBlob, record, webSocket }) => {\r\n\tconst classes = useStyles();\r\n\r\n\tconst [openModal, setOpenModal] = useState(false);\r\n\tconst handleOpen = () => setOpenModal(true);\r\n\tconst handleClose = () => setOpenModal(false);\r\n\r\n\tconst [connected, setConnected] = useState(false);\r\n\r\n\tconst dispatch = useDispatch();\r\n\r\n\tconst { linkForSS, sessionTokenForSS, userUUID, getConnectionType, lobbyUUID } = useContext(WSSSContext)\r\n\r\n\tlet webSocketSS = null;\r\n\r\n\t//get self uuid\r\n\r\n\tconst [users, setUsers] = useState([])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (linkForSS && webSocket) start();\r\n\r\n\t\tfunction start() {\r\n\r\n\t\t\tconst linkSS = linkForSS ? linkForSS : console.log('Fetching the link...');\r\n\r\n\t\t\twebSocketSS = new WebSocket(linkSS);\r\n\t\t\tif (webSocket) {\r\n\t\t\t\twebSocket.current = webSocketSS;\r\n\t\t\t}\r\n\t\t\twindow.webSocketSS = webSocketSS;\r\n\t\t\twebSocketSS.binaryType = \"arraybuffer\";\r\n\r\n\t\t\twebSocketSS.onopen = () => {\r\n\t\t\t\tconst array = new Uint8Array(4 + 36 + 1 + 36)\r\n\r\n\t\t\t\tconst methodBuffer = new Uint8Array(new Uint32Array([ToGetway_FromUnknown_AuthSocket]).buffer)\r\n\t\t\t\tconst sessionBuffer = new TextEncoder().encode(sessionTokenForSS)\r\n\t\t\t\tconst locationUUIDBuffer = new TextEncoder().encode(lobbyUUID) // 36 LEN частное лобби или общее\r\n\t\t\t\tarray.set(methodBuffer, 0)\r\n\t\t\t\tarray.set(sessionBuffer, 4)\r\n\t\t\t\tarray.set(new Uint8Array([getConnectionType]), 4 + 36)\r\n\t\t\t\tarray.set(locationUUIDBuffer, 4 + 36 + 1)\r\n\r\n\t\t\t\twebSocketSS.send(array);\r\n\r\n\t\t\t\tif (webSocketSS.readyState === 1) {\r\n\t\t\t\t\tsetConnected(true)\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\r\n\t\t\twebSocketSS.onmessage = buffer => {\r\n\r\n\t\t\t\tconst message = new BufferStream(buffer.data);\r\n\t\t\t\tmessage.offset = 0;\r\n\t\t\t\tconst method = message.readInt32LE();\r\n\t\t\t\tswitch (method) {\r\n\t\t\t\t\tcase FromMovement_FromPlayerScene_PlayerList:\r\n\t\t\t\t\t\tmessage.offset = 4;\r\n\t\t\t\t\t\tconst countPlayers = message.readUInt32LE();\r\n\r\n\t\t\t\t\t\tconst users = [];\r\n\t\t\t\t\t\tfor (let index = 0; index < countPlayers; index++) {\r\n\t\t\t\t\t\t\tconst user = readPlayerFromPlayerList(\r\n\t\t\t\t\t\t\t\tmessage,\r\n\t\t\t\t\t\t\t\t4 /* Method */ +\r\n\t\t\t\t\t\t\t\t4 /* Count */ +\r\n\t\t\t\t\t\t\t\tindex *\r\n\t\t\t\t\t\t\t\t(36 /* UUID */ +\r\n\t\t\t\t\t\t\t\t\t4 /* ID */ +\r\n\t\t\t\t\t\t\t\t\t(4 + 4 + 4) /* Position */ +\r\n\t\t\t\t\t\t\t\t\t1) /* Flags */\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tif (user.uuid === userUUID) {\r\n\t\t\t\t\t\t\t\tconsole.log('the uuid is the same');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tusers.push(user);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdispatch(setUsersFromList(users))\r\n\r\n\t\t\t\t\t\tconsole.log(JSON.stringify(users));\r\n\r\n\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\"Method: FromMovement_FromPlayerScene_PlayerList, count: \" +\r\n\t\t\t\t\t\t\tcountPlayers,\r\n\t\t\t\t\t\t\tusers\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase FromMovement_FromPlayerScene_PlayerJoin:\r\n\t\t\t\t\t\tconst user = readPlayerFromPlayerList(message, 4);\r\n\t\t\t\t\t\tconsole.log(\"User Join: \" + user.uuid);\r\n\t\t\t\t\t\tdispatch(setUserJoined(user))\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase FromMovement_FromPlayerScene_PlayerLeave:\r\n\t\t\t\t\t\tmessage.offset = 4;\r\n\t\t\t\t\t\tconst uuid = message.readUtf8String(36);\r\n\t\t\t\t\t\tconsole.log(\"User Leave: \" + uuid);\r\n\t\t\t\t\t\tdispatch(setUserLeft(uuid))\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase FromSound_FromPlayerScene_PlayerVoice:\r\n\t\t\t\t\t\tconst user_from_voice = readPlayerFromPlayerList(message, 4, true);\r\n\t\t\t\t\t\t// Parse Voice Body\r\n\t\t\t\t\t\tconst voiceBody = new Uint8Array(message.buffer.buffer, 21);\r\n\t\t\t\t\t\t// Play Voice Body\r\n\t\t\t\t\t\toutputPlayerVoice(voiceBody);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.log(\"Method: Unknown\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(\"WebSocket message received:\", method);\r\n\r\n\t\t\t};\r\n\r\n\t\t\twebSocketSS.onclose = (e) => {\r\n\t\t\t\tconsole.log('Sound Server Socket closed. Trying to reconnect...');\r\n\t\t\t\tconsole.log('Server closed with code => ', e.code);\r\n\r\n\t\t\t\tif (webSocketSS.readyState !== 1) {\r\n\t\t\t\t\tsetConnected(false)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (e.code !== 1005) {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tstart()\r\n\t\t\t\t\t}, 1000);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('Socket was closed by user');\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t\twebSocketSS.onerror = (err) => {\r\n\t\t\t\tconsole.log('This error happened => ', err);\r\n\t\t\t\twebSocketSS.close()\r\n\t\t\t}\r\n\r\n\t\t\tlet sendPlayerTick = (\r\n\t\t\t\tposition,\r\n\t\t\t\tstate,\r\n\t\t\t\tvoiceBody\r\n\t\t\t) => {\r\n\r\n\t\t\t\tconst array = new Uint8Array(4 + 12 + 1 + voiceBody.byteLength);\r\n\r\n\t\t\t\tconst methodBuffer = new Uint8Array(new Uint32Array([ToMovement_ToPlayerScene_PlayerTick]).buffer\r\n\t\t\t\t);\r\n\r\n\t\t\t\tarray.set(methodBuffer, 0); // before 0, after 4\r\n\r\n\t\t\t\tarray.set(new Uint8Array(new Float32Array([position.x]).buffer), 4); // before 4, after 8\r\n\t\t\t\tarray.set(new Uint8Array(new Float32Array([position.y]).buffer), 4 + 4); // before 8, after 12\r\n\t\t\t\tarray.set(new Uint8Array(new Float32Array([position.z]).buffer), 4 + 8); // before 12, after 16\r\n\r\n\t\t\t\tarray.set(new Uint8Array([state]), 4 + 12); // before 16, after 17\r\n\r\n\t\t\t\tarray.set(voiceBody, 4 + 12 + 1); // before 17, after 4\r\n\r\n\t\t\t\tif (!isWSOpen(webSocketSS)) return\r\n\t\t\t\twebSocketSS.send(array)\r\n\t\t\t};\r\n\r\n\t\t\twindow.sendPlayerTick = audioChunk => sendPlayerTick({ x: 0, y: 0, z: 0 }, 0, audioChunk)\r\n\t\t}\r\n\r\n\r\n\t}, [linkForSS, webSocket]);\r\n\r\n\tuseMemo(() => {\r\n\t\tfunction pinging() {\r\n\t\t\tconst interval = setTimeout(() => {\r\n\t\t\t\tif (!record) {\r\n\t\t\t\t\twindow.sendPlayerTick(new Uint8Array());\r\n\t\t\t\t\tpinging();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tclearTimeout(interval);\r\n\t\t\t\t}\r\n\t\t\t}, 4000)\r\n\t\t}\r\n\r\n\t\tif (connected) {\r\n\t\t\tpinging();\r\n\t\t}\r\n\t}, [record, connected])\r\n\r\n\tuseMemo(() => {\r\n\t\tsetUsers(getUsersFromStore)\r\n\t\tconsole.log(users);\r\n\t}, [getUsersFromStore, users])\r\n\r\n\treturn (\r\n\t\t<div className={classes.root}>\r\n\t\t\t<AppBar position=\"static\">\r\n\t\t\t\t<Toolbar>\r\n\t\t\t\t\t{/* <IconButton\r\n\t\t\t\t\t\tedge=\"start\"\r\n\t\t\t\t\t\tclassName={classes.menuButton}\r\n\t\t\t\t\t\tcolor=\"inherit\"\r\n\t\t\t\t\t\taria-label=\"menu\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<MenuIcon />\r\n\t\t\t\t\t</IconButton> */}\r\n\t\t\t\t\t{/* {webSocket && <WSTransferTest webSocket={webSocket} />} */}\r\n\t\t\t\t\t<Typography variant=\"h6\" className={classes.title}>\r\n\t\t\t\t\t\tConnection Status:\r\n\t\t\t\t\t\t{connected ? ' Connected!' : ' Disconnected!'}\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<Button color=\"inherit\" onClick={handleOpen}>Users List</Button>\r\n\t\t\t\t\t<Modal\r\n\t\t\t\t\t\taria-labelledby=\"transition-modal-title\"\r\n\t\t\t\t\t\taria-describedby=\"transition-modal-description\"\r\n\t\t\t\t\t\topen={openModal}\r\n\t\t\t\t\t\tonClose={handleClose}\r\n\t\t\t\t\t\tcloseAfterTransition\r\n\t\t\t\t\t\tBackdropComponent={Backdrop}\r\n\t\t\t\t\t\tBackdropProps={{\r\n\t\t\t\t\t\t\ttimeout: 500,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Fade in={openModal}>\r\n\t\t\t\t\t\t\t<Box sx={style}>\r\n\t\t\t\t\t\t\t\t<Typography id=\"transition-modal-title\" variant=\"h6\" component=\"h2\">\r\n\t\t\t\t\t\t\t\t\tUsers connected:\r\n\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tgetUsersFromStore.length !== 0 ? getUsersFromStore.map(u => {\r\n\t\t\t\t\t\t\t\t\t\treturn userUUID === u.uuid ?\r\n\t\t\t\t\t\t\t\t\t\t\t<Typography id=\"transition-modal-description\" sx={{ mt: 2 }} key={u.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\tSelf: <span style={{ color: 'red' }}>{u.uuid}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\t\t<Typography id=\"transition-modal-description\" sx={{ mt: 2 }} key={u.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\tUser's UUID: <span style={{ color: 'blue' }}>{u.uuid}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\t(<Typography id=\"transition-modal-description\" sx={{ mt: 2 }}>\r\n\t\t\t\t\t\t\t\t\t\t\tWaiting for users\r\n\t\t\t\t\t\t\t\t\t\t</Typography>)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t\t</Fade>\r\n\t\t\t\t\t</Modal>\r\n\t\t\t\t</Toolbar>\r\n\t\t\t</AppBar>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import React, { useState, useRef, useEffect, useMemo, useCallback } from \"react\";\r\n\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport MicIcon from \"@mui/icons-material/Mic\";\r\nimport MicOffIcon from '@mui/icons-material/MicOff';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport VideocamIcon from '@mui/icons-material/Videocam';\r\nimport VideocamOffIcon from '@mui/icons-material/VideocamOff';\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\nimport \"./microphone.css\";\r\n// import { setOutputPlayerVoiceFromClient, toggleOnDialog } from \"../../redux/appReducer\";\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\ticon: {\r\n\t\theight: 38,\r\n\t\twidth: 38\r\n\t},\r\n\treactmic: {\r\n\t\twidth: \"80%\",\r\n\t\theight: 30\r\n\t},\r\n\tflex: {\r\n\t\tflex: 1\r\n\t}\r\n}));\r\n\r\nexport default function Microphone({ size, isAudio, setIsAudio, isVideo, setIsVideo }) {\r\n\r\n\r\n\tconst startAudio = () => {\r\n\t\tsetIsAudio(true)\r\n\t};\r\n\r\n\tconst stopAudio = () => {\r\n\t\tsetIsAudio(false);\r\n\t}\r\n\tconst startVideo = () => {\r\n\t\tsetIsVideo(true)\r\n\t};\r\n\r\n\tconst stopVideo = () => {\r\n\t\tsetIsVideo(false);\r\n\t}\r\n\r\n\tconst classes = useStyles();\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Grid container justifyContent=\"center\">\r\n\t\t\t\t<Grid item>\r\n\r\n\t\t\t\t\t{!isVideo ?\r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t<IconButton onClick={startVideo}>\r\n\t\t\t\t\t\t\t\t<VideocamIcon className={classes.icon} style={{ width: size, height: size }} />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t<IconButton onClick={stopVideo}>\r\n\t\t\t\t\t\t\t<VideocamOffIcon className={classes.icon} style={{ width: size, height: size }} />\r\n\t\t\t\t\t\t</IconButton>}\r\n\t\t\t\t\t{!isAudio ?\r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t<IconButton onClick={startAudio}>\r\n\t\t\t\t\t\t\t\t<MicIcon className={classes.icon} style={{ width: size, height: size }} />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t<IconButton onClick={stopAudio}>\r\n\t\t\t\t\t\t\t<MicOffIcon className={classes.icon} style={{ width: size, height: size }} />\r\n\t\t\t\t\t\t</IconButton>}\r\n\r\n\r\n\t\t\t\t</Grid>\r\n\t\t\t</Grid>\r\n\t\t</>\r\n\t);\r\n}\r\n","import { createStore, combineReducers, applyMiddleware, compose } from 'redux'\r\nimport thunkMiddleware from 'redux-thunk'\r\n\r\nimport { appReducer } from './appReducer';\r\nimport { usersReducer } from './usersReducer';\r\n\r\n\r\nlet reducers = combineReducers(\r\n\t{\r\n\t\tapp: appReducer,\r\n\t\tusers: usersReducer\r\n\t}\r\n)\r\n\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\nconst store = createStore(reducers, composeEnhancers(applyMiddleware(thunkMiddleware)));\r\n\r\nwindow.__store__ = store;\r\n\r\nexport default store;\r\n","export default __webpack_public_path__ + \"static/media/preloader.e40a641e.gif\";","import React from 'react'\r\nimport preloader from '../../../assets/src/preloader/preloader.gif'\r\n\r\n\r\nexport const Preloader = () => {\r\n\r\n\r\n\treturn (\r\n\t\t<div className=\"lds-facebook\">\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t</div>\r\n\t)\r\n}","export const getVideoAudioStream = () => {\r\n\tconst myNavigator = navigator.mediaDevices.getUserMedia ||\r\n\t\tnavigator.mediaDevices.webkitGetUserMedia ||\r\n\t\tnavigator.mediaDevices.mozGetUserMedia ||\r\n\t\tnavigator.mediaDevices.msGetUserMedia;\r\n\treturn myNavigator({\r\n\t\tvideo: {\r\n\t\t\tnoiseSuppression: true,\r\n\t\t\twidth: { min: 640, ideal: 1280, max: 1920 },\r\n\t\t\theight: { min: 480, ideal: 720, max: 1080 }\r\n\t\t},\r\n\t\taudio: {\r\n\t\t\techoCancellation: true,\r\n\t\t\tnoiseSuppression: true\r\n\t\t}\r\n\t});\r\n}","export const createVideo = (myId, videoContainer, createObj, videoDestination, whoseVideo) => {\r\n\tif (!videoContainer[createObj.id]) {\r\n\t\tvideoContainer[createObj.id] = { ...createObj };\r\n\r\n\t\tconst roomContainer = videoDestination;\r\n\t\tconst video = document.createElement('video');\r\n\r\n\t\t//0 for my video, 1 for incoming video\r\n\t\tif (whoseVideo === 0) {\r\n\t\t\tvideo.classList.add('internalVideo');\r\n\t\t}\r\n\t\tif (whoseVideo === 1) {\r\n\t\t\tvideo.classList.add('externalVideo');\r\n\t\t}\r\n\r\n\t\tvideo.srcObject = videoContainer[createObj.id].stream;\r\n\t\tvideo.id = createObj.id;\r\n\t\tvideo.autoplay = true;\r\n\t\tif (myId === createObj.id) video.muted = true;\r\n\t\troomContainer.append(video);\r\n\t} else {\r\n\t\treturn\r\n\t}\r\n}","export function timeFormatHelper(value) {\r\n\tif (value < 10) {\r\n\t\treturn '0' + value;\r\n\t} else {\r\n\t\treturn value;\r\n\t}\r\n}","import React, { useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react'\r\nimport Box from '@mui/material/Box';\r\nimport Drawer from '@mui/material/Drawer';\r\nimport CssBaseline from '@mui/material/CssBaseline';\r\nimport List from '@mui/material/List';\r\nimport Divider from '@mui/material/Divider';\r\nimport ListItem from '@mui/material/ListItem';\r\nimport ListItemIcon from '@mui/material/ListItemIcon';\r\nimport ListItemText from '@mui/material/ListItemText';\r\nimport Collapse from '@mui/material/Collapse';\r\nimport ListItemButton from '@mui/material/ListItemButton';\r\nimport ExpandLess from '@mui/icons-material/ExpandLess';\r\nimport ExpandMore from '@mui/icons-material/ExpandMore';\r\nimport Button from '@mui/material/Button';\r\n\r\nimport InboxIcon from '@mui/icons-material/MoveToInbox';\r\nimport Microphone from '../microphone/Microphone';\r\nimport { Grid, Typography } from '@material-ui/core';\r\nimport VoiceChatIcon from '@mui/icons-material/VoiceChat';\r\nimport { routesTechPractices, routesStands } from './../../../utils/routes'\r\nimport './chatBar.css'\r\nimport { Switch, Route, NavLink } from 'react-router-dom'\r\nimport { ChatRoom1 } from './rooms/СhatRoom1';\r\nimport { СhatRoom2 } from './rooms/СhatRoom2';\r\nimport { СhatRoom3 } from './rooms/СhatRoom3';\r\nimport { СhatRoom4 } from './rooms/СhatRoom4';\r\nimport { useSelector } from 'react-redux';\r\nimport { Preloader } from '../preloader/Preloader';\r\nimport { WSSSContext } from '../../../utils/Context';\r\nimport { useDispatch } from 'react-redux';\r\nimport { setOutputPlayerScreenFromSS } from '../../redux/appReducer';\r\nimport { initializePeerConnection } from '../peer/Peer';\r\nimport { getVideoAudioStream } from '../../../utils/audioVideoContent/AudioVideoInitiator';\r\nimport { createVideo } from '../../../utils/audioVideoContent/VideoCreator';\r\nimport { getScreen } from '../../../utils/audioVideoContent/ScreenShareInitiator';\r\n\r\n\r\n//удалить? для чата\r\nimport AppBar from '@mui/material/AppBar';\r\nimport Toolbar from '@mui/material/Toolbar';\r\nimport TextField from '@mui/material/TextField';\r\nimport SendIcon from '@mui/icons-material/Send';\r\nimport { timeFormatHelper } from '../../../utils/TimeFormatter'\r\n\r\nconst drawerWidth = 360;\r\nconst roomsTechPracticeNames = ['Техпрактика 1', 'Техпрактика 2', 'Техпрактика 3', 'Техпрактика 4 (Don\\'t)', 'Техпрактика 5', 'Техпрактика 6']\r\n\r\n\r\nexport const ChatBar = ({ getUsersFromStore, isAudio, setIsAudio, isVideo, setIsVideo }) => {\r\n\tconst dispatch = useDispatch();\r\n\tconst { userUUID } = useContext(WSSSContext)\r\n\tconst videoData = {};\r\n\r\n\tconst [peer, setPeer] = useState(null);\r\n\tconst [connId, setConnId] = useState([]);\r\n\tconst [outcomeStream, setOutcomeStream] = useState([]);\r\n\tconst [incomeStream, setIncomeStream] = useState([]);\r\n\tconst [myVideoAdded, setMyVideoAdded] = useState(false);\r\n\tconst [callType, setCallType] = useState('media');\r\n\tconst [currentPeer, setCurrentPeer] = useState(null);\r\n\tconst [peerList, setPeerList] = useState([]);\r\n\r\n\t//refs\r\n\tconst videoContainer = useRef();\r\n\r\n\r\n\t//for chat\r\n\tconst [connection, setConnection] = useState(null);\r\n\tconst [messages, setMessages] = useState([])\r\n\tconst messageBox = useRef()\r\n\r\n\r\n\tconst handleSendMessage = (e) => {\r\n\t\te.preventDefault();\r\n\t\tif (connection) {\r\n\t\t\t//зарефакторить?\r\n\t\t\tsetMessages(messages => ([...messages, {\r\n\t\t\t\tme: true,\r\n\t\t\t\tcurrentMinutes: timeFormatHelper(new Date().getMinutes()),\r\n\t\t\t\tcurrentHour: timeFormatHelper(new Date().getHours()),\r\n\t\t\t\tmessage: messageBox.current.value\r\n\t\t\t}]));\r\n\r\n\t\t\tif (messageBox.current.value) {\r\n\t\t\t\tconnection.send(messageBox.current.value);\r\n\t\t\t\tmessageBox.current.value = '';\r\n\t\t\t} else {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction connectPeers() {\r\n\t\tlet conn = peer.connect(remotePeerId);\r\n\t\tconn.on('open', () => {\r\n\t\t\tconn.send('hi')\r\n\t\t})\r\n\t\tconn.on('data', (data) => {\r\n\t\t\tconsole.log(data);\r\n\t\t})\r\n\t\tconsole.log(conn);\r\n\t}\r\n\t//рефакторить? 2 раза почти одинаковая функция\r\n\r\n\t//0 for my video, 1 for incoming video\r\n\tconst startCapture = () => {\r\n\t\tsetCallType('screen');\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (callType === 'screen') {\r\n\t\t\tgetScreen().then((stream) => {\r\n\t\t\t\tif (stream) {\r\n\t\t\t\t\tconst videoTrack = stream.getVideoTracks()[0];\r\n\t\t\t\t\tvideoTrack.onended = () => {\r\n\t\t\t\t\t\tstopCapture();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tconst sender = currentPeer.getSenders().find(s => s.track.kind === videoTrack.kind);\r\n\t\t\t\t\tsender.replaceTrack(videoTrack);\r\n\t\t\t\t}\r\n\t\t\t}).catch(err => {\r\n\t\t\t\tconsole.log('Unable to get display media ' + err);\r\n\t\t\t})\r\n\r\n\t\t}\r\n\t}, [callType])\r\n\r\n\tconst stopCapture = () => {\r\n\r\n\t\tconst videoTrack = incomeStream !== [] ? incomeStream[0].getVideoTracks()[0] : outcomeStream[0].getVideoTracks()[0];\r\n\t\tconst sender = currentPeer.getSenders().find(s => s.track.kind === videoTrack.kind);\r\n\t\tsender.replaceTrack(videoTrack);\r\n\t\tsetCallType('media');\r\n\r\n\t}\r\n\r\n\tfunction call(remotePeerId) {\r\n\r\n\t\t// connectPeers();\r\n\r\n\t\tsetConnection(peer.connect(remotePeerId));\r\n\r\n\t\tgetVideoAudioStream().then((stream) => {\r\n\t\t\tif (stream) {\r\n\t\t\t\tsetIncomeStream([...incomeStream, stream]);\r\n\t\t\t\t// if (myVideoAdded === false) {\r\n\t\t\t\tcreateVideo(userUUID, videoData, { id: userUUID, stream: stream }, videoContainer.current, 0);\r\n\t\t\t\tsetMyVideoAdded(true);\r\n\t\t\t\t// }\r\n\t\t\t\tlet call = peer.call(remotePeerId, stream);\r\n\t\t\t\tcall.on('stream', (remoteStream) => {\r\n\t\t\t\t\tif (!peerList.includes(call.peer)) {\r\n\t\t\t\t\t\tcreateVideo(userUUID, videoData, { id: call.peer, stream: remoteStream }, videoContainer.current, 1);\r\n\t\t\t\t\t\tsetCurrentPeer(call.peerConnection);\r\n\t\t\t\t\t\tsetPeerList([...peerList, call.peer]);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t//test\r\n\tlet [remotePeerId, setRemotePeerId] = useState('');\r\n\t//test\r\n\r\n\tuseEffect(() => {\r\n\t\tif (userUUID) {\r\n\t\t\tsetPeer(initializePeerConnection(userUUID));\r\n\t\t}\r\n\t}, [userUUID])\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tif (peer) {\r\n\t\t\tpeer.on('open', function (id) {\r\n\t\t\t\tconsole.log('My peer ID is: ' + id);\r\n\t\t\t});\r\n\r\n\t\t\tpeer.on('connection', function (connection) {\r\n\t\t\t\t//для одного\r\n\t\t\t\tsetConnection(connection);\r\n\r\n\r\n\t\t\t\t// setConnId([...connId, connection.peer]);\r\n\t\t\t\t// let data = peerList.filter(peer => peer !== connection.peer)\r\n\t\t\t\t// connection.send()\r\n\r\n\t\t\t\t// connection.on('data', function (data) {\r\n\t\t\t\t// \tconnection.send(userUUID)\r\n\t\t\t\t// \tconsole.log(data);\r\n\t\t\t\t// })\r\n\t\t\t});\r\n\r\n\t\t\tpeer.on('call', (call) => {\r\n\t\t\t\tif (callType === 'media') {\r\n\t\t\t\t\tgetVideoAudioStream().then((stream) => {\r\n\t\t\t\t\t\tif (stream) {\r\n\t\t\t\t\t\t\t// setOutcomeStream([...outcomeStream, stream]);\r\n\t\t\t\t\t\t\tsetIncomeStream([...incomeStream, stream]);\r\n\r\n\t\t\t\t\t\t\t// if (myVideoAdded === false) {\r\n\t\t\t\t\t\t\t//0 for my video, 1 for incoming video\r\n\t\t\t\t\t\t\tcreateVideo(userUUID, videoData, { id: userUUID, stream: stream }, videoContainer.current, 0);\r\n\t\t\t\t\t\t\tsetMyVideoAdded(true);\r\n\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t\tcall.answer(stream);\r\n\t\t\t\t\t\t\tcall.on('stream', (remoteStream) => {\r\n\t\t\t\t\t\t\t\tif (!peerList.includes(call.peer)) {\r\n\t\t\t\t\t\t\t\t\tcreateVideo(userUUID, videoData, { id: call.peer, stream: remoteStream }, videoContainer.current, 1);\r\n\t\t\t\t\t\t\t\t\tsetCurrentPeer(call.peerConnection);\r\n\t\t\t\t\t\t\t\t\tsetPeerList([...peerList, call.peer]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tpeer.on('error', err => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t})\r\n\r\n\t\t}\r\n\r\n\t}, [peer])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (connection) {\r\n\t\t\tconnection.on('data', (mess) => {\r\n\t\t\t\tsetMessages(messages => ([...messages, {\r\n\t\t\t\t\tme: false,\r\n\t\t\t\t\tcurrentMinutes: timeFormatHelper(new Date().getMinutes()),\r\n\t\t\t\t\tcurrentHour: timeFormatHelper(new Date().getHours()),\r\n\t\t\t\t\tmessage: mess\r\n\t\t\t\t}]))\r\n\t\t\t})\r\n\t\t}\r\n\t}, [connection])\r\n\r\n\t//Control of outcoming sound and video tracks. Mute by default\r\n\tuseEffect(() => {\r\n\t\tif (!outcomeStream) return;\r\n\r\n\t\toutcomeStream.forEach(stream => stream.getAudioTracks().forEach(track => {\r\n\t\t\ttrack.enabled = isAudio;\r\n\t\t}))\r\n\t\toutcomeStream.forEach(stream => stream.getVideoTracks().forEach(track => {\r\n\t\t\ttrack.enabled = isVideo;\r\n\t\t}))\r\n\r\n\t}, [outcomeStream, isAudio, isVideo]);\r\n\r\n\r\n\t//Control of incoming sound and video tracks. Mute by default\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!incomeStream) return;\r\n\r\n\t\tincomeStream.forEach(stream => stream.getAudioTracks().forEach(track => {\r\n\t\t\ttrack.enabled = isAudio;\r\n\t\t}))\r\n\t\tincomeStream.forEach(stream => stream.getVideoTracks().forEach(track => {\r\n\t\t\ttrack.enabled = isVideo;\r\n\t\t}))\r\n\t\tconsole.log(peerList, currentPeer);\r\n\r\n\t}, [incomeStream, isAudio, isVideo]);\r\n\r\n\r\n\treturn (\r\n\t\t<Grid >\r\n\t\t\t<Box sx={{ display: 'flex' }}>\r\n\r\n\t\t\t\t<AppBar position=\"fixed\" sx={{\r\n\t\t\t\t\tzIndex: (theme) => theme.zIndex.drawer + 1, width: drawerWidth, left: 0\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<Toolbar sx={{ justifyContent: 'center' }}>\r\n\t\t\t\t\t\t<Typography variant=\"h6\" noWrap component=\"div\" >\r\n\t\t\t\t\t\t\tЧат\r\n\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t</Toolbar>\r\n\t\t\t\t</AppBar>\r\n\r\n\t\t\t\t<Drawer\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\t\tflexShrink: 0,\r\n\t\t\t\t\t\t'& .MuiDrawer-paper': {\r\n\t\t\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\t\t\tboxSizing: 'border-box',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tvariant=\"permanent\"\r\n\t\t\t\t\tanchor=\"left\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Divider />\r\n\t\t\t\t\t<List\r\n\t\t\t\t\t\tid='chat-list'\r\n\t\t\t\t\t\tsx={{ marginTop: '4em', overflowY: 'scroll', maxHeight: '75%' }} >\r\n\t\t\t\t\t\t{messages.map((dataObj, index) => (\r\n\t\t\t\t\t\t\t<ListItem key={index}>\r\n\t\t\t\t\t\t\t\t{dataObj.me ?\r\n\t\t\t\t\t\t\t\t\t(<ListItemText><span style={{ color: '#5271e3', fontWeight: 'bold' }}>Я</span> в {dataObj.currentHour}:{dataObj.currentMinutes} :\r\n\t\t\t\t\t\t\t\t\t\t<Typography > {dataObj.message}</Typography>\r\n\t\t\t\t\t\t\t\t\t</ListItemText>)\r\n\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t(<ListItemText><span style={{ color: '#ba32b3', fontWeight: 'bold' }}>На том конце провода</span> в {dataObj.currentHour}:{dataObj.currentMinutes} :\r\n\t\t\t\t\t\t\t\t\t\t<Typography > {dataObj.message}</Typography>\r\n\t\t\t\t\t\t\t\t\t</ListItemText>)\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</List>\r\n\t\t\t\t\t<Box\r\n\t\t\t\t\t\tcomponent=\"form\"\r\n\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\t'& .MuiTextField-root': { m: 1, width: '25ch' },\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tnoValidate\r\n\t\t\t\t\t\tautoComplete=\"off\"\r\n\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\tposition: 'fixed',\r\n\t\t\t\t\t\t\tbottom: '.5%',\r\n\t\t\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\tid=\"outlined-multiline-flexible\"\r\n\t\t\t\t\t\t\tlabel=\"Ваше сообщение\"\r\n\t\t\t\t\t\t\tmultiline\r\n\t\t\t\t\t\t\trows={3}\r\n\t\t\t\t\t\t\tinputProps={{\r\n\t\t\t\t\t\t\t\tstyle: { paddingRight: '10%' },\r\n\t\t\t\t\t\t\t\tref: messageBox\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\t\twidth: '100%'\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\ttype='submit'\r\n\t\t\t\t\t\t\tonClick={handleSendMessage}\r\n\t\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\t\tposition: 'absolute',\r\n\t\t\t\t\t\t\t\tbottom: '25%',\r\n\t\t\t\t\t\t\t\tright: 0\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<SendIcon />\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Box>\r\n\t\t\t\t</Drawer>\r\n\t\t\t\t{/* <Drawer\r\n\t\t\t\t\tvariant=\"permanent\"\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\twidth: drawerWidth,\r\n\t\t\t\t\t\tflexShrink: 0,\r\n\t\t\t\t\t\t[`& .MuiDrawer-paper`]: { marginTop: '5em', width: drawerWidth, boxSizing: 'border-box' },\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Box sx={{ overflow: 'auto' }}>\r\n\t\t\t\t\t\t<List>\r\n\t\t\t\t\t\t\t<ListItemButton onClick={handleClick}>\r\n\t\t\t\t\t\t\t\t<ListItemIcon>\r\n\t\t\t\t\t\t\t\t\t<InboxIcon />\r\n\t\t\t\t\t\t\t\t</ListItemIcon>\r\n\t\t\t\t\t\t\t\t<ListItemText primary=\"Техпрактики\" />\r\n\t\t\t\t\t\t\t\t{open ? <ExpandLess /> : <ExpandMore />}\r\n\t\t\t\t\t\t\t</ListItemButton>\r\n\t\t\t\t\t\t\t<Collapse in={open} timeout=\"auto\" unmountOnExit>\r\n\t\t\t\t\t\t\t\t{roomsTechPracticeNames.map((text, index = 0) => (\r\n\t\t\t\t\t\t\t\t\t<NavLink\r\n\t\t\t\t\t\t\t\t\t\tto={routesTechPractices[index]}\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ textDecoration: 'none', color: 'inherit', display: 'block' }}\r\n\t\t\t\t\t\t\t\t\t\tactiveClassName='activeLink'\r\n\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\texact>\r\n\t\t\t\t\t\t\t\t\t\t<ListItem button sx={{ pl: 4 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t<ListItemIcon>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VoiceChatIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t</ListItemIcon>\r\n\t\t\t\t\t\t\t\t\t\t\t<ListItemText primary={text} />\r\n\t\t\t\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</Collapse>\r\n\r\n\t\t\t\t\t\t\t<Divider />\r\n\t\t\t\t\t\t\t<ListItemButton onClick={handleClickSt}>\r\n\t\t\t\t\t\t\t\t<ListItemIcon>\r\n\t\t\t\t\t\t\t\t\t<InboxIcon />\r\n\t\t\t\t\t\t\t\t</ListItemIcon>\r\n\t\t\t\t\t\t\t\t<ListItemText primary=\"Стенды\" />\r\n\t\t\t\t\t\t\t\t{openSt ? <ExpandLess /> : <ExpandMore />}\r\n\t\t\t\t\t\t\t</ListItemButton>\r\n\t\t\t\t\t\t\t<Collapse in={openSt} timeout=\"auto\" unmountOnExit>\r\n\t\t\t\t\t\t\t\t{routesStands.map((text, index = 0) => (\r\n\t\t\t\t\t\t\t\t\t<NavLink\r\n\t\t\t\t\t\t\t\t\t\tto={routesStands[index]}\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ textDecoration: 'none', color: 'inherit', display: 'block' }}\r\n\t\t\t\t\t\t\t\t\t\tactiveClassName='activeLink'\r\n\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\texact>\r\n\t\t\t\t\t\t\t\t\t\t<ListItem button sx={{ pl: 4 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t<ListItemIcon>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VoiceChatIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t</ListItemIcon>\r\n\t\t\t\t\t\t\t\t\t\t\t<ListItemText primary={text} />\r\n\t\t\t\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</Collapse>\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t\t<Divider />\r\n\t\t\t\t\t</Box>\r\n\t\t\t\t\t<Microphone\r\n\t\t\t\t\t\tsize={'1.5em'}\r\n\t\t\t\t\t\tisAudio={isAudio}\r\n\t\t\t\t\t\tsetIsAudio={setIsAudio}\r\n\t\t\t\t\t\tisVideo={isVideo}\r\n\t\t\t\t\t\tsetIsVideo={setIsVideo}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Drawer> */}\r\n\t\t\t\t<Box sx={{ width: 'calc(100% - 240px)', display: 'flex', flexDirection: 'column' }}>\r\n\t\t\t\t\t<Box sx={{ width: '100%', m: '1em auto', bgcolor: 'background.paper', display: 'flex', flexDirection: 'row' }}>\r\n\t\t\t\t\t\t<Box component=\"main\" sx={{ flexGrow: 1, p: 1 }}>\r\n\t\t\t\t\t\t\t<Microphone\r\n\t\t\t\t\t\t\t\tsize={'2em'}\r\n\t\t\t\t\t\t\t\tisAudio={isAudio}\r\n\t\t\t\t\t\t\t\tsetIsAudio={setIsAudio}\r\n\t\t\t\t\t\t\t\tisVideo={isVideo}\r\n\t\t\t\t\t\t\t\tsetIsVideo={setIsVideo}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t\t\t{/* <Route exact path='/'> <Typography paragraph>Выберите комнату для чата слева</Typography></Route>\r\n\t\t\t\t\t\t<Route exact path='/room1' component={ChatRoom1} />\r\n\t\t\t\t\t\t<Route exact path='/room2' component={СhatRoom2} />\r\n\t\t\t\t\t\t<Route exact path='/room3' component={СhatRoom3} />\r\n\t\t\t\t\t\t<Route exact path='/room4' component={СhatRoom4} />\r\n\t\t\t\t\t\t<Route path='*' render={() => <div>There is no such chat room!</div>} /> */}\r\n\t\t\t\t\t\t\t</Switch>\r\n\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t\t<Box\r\n\t\t\t\t\t\t\tsx={{ marginTop: '2em', width: '100%', height: 200, maxWidth: 360, bgcolor: 'background.paper' }\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<List>\r\n\t\t\t\t\t\t\t\t<ListItemText primary={'Список пользователей'} />\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tgetUsersFromStore.length !== 0 ?\r\n\t\t\t\t\t\t\t\t\t\tgetUsersFromStore.map((user, index) => {\r\n\t\t\t\t\t\t\t\t\t\t\treturn user.uuid === userUUID ?\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ListItem key={index} component=\"div\" disablePadding>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemButton>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemText primary={`Я: ${user.uuid}`} sx={{ color: 'red' }} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItemButton>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ListItem key={index} component=\"div\" disablePadding>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemButton>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ListItemText primary={user.uuid} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</ListItemButton>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\t<Preloader />\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</List>\r\n\t\t\t\t\t\t</Box >\r\n\t\t\t\t\t</Box >\r\n\r\n\t\t\t\t\t<Box sx={{ width: '100%', margin: '0 auto', bgcolor: 'background.paper', display: 'flex', flexDirection: 'row' }\r\n\t\t\t\t\t}>\r\n\t\t\t\t\t\t<Box sx={{ marginLeft: '.5em', display: 'flex', flexDirection: 'column', justifyContent: 'flex-start' }}>\r\n\t\t\t\t\t\t\t<Typography paragraph>Мой ID </Typography>\r\n\t\t\t\t\t\t\t<Typography paragraph>{userUUID}</Typography>\r\n\t\t\t\t\t\t\t<Button sx={{ marginBottom: '1em' }} variant=\"outlined\" onClick={startCapture}>Начать трансляцию</Button>\r\n\t\t\t\t\t\t\t<Button sx={{ marginBottom: '1em' }} variant=\"outlined\" onClick={stopCapture}>Закончить трансляцию</Button>\r\n\t\t\t\t\t\t\t<Button variant=\"outlined\" onClick={() => call(remotePeerId)}>Позвонить</Button>\r\n\t\t\t\t\t\t\t<p>Введите ИД здесь</p>\r\n\t\t\t\t\t\t\t<input type=\"text\" onChange={e => setRemotePeerId(e.target.value)} />\r\n\t\t\t\t\t\t</Box>\r\n\t\t\t\t\t\t<Box ref={videoContainer} sx={{ marginLeft: '.5em', display: 'flex', flexDirection: 'column', justifyContent: 'flex-start' }}>\r\n\r\n\t\t\t\t\t\t</Box>\r\n\r\n\t\t\t\t\t</Box >\r\n\t\t\t\t</Box >\r\n\r\n\t\t\t</Box >\r\n\t\t</Grid >\r\n\t);\r\n}","export const getScreen = () => {\r\n\tconst myDispplay = navigator.mediaDevices.getDisplayMedia({\r\n\t\tvideo: {\r\n\t\t\tcursor: 'always'\r\n\t\t},\r\n\t\taudio: true\r\n\t});\r\n\treturn myDispplay\r\n}","import React from 'react';\r\nimport Peer from 'peerjs';\r\n\r\n\r\nexport const initializePeerConnection = (userUUID, linkForSS) => {\r\n\treturn new Peer(userUUID, {\r\n\t\t// host: '/',\r\n\t\t// proxied: true,\r\n\t\t// debug: 1,\r\n\t\t// port: 10000,\r\n\t\t// path: '/sound/peer',\r\n\t});\r\n}","import React, { useCallback, useMemo } from 'react'\r\nimport { Input } from '@mui/material';\r\nimport Box from '@mui/material/Box';\r\nimport Button from '@mui/material/Button';\r\nimport Stack from '@mui/material/Stack';\r\nimport { getWayConnection } from '../../socket/getWayConnect';\r\nimport { NavLink } from 'react-router-dom';\r\nimport { mainRoot } from '../../socket/constants';\r\n\r\nexport const Main = ({ sessionUUID, lobbyUUID, setLobbyUUID }) => {\r\n\r\n\tconst handleConnectToGetWay = () => {\r\n\t\tgetWayConnection(sessionUUID, lobbyUUID, 1);\r\n\t}\r\n\r\n\tconst handleGetLobbyUUID = useCallback((e) => {\r\n\t\tsetLobbyUUID(e.target.value)\r\n\t}, [lobbyUUID, setLobbyUUID])\r\n\r\n\treturn (\r\n\t\t<Box sx={{ m: 2 }}>\r\n\t\t\t<Box sx={{ m: 2 }}>\r\n\t\t\t\t<Box sx={{ m: 1 }}>Нажми на кнопку, чтобы войти в общую говорилку</Box>\r\n\r\n\t\t\t\t<NavLink exact to={mainRoot + '/lobby'} style={{ textDecoration: 'none', color: 'inherit' }}>\r\n\t\t\t\t\t<Button variant=\"outlined\" onClick={handleConnectToGetWay}>Войти в общее лобби</Button>\r\n\t\t\t\t</NavLink>\r\n\r\n\t\t\t</Box>\r\n\t\t\t<Box sx={{ marginTop: 20 }}>\r\n\t\t\t\t<Box sx={{ m: 2 }}>Введи ID, чтобы создать комнату или законнектиться в неё</Box>\r\n\r\n\t\t\t\t<Stack spacing={2} direction=\"row\" justifyContent='center'>\r\n\t\t\t\t\t<Input onChange={handleGetLobbyUUID} />\r\n\t\t\t\t\t<NavLink exact to={mainRoot + `/lobby/${lobbyUUID}`} style={{ textDecoration: 'none', color: 'inherit' }}>\r\n\t\t\t\t\t\t<Button variant=\"outlined\" onClick={handleConnectToGetWay}>Войти в стенд</Button>\r\n\t\t\t\t\t</NavLink>\r\n\t\t\t\t</Stack>\r\n\r\n\t\t\t</Box>\r\n\t\t</Box>\r\n\t)\r\n}","import { setLinkForSS } from '../redux/appReducer';\r\nimport store from '../redux/store'\r\nimport {\r\n\tgetWayWebSocket,\r\n\tToGetway_FromUnknown_AuthSocket,\r\n\tFromGetway_AuthSocket_Response,\r\n\tToGetway_FromPlayer_GetSoundServer,\r\n\tFromGetway_FromPlayer_GetSoundServerResponse\r\n} from \"./constants.js\";\r\n\r\n// lobbyUUID = \"123456789012345678901234567890123456\"\r\nexport function getWayConnection(sessionUUID, lobbyUUID, connectionType = 1) {\r\n\r\n\tconst newWS = new WebSocket(getWayWebSocket);\r\n\r\n\tconnect();\r\n\r\n\tfunction connect() {\r\n\t\tnewWS.onopen = () => {\r\n\t\t\tconsole.log('GetWay Socket connected');\r\n\t\t\tnewWS.send(JSON.stringify({ method: ToGetway_FromUnknown_AuthSocket, token: sessionUUID, type: connectionType }))\r\n\t\t}\r\n\t\tnewWS.onmessage = (data) => {\r\n\t\t\tlet dataFromGetWay = JSON.parse(data.data);\r\n\t\t\tconsole.log(dataFromGetWay);\r\n\r\n\t\t\tif (dataFromGetWay.method != undefined) {\r\n\t\t\t\tswitch (dataFromGetWay.method) {\r\n\r\n\t\t\t\t\tcase FromGetway_AuthSocket_Response:\r\n\t\t\t\t\t\tconsole.log(dataFromGetWay.user);\r\n\t\t\t\t\t\tconsole.log();\r\n\t\t\t\t\t\tnewWS.send(JSON.stringify({ method: ToGetway_FromPlayer_GetSoundServer, lobby_uuid: lobbyUUID }));\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase FromGetway_FromPlayer_GetSoundServerResponse:\r\n\t\t\t\t\t\tlet link = `wss://${dataFromGetWay.ip}:${dataFromGetWay.port}`;\r\n\t\t\t\t\t\tstore.dispatch(setLinkForSS(link))\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.log('Unexpected method');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tnewWS.onclose = () => {\r\n\t\t\tconsole.log('GetWay websocket closed. trying to reconnect...');\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tconnect()\r\n\t\t\t}, 1000);\r\n\t\t}\r\n\t}\r\n}\r\n","import { useRef, useEffect, useMemo, useState } from 'react';\nimport './App.css';\nimport { NavBar } from \"./components/common/navbar/NavBar\";\nimport Microphone from \"./components/common/microphone/Microphone\";\nimport { Switch, Route, Redirect } from 'react-router-dom'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { getWayConnection } from './components/socket/getWayConnect';\nimport { Preloader } from './components/common/preloader/Preloader'\nimport { getWayWebSocket, mainRoot } from './components/socket/constants';\nimport { WSSSContext } from './utils/Context';\nimport { initializeApp, setLinkForSS } from './components/redux/appReducer';\nimport { chatRoom1 } from './components/common/chatRooms/rooms/СhatRoom1';\nimport { ChatBar } from './components/common/chatRooms/chatBar';\nimport { Main } from './components/common/main/Main'\n\nfunction App() {\n\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    dispatch(initializeApp());\n  }, [])\n\n  const [loadinglink, setLoaded] = useState(false);\n\n  //ref for ws\n  const webSocket = useRef(null)\n\n  const [contextWSSS, setContextWSSS] = useState({\n    linkForSS: '',\n    sessionTokenForSS: '',\n    userUUID: '',\n    type: '',\n    lobbyUUID: ''\n  })\n\n  const [lobbyUUID, setLobbyUUID] = useState('');\n  const [isAudio, setIsAudio] = useState(false);\n  const [isVideo, setIsVideo] = useState(false);\n\n\n  //get initial data for GetWay and SoundServer\n  const linkIsFetched = useSelector(state => state.app.linkIsFetched)\n  const linkForSS = useSelector(state => state.app.linkForSS)\n  const sessionTokenForSS = useSelector(state => state.users.self.session_uuid)\n  const userUUID = useSelector(state => state.users.self.user_uuid)\n  const getConnectionType = useSelector(state => state.app.type)\n\n  //get users from store\n  const getUsersFromStore = useSelector(state => state.users.users)\n\n  useMemo(() => {\n    dispatch(setLinkForSS);\n    setContextWSSS({ linkForSS, sessionTokenForSS, userUUID, getConnectionType, lobbyUUID })\n\n  }, [linkForSS, sessionTokenForSS, userUUID, getConnectionType, lobbyUUID])\n\n  // useEffect(() => {\n  //   getWayConnection()\n  // }, [])\n\n\n  useMemo(() => {\n    setLoaded(linkIsFetched)\n  }, [linkIsFetched]);\n\n\n\n  return (\n    <WSSSContext.Provider value={contextWSSS}>\n      <div className=\"home\" style={{ textAlign: \"center\" }}>\n\n        <NavBar\n          getUsersFromStore={getUsersFromStore}\n          record={isAudio}\n          setIsAudio={setIsAudio}\n          webSocket={webSocket}\n        />\n        <Switch>\n\n          <Route exact path={mainRoot} render={() => <Main lobbyUUID={lobbyUUID} setLobbyUUID={setLobbyUUID} sessionUUID={sessionTokenForSS} />} />\n          <Route exact path={mainRoot + `/lobby/${lobbyUUID}`} render={() => <ChatBar\n            getUsersFromStore={getUsersFromStore}\n            isAudio={isAudio}\n            setIsAudio={setIsAudio}\n            isVideo={isVideo}\n            setIsVideo={setIsVideo}\n            linkForSS={linkForSS}\n            userUUID={userUUID}\n          />} />\n\n          <Route path='*'\n            render={() => <div> 404 Page not found!</div>} />\n        </Switch>\n\n      </div>\n    </WSSSContext.Provider >\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { BrowserRouter } from 'react-router-dom'\nimport reportWebVitals from './reportWebVitals';\nimport { Provider } from 'react-redux';\nimport store from './components/redux/store'\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <Provider store={store}>\n        <App />\n      </Provider>\n    </BrowserRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}