(this["webpackJsonpvoice-chat"]=this["webpackJsonpvoice-chat"]||[]).push([[0],{168:function(e,t,n){},169:function(e,t,n){},202:function(e,t,n){},203:function(e,t,n){},204:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=204},210:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),o=n(31),i=n.n(o),a=(n(168),n(10)),s=(n(169),n(119)),u=n(278),l=n(302),d=n(280),j=n(281),b=n(282),f=n(30),O=n(300),h=n(303),x=n(297),p=n(284),m="/chat",g="wss://getway.dev.viexpo.ru/service/getway",y=Object(c.createContext)(),v=n(62),S=n.n(v),w=n(84),U=n(16),k=n(19),E=n(122).create({baseURL:"https://getway.dev.viexpo.ru/api/"}),T=function(){return E.get("account/fake/get")},D="SET_USER_DATA",I="GET_CURRENT_USERS_LIST",_="USER_JOINED",C="USER_LEFT",F={users:[],self:{session_uuid:"",user_id:null,user_uuid:"",email:"",avatar:"",first_name:"",secon_name:"",last_name:"",phone:"",birthday:"",sex:"",company_uuid:"",company_name:"",company_position:"",company_role:null,system_role:null},isAuth:!1},A=function(e){return{type:D,payload:e}},L=n(2),M="INITIALIZED_SUCCESS",N="ON_LINK_GOTTEN",P="GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT",R="GET_OUTPUT_PLAYER_SCREEN_FROM_SERVER",V={initialized:!1,linkIsFetched:!1,linkForSS:"",type:1,onDialog:!1,outputPlayerVoiceFromClient:null,outputPlayerScreemFromSS:null},z=function(e){return{type:N,link:e}},G=Object(u.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),B={position:"absolute",top:"6%",right:"10%",width:400,maxHeight:"70vh",bgcolor:"background.paper",boxShadow:24,p:4,border:"1px solid grey",overflow:"auto"};var W=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=!0===n?0:36,r="";!1===n&&(e.offset=t,r=e.readUtf8String(c)),e.offset=t+c+0;var o=e.readUInt32LE(),i={x:0,y:0,z:0};e.offset=t+c+4+0,i.x=e.readFloatLE(),e.offset=t+c+4+4,i.y=e.readFloatLE(),e.offset=t+c+4+8,i.z=e.readFloatLE(),e.offset=t+c+4+12;var a=e.readUInt8();return{uuid:r,id:o,position:i,state:a}},H=function(e){var t=e.getUsersFromStore,n=(e.setScreenBlob,e.record),r=e.webSocket,o=G(),i=Object(c.useState)(!1),u=Object(a.a)(i,2),m=u[0],g=u[1],v=Object(c.useState)(!1),S=Object(a.a)(v,2),w=S[0],U=S[1],k=Object(f.b)(),E=Object(c.useContext)(y),T=E.linkForSS,D=E.sessionTokenForSS,F=E.userUUID,A=E.getConnectionType,M=E.lobbyUUID,N=null,P=Object(c.useState)([]),R=Object(a.a)(P,2),V=R[0],z=R[1];return Object(c.useEffect)((function(){T&&r&&function e(){var t=T||console.log("Fetching the link...");N=new WebSocket(t),r&&(r.current=N);window.webSocketSS=N,N.binaryType="arraybuffer",N.onopen=function(){var e=new Uint8Array(77),t=new Uint8Array(new Uint32Array([0]).buffer),n=(new TextEncoder).encode(D),c=(new TextEncoder).encode(M);e.set(t,0),e.set(n,4),e.set(new Uint8Array([A]),40),e.set(c,41),N.send(e),1===N.readyState&&U(!0)},N.onmessage=function(e){var t=new s.BufferStream(e.data);t.offset=0;var n=t.readInt32LE();switch(n){case 9994:t.offset=4;for(var c=t.readUInt32LE(),r=[],o=0;o<c;o++){var i=W(t,8+53*o);i.uuid===F&&console.log("the uuid is the same"),r.push(i)}k(function(e){return{type:I,users:e}}(r)),console.log(JSON.stringify(r)),console.log("Method: FromMovement_FromPlayerScene_PlayerList, count: "+c,r);break;case 9992:var a=W(t,4);console.log("User Join: "+a.uuid),k(function(e){return{type:_,user:e}}(a));break;case 9993:t.offset=4;var u=t.readUtf8String(36);console.log("User Leave: "+u),k({type:C,userUuid:u});break;case 9996:W(t,4,!0);!function(e){var t=new Blob([e],{type:"audio/webm;codecs=opus"}),n=new FileReader;n.readAsDataURL(t),n.onloadend=function(){var e=n.result,t=new Audio(e);t.addEventListener("canplay",(function(){t.play()}))}}(new Uint8Array(t.buffer.buffer,21));break;default:console.log("Method: Unknown")}console.log("WebSocket message received:",n)},N.onclose=function(t){console.log("Sound Server Socket closed. Trying to reconnect..."),console.log("Server closed with code => ",t.code),1!==N.readyState&&U(!1),1005!==t.code?setTimeout((function(){e()}),1e3):console.log("Socket was closed by user")},N.onerror=function(e){console.log("This error happened => ",e),N.close()};window.sendPlayerTick=function(e){return function(e,t,n){var c=new Uint8Array(17+n.byteLength),r=new Uint8Array(new Uint32Array([9991]).buffer);c.set(r,0),c.set(new Uint8Array(new Float32Array([e.x]).buffer),4),c.set(new Uint8Array(new Float32Array([e.y]).buffer),8),c.set(new Uint8Array(new Float32Array([e.z]).buffer),12),c.set(new Uint8Array([t]),16),c.set(n,17),1===N.readyState&&N.send(c)}({x:0,y:0,z:0},0,e)}}()}),[T,r]),Object(c.useMemo)((function(){w&&function e(){var t=setTimeout((function(){n?clearTimeout(t):(window.sendPlayerTick(new Uint8Array),e())}),4e3)}()}),[n,w]),Object(c.useMemo)((function(){z(t),console.log(V)}),[t,V]),Object(L.jsx)("div",{className:o.root,children:Object(L.jsx)(l.a,{position:"static",children:Object(L.jsxs)(d.a,{children:[Object(L.jsxs)(j.a,{variant:"h6",className:o.title,children:["Connection Status:",w?" Connected!":" Disconnected!"]}),Object(L.jsx)(b.a,{color:"inherit",onClick:function(){return g(!0)},children:"Users List"}),Object(L.jsx)(x.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:m,onClose:function(){return g(!1)},closeAfterTransition:!0,BackdropComponent:O.a,BackdropProps:{timeout:500},children:Object(L.jsx)(p.a,{in:m,children:Object(L.jsxs)(h.a,{sx:B,children:[Object(L.jsx)(j.a,{id:"transition-modal-title",variant:"h6",component:"h2",children:"Users connected:"}),0!==t.length?t.map((function(e){return F===e.uuid?Object(L.jsxs)(j.a,{id:"transition-modal-description",sx:{mt:2},children:["Self: ",Object(L.jsx)("span",{style:{color:"red"},children:e.uuid})]},e.id):Object(L.jsxs)(j.a,{id:"transition-modal-description",sx:{mt:2},children:["User's UUID: ",Object(L.jsx)("span",{style:{color:"blue"},children:e.uuid})]},e.id)})):Object(L.jsx)(j.a,{id:"transition-modal-description",sx:{mt:2},children:"Waiting for users"})]})})})]})})})},J=n(129),Y=n.n(J),X=n(130),K=n.n(X),Z=n(289),q=n(127),Q=n.n(q),$=n(128),ee=n.n($),te=n(288),ne=(n(202),Object(u.a)((function(e){return{icon:{height:38,width:38},reactmic:{width:"80%",height:30},flex:{flex:1}}})));function ce(e){var t=e.size,n=e.isAudio,c=e.setIsAudio,r=e.isVideo,o=e.setIsVideo,i=ne();return Object(L.jsx)(L.Fragment,{children:Object(L.jsx)(te.a,{container:!0,justifyContent:"center",children:Object(L.jsxs)(te.a,{item:!0,children:[r?Object(L.jsx)(Z.a,{onClick:function(){o(!1)},children:Object(L.jsx)(ee.a,{className:i.icon,style:{width:t,height:t}})}):Object(L.jsx)(Z.a,{onClick:function(){o(!0)},children:Object(L.jsx)(Q.a,{className:i.icon,style:{width:t,height:t}})}),n?Object(L.jsx)(Z.a,{onClick:function(){c(!1)},children:Object(L.jsx)(K.a,{className:i.icon,style:{width:t,height:t}})}):Object(L.jsx)(Z.a,{onClick:function(){c(!0)},children:Object(L.jsx)(Y.a,{className:i.icon,style:{width:t,height:t}})})]})})})}var re=n(17),oe=n(77),ie=n(131),ae=Object(oe.b)({app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return Object(k.a)(Object(k.a)({},e),{},{initialized:!0});case P:return Object(k.a)(Object(k.a)({},e),{},{outputPlayerVoiceFromClient:t.voice});case R:return Object(k.a)(Object(k.a)({},e),{},{outputPlayerScreemFromSS:t.screen});case N:return Object(k.a)(Object(k.a)({},e),{},{linkIsFetched:!0,linkForSS:t.link});default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return Object(k.a)(Object(k.a)({},e),{},{self:Object(k.a)({},t.payload),isAuth:!0});case I:return Object(k.a)(Object(k.a)({},e),{},{users:t.users});case _:return Object(k.a)(Object(k.a)({},e),{},{users:[].concat(Object(U.a)(e.users),[t.user])});case C:return Object(k.a)(Object(k.a)({},e),{},{users:e.users.filter((function(e){return e.uuid!=t.userUuid}))});default:return e}}}),se=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||oe.c,ue=Object(oe.d)(ae,se(Object(oe.a)(ie.a)));window.__store__=ue;var le=ue;n.p;var de=function(){return Object(L.jsxs)("div",{className:"lds-facebook",children:[Object(L.jsx)("div",{}),Object(L.jsx)("div",{}),Object(L.jsx)("div",{})]})},je=(n(290),n(309),n(6)),be=n(301),fe=n(307),Oe=n(306),he=n(298),xe=n(299),pe=n(293),me=n(308),ge=(n(203),n(132)),ye=n.n(ge),ve=function(){return(navigator.mediaDevices.getUserMedia||navigator.mediaDevices.webkitGetUserMedia||navigator.mediaDevices.mozGetUserMedia||navigator.mediaDevices.msGetUserMedia)({video:{noiseSuppression:!0,width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}},audio:{echoCancellation:!0,noiseSuppression:!0}})},Se=function(e,t,n,c,r){if(!t[n.id]){t[n.id]=Object(k.a)({},n);var o=c,i=document.createElement("video");0===r&&i.classList.add("internalVideo"),1===r&&i.classList.add("externalVideo"),i.srcObject=t[n.id].stream,i.id=n.id,i.autoplay=!0,e===n.id&&(i.muted=!0),o.append(i)}},we=n(304),Ue=n(305),ke=n(296),Ee=n(133),Te=n.n(Ee);function De(e){return e<10?"0"+e:e}var Ie=n(295),_e=360,Ce=function(e){var t,n=e.getUsersFromStore,r=e.isAudio,o=e.setIsAudio,i=e.isVideo,s=e.setIsVideo,u=(Object(f.b)(),Object(c.useContext)(y).userUUID),l={},d=Object(c.useState)(null),b=Object(a.a)(d,2),O=b[0],x=b[1],p=Object(c.useState)([]),m=Object(a.a)(p,2),g=(m[0],m[1],Object(c.useState)([])),v=Object(a.a)(g,2),S=v[0],w=(v[1],Object(c.useState)([])),k=Object(a.a)(w,2),E=k[0],T=k[1],D=Object(c.useState)(!1),I=Object(a.a)(D,2),_=(I[0],I[1]),C=Object(c.useState)("media"),F=Object(a.a)(C,2),A=F[0],M=F[1],N=Object(c.useState)(null),P=Object(a.a)(N,2),R=P[0],V=P[1],z=Object(c.useState)([]),G=Object(a.a)(z,2),B=G[0],W=G[1],H=Object(c.useState)(!0),J=Object(a.a)(H,2),Y=J[0],X=J[1],K=Object(c.useRef)(),Z=Object(c.useState)(null),q=Object(a.a)(Z,2),Q=q[0],$=q[1],ee=Object(c.useState)([]),ne=Object(a.a)(ee,2),oe=ne[0],ie=ne[1],ae=Object(c.useRef)();Object(c.useEffect)((function(){"screen"===A&&navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!0}).then((function(e){if(e){var t=e.getVideoTracks()[0];t.onended=function(){se()},R.getSenders().find((function(e){return e.track.kind===t.kind})).replaceTrack(t)}})).catch((function(e){console.log("Unable to get display media "+e)}))}),[A]);var se=function(){var e=E!==[]?E[0].getVideoTracks()[0]:S[0].getVideoTracks()[0];R.getSenders().find((function(t){return t.track.kind===e.kind})).replaceTrack(e),M("media")};var ue=Object(c.useState)(""),le=Object(a.a)(ue,2),ge=le[0],Ee=le[1];return Object(c.useEffect)((function(){u&&x(function(e,t){return new ye.a(e,{})}(u))}),[u]),Object(c.useEffect)((function(){O&&(O.on("open",(function(e){console.log("My peer ID is: "+e)})),O.on("connection",(function(e){$(e),X(!1)})),O.on("call",(function(e){"media"===A&&ve().then((function(t){t&&(T([].concat(Object(U.a)(E),[t])),Se(u,l,{id:u,stream:t},K.current,0),_(!0),e.answer(t),e.on("stream",(function(t){B.includes(e.peer)||(Se(u,l,{id:e.peer,stream:t},K.current,1),V(e.peerConnection),W([].concat(Object(U.a)(B),[e.peer])))})))}))})),O.on("close",(function(){console.log("closed")})),O.on("error",(function(e){console.log(e)})))}),[O]),Object(c.useEffect)((function(){Q&&Q.on("data",(function(e){ie((function(t){return[].concat(Object(U.a)(t),[{me:!1,currentMinutes:De((new Date).getMinutes()),currentHour:De((new Date).getHours()),message:e}])}))}))}),[Q]),Object(c.useEffect)((function(){S&&(S.forEach((function(e){return e.getAudioTracks().forEach((function(e){e.enabled=r}))})),S.forEach((function(e){return e.getVideoTracks().forEach((function(e){e.enabled=i}))})))}),[S,r,i]),Object(c.useEffect)((function(){E&&(E.forEach((function(e){return e.getAudioTracks().forEach((function(e){e.enabled=r}))})),E.forEach((function(e){return e.getVideoTracks().forEach((function(e){e.enabled=i}))})),console.log(B,R))}),[E,r,i]),Object(L.jsx)(te.a,{children:Object(L.jsxs)(h.a,{sx:{display:"flex"},children:[Object(L.jsx)(we.a,{position:"fixed",sx:{zIndex:function(e){return e.zIndex.drawer+1},width:_e,left:0},children:Object(L.jsx)(Ue.a,{sx:{justifyContent:"center"},children:Object(L.jsx)(j.a,{variant:"h6",noWrap:!0,component:"div",children:"\u0427\u0430\u0442"})})}),Object(L.jsxs)(be.a,{sx:{width:_e,flexShrink:0,"& .MuiDrawer-paper":{width:_e,boxSizing:"border-box"}},variant:"permanent",anchor:"left",children:[Object(L.jsx)(Oe.a,{}),Object(L.jsx)(fe.a,{id:"chat-list",sx:{marginTop:"4em",overflowY:"scroll",maxHeight:"75%"},children:oe.map((function(e,t){return Object(L.jsx)(he.a,{children:e.me?Object(L.jsxs)(xe.a,{children:[Object(L.jsx)("span",{style:{color:"#5271e3",fontWeight:"bold"},children:"\u042f"})," \u0432 ",e.currentHour,":",e.currentMinutes," :",Object(L.jsxs)(j.a,{children:[" ",e.message]})]}):Object(L.jsxs)(xe.a,{children:[Object(L.jsx)("span",{style:{color:"#ba32b3",fontWeight:"bold"},children:"\u041d\u0430 \u0442\u043e\u043c \u043a\u043e\u043d\u0446\u0435 \u043f\u0440\u043e\u0432\u043e\u0434\u0430"})," \u0432 ",e.currentHour,":",e.currentMinutes," :",Object(L.jsxs)(j.a,{children:[" ",e.message]})]})},t)}))}),Object(L.jsxs)(h.a,(t={component:"form",sx:{"& .MuiTextField-root":{m:1,width:"25ch"}},noValidate:!0,autoComplete:"off"},Object(je.a)(t,"sx",{position:"fixed",bottom:".5%",width:_e}),Object(je.a)(t,"children",[Object(L.jsx)(ke.a,{id:"outlined-multiline-flexible",label:"\u0412\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",multiline:!0,rows:3,inputProps:{style:{paddingRight:"10%"},ref:ae},sx:{width:"100%"}}),Object(L.jsx)(me.a,{type:"submit",onClick:function(e){if(e.preventDefault(),Q){if(ie((function(e){return[].concat(Object(U.a)(e),[{me:!0,currentMinutes:De((new Date).getMinutes()),currentHour:De((new Date).getHours()),message:ae.current.value}])})),!ae.current.value)return;Q.send(ae.current.value),ae.current.value=""}},sx:{position:"absolute",bottom:"25%",right:0},children:Object(L.jsx)(Te.a,{})})]),t))]}),Object(L.jsxs)(h.a,{sx:{width:"calc(100% - 240px)",display:"flex",flexDirection:"column"},children:[Object(L.jsxs)(h.a,{sx:{width:"100%",m:"1em auto",bgcolor:"background.paper",display:"flex",flexDirection:"row"},children:[Object(L.jsxs)(h.a,{component:"main",sx:{flexGrow:1,p:1},children:[Object(L.jsx)(ce,{size:"2em",isAudio:r,setIsAudio:o,isVideo:i,setIsVideo:s}),Object(L.jsx)(re.c,{})]}),Object(L.jsx)(h.a,{sx:{marginTop:"2em",width:"100%",maxWidth:360,bgcolor:"background.paper"},children:Object(L.jsxs)(fe.a,{children:[Object(L.jsx)(xe.a,{primary:"\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439"}),0!==n.length?n.map((function(e,t){return e.uuid===u?Object(L.jsx)(he.a,{component:"div",disablePadding:!0,children:Object(L.jsx)(pe.a,{children:Object(L.jsx)(xe.a,{primary:"\u042f: ".concat(e.uuid),sx:{color:"red"}})})},t):Object(L.jsx)(he.a,{component:"div",disablePadding:!0,children:Object(L.jsx)(pe.a,{children:Object(L.jsx)(xe.a,{primary:e.uuid})})},t)})):Object(L.jsx)(de,{})]})})]}),Object(L.jsxs)(h.a,{sx:{width:"100%",margin:"0 auto",bgcolor:"background.paper",display:"flex",flexDirection:"row"},children:[Object(L.jsxs)(h.a,{sx:{marginLeft:".5em",display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[Object(L.jsx)(j.a,{paragraph:!0,children:"\u041c\u043e\u0439 ID "}),Object(L.jsx)(j.a,{paragraph:!0,children:u}),Object(L.jsx)(Ie.a,{title:"\u0427\u0442\u043e\u0431\u044b \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0435\u0439 \u044d\u043a\u0440\u0430\u043d\u0430, \u043f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u0435 \u043a\u043e\u043c\u0443-\u043d\u0438\u0431\u0443\u0434\u044c",placement:"right-start",children:Object(L.jsx)("span",{style:{display:"block"},children:Object(L.jsx)(me.a,{sx:{marginBottom:"1em",width:"100%"},disabled:Y,variant:"outlined",onClick:function(){M("screen")},children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u044e"})})}),Object(L.jsx)(Ie.a,{title:"\u0427\u0442\u043e\u0431\u044b \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0435\u0439 \u044d\u043a\u0440\u0430\u043d\u0430, \u043f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u0435 \u043a\u043e\u043c\u0443-\u043d\u0438\u0431\u0443\u0434\u044c",placement:"right-start",children:Object(L.jsx)("span",{style:{display:"block"},children:Object(L.jsx)(me.a,{sx:{marginBottom:"1em",width:"100%"},disabled:Y,variant:"outlined",onClick:se,children:"\u0417\u0430\u043a\u043e\u043d\u0447\u0438\u0442\u044c \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u044e"})})}),Object(L.jsx)(Ie.a,{title:'\u0412\u0441\u0442\u0430\u0432\u044c\u0442\u0435 ID \u0430\u0434\u0440\u0435\u0441\u0430\u0442\u0430 \u0432 \u043f\u043e\u043b\u0435 \u043d\u0438\u0436\u0435 \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 "\u041f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c"',placement:"bottom-start",children:Object(L.jsx)(me.a,{variant:"outlined",onClick:function(){return function(e){$(O.connect(e)),X(!1),ve().then((function(t){if(t){T([].concat(Object(U.a)(E),[t])),Se(u,l,{id:u,stream:t},K.current,0),_(!0);var n=O.call(e,t);n.on("stream",(function(e){B.includes(n.peer)||(Se(u,l,{id:n.peer,stream:e},K.current,1),V(n.peerConnection),W([].concat(Object(U.a)(B),[n.peer])))})),n.on("close",(function(){X(!0)}))}}))}(ge)},children:"\u041f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c"})}),Object(L.jsx)("p",{children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0418\u0414 \u0437\u0434\u0435\u0441\u044c"}),Object(L.jsx)("input",{type:"text",onChange:function(e){return Ee(e.target.value)}})]}),Object(L.jsx)(h.a,{ref:K,sx:{marginLeft:".5em",display:"flex",flexDirection:"column",justifyContent:"flex-start"}})]})]})]})})},Fe=n(311),Ae=n(294),Le=n(54),Me=function(e){var t=e.sessionUUID,n=e.lobbyUUID,r=e.setLobbyUUID,o=function(){!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c=new WebSocket(g);function r(){c.onopen=function(){console.log("GetWay Socket connected"),c.send(JSON.stringify({method:0,token:e,type:n}))},c.onmessage=function(e){var n=JSON.parse(e.data);if(console.log(n),void 0!=n.method)switch(n.method){case 1:console.log(n.user),console.log(),c.send(JSON.stringify({method:7,lobby_uuid:t}));break;case 8:var r="wss://".concat(n.ip,":").concat(n.port);le.dispatch(z(r));break;default:console.log("Unexpected method")}},c.onclose=function(){console.log("GetWay websocket closed. trying to reconnect..."),setTimeout((function(){r()}),1e3)}}r()}(t,n,1)},i=Object(c.useCallback)((function(e){r(e.target.value)}),[n,r]);return Object(L.jsxs)(h.a,{sx:{m:2},children:[Object(L.jsxs)(h.a,{sx:{m:2},children:[Object(L.jsx)(h.a,{sx:{m:1},children:"\u041d\u0430\u0436\u043c\u0438 \u043d\u0430 \u043a\u043d\u043e\u043f\u043a\u0443, \u0447\u0442\u043e\u0431\u044b \u0432\u043e\u0439\u0442\u0438 \u0432 \u043e\u0431\u0449\u0443\u044e \u0433\u043e\u0432\u043e\u0440\u0438\u043b\u043a\u0443"}),Object(L.jsx)(Le.b,{exact:!0,to:"/chat/lobby",style:{textDecoration:"none",color:"inherit"},children:Object(L.jsx)(me.a,{variant:"outlined",onClick:o,children:"\u0412\u043e\u0439\u0442\u0438 \u0432 \u043e\u0431\u0449\u0435\u0435 \u043b\u043e\u0431\u0431\u0438"})})]}),Object(L.jsxs)(h.a,{sx:{marginTop:20},children:[Object(L.jsx)(h.a,{sx:{m:2},children:"\u0412\u0432\u0435\u0434\u0438 ID, \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043c\u043d\u0430\u0442\u0443 \u0438\u043b\u0438 \u0437\u0430\u043a\u043e\u043d\u043d\u0435\u043a\u0442\u0438\u0442\u044c\u0441\u044f \u0432 \u043d\u0435\u0451"}),Object(L.jsxs)(Ae.a,{spacing:2,direction:"row",justifyContent:"center",children:[Object(L.jsx)(Fe.a,{onChange:i}),Object(L.jsx)(Le.b,{exact:!0,to:m+"/lobby/".concat(n),style:{textDecoration:"none",color:"inherit"},children:Object(L.jsx)(me.a,{variant:"outlined",onClick:o,children:"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0441\u0442\u0435\u043d\u0434"})})]})]})]})};var Ne=function(){var e=Object(f.b)();Object(c.useEffect)((function(){e(function(){var e=Object(w.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t(function(){var e=Object(w.a)(S.a.mark((function e(t){var n,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:0===(n=e.sent).data.code&&(c=n.data.response.user,t(A(c)));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Promise.all([n]).then((function(){t({type:M})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var t=Object(c.useState)(!1),n=Object(a.a)(t,2),r=(n[0],n[1]),o=Object(c.useRef)(null),i=Object(c.useState)({linkForSS:"",sessionTokenForSS:"",userUUID:"",type:"",lobbyUUID:""}),s=Object(a.a)(i,2),u=s[0],l=s[1],d=Object(c.useState)(""),j=Object(a.a)(d,2),b=j[0],O=j[1],h=Object(c.useState)(!1),x=Object(a.a)(h,2),p=x[0],g=x[1],v=Object(c.useState)(!1),U=Object(a.a)(v,2),k=U[0],E=U[1],D=Object(f.c)((function(e){return e.app.linkIsFetched})),I=Object(f.c)((function(e){return e.app.linkForSS})),_=Object(f.c)((function(e){return e.users.self.session_uuid})),C=Object(f.c)((function(e){return e.users.self.user_uuid})),F=Object(f.c)((function(e){return e.app.type})),N=Object(f.c)((function(e){return e.users.users}));return Object(c.useMemo)((function(){e(z),l({linkForSS:I,sessionTokenForSS:_,userUUID:C,getConnectionType:F,lobbyUUID:b})}),[I,_,C,F,b]),Object(c.useMemo)((function(){r(D)}),[D]),Object(L.jsx)(y.Provider,{value:u,children:Object(L.jsxs)("div",{className:"home",style:{textAlign:"center"},children:[Object(L.jsx)(H,{getUsersFromStore:N,record:p,setIsAudio:g,webSocket:o}),Object(L.jsxs)(re.c,{children:[Object(L.jsx)(re.a,{exact:!0,path:m,render:function(){return Object(L.jsx)(Me,{lobbyUUID:b,setLobbyUUID:O,sessionUUID:_})}}),Object(L.jsx)(re.a,{exact:!0,path:m+"/lobby/".concat(b),render:function(){return Object(L.jsx)(Ce,{getUsersFromStore:N,isAudio:p,setIsAudio:g,isVideo:k,setIsVideo:E,linkForSS:I,userUUID:C})}}),Object(L.jsx)(re.a,{path:"*",render:function(){return Object(L.jsx)("div",{children:" 404 Page not found!"})}})]})]})})},Pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,314)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),o(e),i(e)}))};i.a.render(Object(L.jsx)(r.a.StrictMode,{children:Object(L.jsx)(Le.a,{children:Object(L.jsx)(f.a,{store:le,children:Object(L.jsx)(Ne,{})})})}),document.getElementById("root")),Pe()}},[[210,1,2]]]);
//# sourceMappingURL=main.6b17ec7f.chunk.js.map