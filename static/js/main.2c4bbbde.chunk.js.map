{"version":3,"sources":["utils/Context.js","components/redux/appReducer.js","components/common/navbar/NavBar.js","components/socket/constatns.js","components/common/microphone/Microphone.js","components/common/audioPlayer/AudioPlayer.js","components/redux/store.js","assets/src/preloader/preloader.gif","components/common/preloader/Preloader.js","App.js","components/socket/getWayConnect.js","reportWebVitals.js","index.js"],"names":["WSSSContext","createContext","INITIALIZED_SUCCESS","TOKEN_USER_UUID_GOTTEN","ON_LINK_GOTTEN","ON_DIALOG","GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT","GET_OUTPUT_PLAYER_VOICE_FROM_SERVER","initialState","initialized","linkIsFetched","sessionToken","userUUID","linkForSS","onDialog","outputPlayerVoiceFromClient","outputPlayerVoiceFromSS","setSessionUserUUID","type","payload","setLinkForSS","link","useStyles","makeStyles","theme","root","flexGrow","menuButton","marginRight","spacing","title","readPlayerFromPlayerList","buffer","startOffset","hasPosition","userUUIDLen","uuid","offset","readUtf8String","id","readUInt32LE","position","x","y","z","readFloatLE","state","readUInt8","NavBar","classes","useState","connected","setConnected","useDispatch","useContext","sessionTokenForSS","userUUIDForSS","useSelector","app","useEffect","start","webSocketSS","WebSocket","console","log","binaryType","onopen","Axios","get","then","res","sessionUUID","data","response","session_uuid","array","Uint8Array","methodBuffer","Uint32Array","sessionBuffer","TextEncoder","encode","locationUUIDBuffer","set","send","readyState","onmessage","message","BufferStream","method","readInt32LE","countPlayers","users","index","user","push","JSON","stringify","user_from_voice","blobForPlay","outputBlob","Blob","fileReader","FileReader","readAsDataURL","onloadend","base64String","result","audio","Audio","addEventListener","play","outputPlayerVoice","onclose","e","code","setTimeout","onerror","err","close","window","sendPlayerTick","audioChunk","voiceBody","byteLength","Float32Array","className","AppBar","Toolbar","IconButton","edge","color","Typography","variant","Button","icon","height","width","reactmic","wavesurfer","margin","flex","Microphone","pushFile","setCurrentAvatarId","record","setRecord","stopRecord","setStopRecord","useRef","navigator","mediaDevices","getUserMedia","stream","mediaRecorder","MediaRecorder","audioChunks","getAudioTracks","str","event","length","mimeType","arrayBuffer","audioBuffer","stop","startRecording","totallyStop","forEach","track","Grid","container","justify","item","onClick","Card","DialogTitle","DialogContent","visualSetting","echoCancellation","noiseSuppression","onStop","onData","recordedBlob","strokeColor","backgroundColor","DialogActions","xs","style","red","card","maxWidth","minWidth","transition","boxShadow","media","list","padding","listItem","buttons","controls","avatar","display","AudioPlayer","file","currentAvatarId","setPlayerReady","isPlaying","setIsPlaying","wavesurferId","uuidv4","current","WaveSurfer","create","waveColor","progressColor","cursorWidth","cursorColor","barWidth","normalize","responsive","fillParent","wav","load","on","handleResize","util","debounce","empty","drawBuffer","blobURL","transportPlayButton","togglePlayback","pause","direction","List","ListItem","alignItems","ListItemAvatar","Avatar","src","ListItemText","primary","secondary","blue","green","reducers","combineReducers","action","voice","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunkMiddleware","__store__","Preloader","App","dispatch","loadinglink","setLoaded","contextWSSS","setContextWSSS","useMemo","useCallback","newWS","connect","token","dataFromGetWay","parse","undefined","user_uuid","company_uuid","ip","port","getWayConnection","files","setFiles","Provider","value","textAlign","map","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2c4bbbde.chunk.js","sourcesContent":["import React, { createContext } from \"react\";\r\n\r\nexport const WSSSContext = createContext();","const INITIALIZED_SUCCESS = 'INITIALIZED_SUCCESS';\r\nconst TOKEN_USER_UUID_GOTTEN = 'TOKEN_USER_UUID_GOTTEN';\r\nconst ON_LINK_GOTTEN = 'ON_LINK_GOTTEN';\r\nconst ON_DIALOG = 'ON_DIALOG'\r\nconst GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT = 'GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT';\r\nconst GET_OUTPUT_PLAYER_VOICE_FROM_SERVER = 'GET_OUTPUT_PLAYER_VOICE_FROM_SERVER';\r\n\r\n\r\nlet initialState = {\r\n\tinitialized: false,\r\n\tlinkIsFetched: false,\r\n\tsessionToken: '',\r\n\tuserUUID: '',\r\n\tlinkForSS: '',\r\n\tonDialog: false,\r\n\toutputPlayerVoiceFromClient: null,\r\n\toutputPlayerVoiceFromSS: null\r\n}\r\n\r\nexport const appReducer = (state = initialState, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase INITIALIZED_SUCCESS:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tinitialized: true\r\n\t\t\t};\r\n\t\tcase TOKEN_USER_UUID_GOTTEN:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...action.payload\r\n\t\t\t};\r\n\t\tcase ON_DIALOG:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tonDialog: !state.onDialog\r\n\t\t\t}\r\n\t\tcase GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\toutputPlayerVoiceFromClient: action.voice\r\n\t\t\t}\r\n\t\tcase GET_OUTPUT_PLAYER_VOICE_FROM_SERVER:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\toutputPlayerVoiceFromSS: action.voice\r\n\t\t\t}\r\n\t\tcase ON_LINK_GOTTEN:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tlinkIsFetched: true,\r\n\t\t\t\tlinkForSS: action.link,\r\n\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state\r\n\t}\r\n}\r\n\r\n//AC\r\n// export const setInitializedSuccess = () => ({ type: INITIALIZED_SUCCESSED });\r\nexport const setSessionUserUUID = (sessionToken, userUUID) => ({ type: TOKEN_USER_UUID_GOTTEN, payload: { sessionToken, userUUID } })\r\nexport const setLinkForSS = (link) => ({ type: ON_LINK_GOTTEN, link })\r\nexport const toggleOnDialog = () => ({ type: ON_DIALOG })\r\nexport const setOutputPlayerVoiceFromClient = (voice) => ({ type: GET_OUTPUT_PLAYER_VOICE_FROM_CLIENT, voice })\r\nexport const setOutputPlayerVoiceFromSS = (voice) => ({ type: GET_OUTPUT_PLAYER_VOICE_FROM_SERVER, voice })\r\n\r\n//thunk\r\n// export const getOutputPlayerVoiceFromClient = (voice) => {\r\n// \treturn async (dispatch) => {\r\n// \t\tdispatch(toggleOnDialog());\r\n// \t\tdebugger\r\n// \t\tawait dispatch(setOutputPlayerVoiceFromClient(voice));\r\n// \t\tdispatch(toggleOnDialog());\r\n// \t\tdispatch(setOutputPlayerVoiceFromClient(null));\r\n\r\n// \t}\r\n// }","import Axios from 'axios'\r\nimport { BufferStream } from \"buffer-stream-js\";\r\nimport React, { useCallback, useContext, useEffect, useMemo, useState } from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\nimport {\r\n\r\n\tToGetway_FromUnknown_AuthSocket,\r\n\tToMovement_ToPlayerScene_PlayerTick,\r\n\tFromMovement_FromPlayerScene_PlayerJoin,\r\n\tFromMovement_FromPlayerScene_PlayerLeave,\r\n\tFromMovement_FromPlayerScene_PlayerList,\r\n\tFromSound_FromPlayerScene_PlayerVoice\r\n} from \"../../socket/constatns.js\";\r\nimport { WSSSContext } from \"../../../utils/Context\";\r\nimport { setOutputPlayerVoiceFromClient, setOutputPlayerVoiceFromSS } from \"../../redux/appReducer\";\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\troot: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\tmenuButton: {\r\n\t\tmarginRight: theme.spacing(2)\r\n\t},\r\n\ttitle: {\r\n\t\tflexGrow: 1\r\n\t}\r\n}));\r\n\r\nfunction isWSOpen(ws) {\r\n\treturn ws.readyState === 1\r\n}\r\n\r\nconst readPlayerFromPlayerList = (\r\n\tbuffer,\r\n\tstartOffset,\r\n\thasPosition = false\r\n) => {\r\n\tconst userUUIDLen = hasPosition === true ? 0 : 36;\r\n\r\n\tlet uuid = \"\";\r\n\tif (hasPosition === false) {\r\n\t\tbuffer.offset = startOffset;\r\n\t\tuuid = buffer.readUtf8String(userUUIDLen);\r\n\t}\r\n\tbuffer.offset = startOffset + userUUIDLen + 0;\r\n\tconst id = buffer.readUInt32LE();\r\n\r\n\tconst position = {\r\n\t\tx: 0,\r\n\t\ty: 0,\r\n\t\tz: 0,\r\n\t};\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 0;\r\n\tposition.x = buffer.readFloatLE();\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 4;\r\n\tposition.y = buffer.readFloatLE();\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 8;\r\n\tposition.z = buffer.readFloatLE();\r\n\r\n\tbuffer.offset = startOffset + userUUIDLen + 4 + 12;\r\n\tconst state = buffer.readUInt8();\r\n\r\n\treturn {\r\n\t\tuuid: uuid,\r\n\t\tid: id,\r\n\t\tposition: position,\r\n\t\tstate: state,\r\n\t};\r\n};\r\n\r\n\r\nlet outputPlayerVoice = blobForPlay => {\r\n\tconst outputBlob = new Blob([blobForPlay], {\r\n\t\ttype: \"audio/webm;codecs=opus\",\r\n\t});\r\n\r\n\tconst fileReader = new FileReader();\r\n\tfileReader.readAsDataURL(outputBlob);\r\n\tfileReader.onloadend = () => {\r\n\t\tconst base64String = fileReader.result;\r\n\t\tconst audio = new Audio(base64String);\r\n\t\taudio.addEventListener('canplaythrough', () => {\r\n\t\t\taudio.play();\r\n\t\t})\r\n\t};\r\n}\r\n\r\nexport default function NavBar() {\r\n\tconst classes = useStyles();\r\n\r\n\tconst [connected, setConnected] = useState(false);\r\n\r\n\tconst dispatch = useDispatch();\r\n\tconst { linkForSS, sessionTokenForSS, userUUIDForSS } = useContext(WSSSContext)\r\n\r\n\r\n\r\n\r\n\t//get soundPacket\r\n\r\n\tconst onVoiceChat = useSelector(state => state.app.onDialog)\r\n\tconst audioFromPlayer = useSelector(state => state.app.outputPlayerVoiceFromClient)\r\n\r\n\r\n\tuseEffect(() => {\r\n\r\n\r\n\t\tstart();\r\n\r\n\t\tfunction start() {\r\n\t\t\tlet webSocketSS = linkForSS ? new WebSocket(linkForSS) : console.log('Fetching the link...');\r\n\t\t\twebSocketSS.binaryType = \"arraybuffer\";\r\n\r\n\t\t\t// webSocketSS.onopen = () => {\r\n\t\t\t// \tconsole.log('Sound Server WebSocket is connected and its state is ' + webSocketSS.readyState);\r\n\t\t\t// \tconsole.log('Websocket open status is => ', opened);\r\n\r\n\t\t\t// \tconst array = new Uint8Array(4 + 36 + 1 + 36);\r\n\r\n\t\t\t// \tconst methodBuffer = new Uint8Array(\r\n\t\t\t// \t\tnew Uint32Array([ToGetway_FromUnknown_AuthSocket]).buffer\r\n\t\t\t// \t);\r\n\t\t\t// \tconst sessionBuffer = new TextEncoder().encode(\r\n\t\t\t// \t\tsessionTokenForSS\r\n\t\t\t// \t);\r\n\t\t\t// \tconst authType = new Uint8Array(\r\n\t\t\t// \t\tnew Uint32Array(1).buffer\r\n\t\t\t// \t);\r\n\t\t\t// \tconst targetUUID = new TextEncoder().encode(\r\n\t\t\t// \t\tuserUUIDForSS\r\n\t\t\t// \t);\r\n\r\n\t\t\t// \tarray.set(methodBuffer, 0);\r\n\t\t\t// \tarray.set(sessionBuffer, 4);\r\n\t\t\t// \tarray.set(authType, 40);\r\n\t\t\t// \tarray.set(targetUUID, 41);\r\n\r\n\t\t\t// \tif (!isWSOpen(webSocketSS)) return\r\n\t\t\t// \twebSocketSS.send(array);\r\n\t\t\t// };\r\n\r\n\r\n\t\t\twebSocketSS.onopen = () => {\r\n\r\n\t\t\t\tAxios.get('https://getway.dev.viexpo.ru/api/account/fake/get').then((res) => {\r\n\t\t\t\t\tconst sessionUUID = res.data.response.session_uuid\r\n\t\t\t\t\tconst array = new Uint8Array(4 + 36 + 1 + 36)\r\n\r\n\t\t\t\t\tconst methodBuffer = new Uint8Array(new Uint32Array([ToGetway_FromUnknown_AuthSocket]).buffer)\r\n\t\t\t\t\tconst sessionBuffer = new TextEncoder().encode(sessionUUID)\r\n\t\t\t\t\tconst locationUUIDBuffer = new TextEncoder().encode(\"123456789012345678901234567890123456\") // 36 LEN\r\n\r\n\t\t\t\t\tarray.set(methodBuffer, 0)\r\n\t\t\t\t\tarray.set(sessionBuffer, 4)\r\n\t\t\t\t\tarray.set(new Uint8Array([0]), 4 + 36)\r\n\t\t\t\t\tarray.set(locationUUIDBuffer, 4 + 36 + 1)\r\n\r\n\t\t\t\t\twebSocketSS.send(array);\r\n\r\n\t\t\t\t\tif (webSocketSS.readyState === 1) {\r\n\t\t\t\t\t\tsetConnected(true)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t};\r\n\r\n\t\t\twebSocketSS.onmessage = buffer => {\r\n\r\n\t\t\t\tconst message = new BufferStream(buffer.data);\r\n\t\t\t\tmessage.offset = 0;\r\n\t\t\t\tconst method = message.readInt32LE();\r\n\t\t\t\tswitch (method) {\r\n\t\t\t\t\tcase FromMovement_FromPlayerScene_PlayerList:\r\n\t\t\t\t\t\tmessage.offset = 4;\r\n\t\t\t\t\t\tconst countPlayers = message.readUInt32LE();\r\n\r\n\t\t\t\t\t\tconst users = [];\r\n\t\t\t\t\t\tfor (let index = 0; index < countPlayers; index++) {\r\n\t\t\t\t\t\t\tconst user = readPlayerFromPlayerList(\r\n\t\t\t\t\t\t\t\tmessage,\r\n\t\t\t\t\t\t\t\t4 /* Method */ +\r\n\t\t\t\t\t\t\t\t4 /* Count */ +\r\n\t\t\t\t\t\t\t\tindex *\r\n\t\t\t\t\t\t\t\t(36 /* UUID */ +\r\n\t\t\t\t\t\t\t\t\t4 /* ID */ +\r\n\t\t\t\t\t\t\t\t\t(4 + 4 + 4) /* Position */ +\r\n\t\t\t\t\t\t\t\t\t1) /* Flags */\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tusers.push(user);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconsole.log(JSON.stringify(users));\r\n\r\n\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\"Method: FromMovement_FromPlayerScene_PlayerList, count: \" +\r\n\t\t\t\t\t\t\tcountPlayers,\r\n\t\t\t\t\t\t\tusers\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconsole.log('Sound Server WebSocket state is ' + webSocketSS.readyState);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase FromMovement_FromPlayerScene_PlayerJoin:\r\n\t\t\t\t\t\tconst user = readPlayerFromPlayerList(message, 4);\r\n\t\t\t\t\t\tconsole.log(\"User Join: \" + user.uuid);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase FromMovement_FromPlayerScene_PlayerLeave:\r\n\t\t\t\t\t\tmessage.offset = 4;\r\n\t\t\t\t\t\tconst uuid = message.readUtf8String(36);\r\n\t\t\t\t\t\tconsole.log(\"User Leave: \" + uuid);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase FromSound_FromPlayerScene_PlayerVoice:\r\n\t\t\t\t\t\tconst user_from_voice = readPlayerFromPlayerList(message, 4, true);\r\n\t\t\t\t\t\t// Parse Voice Body\r\n\t\t\t\t\t\tconst voiceBody = new Uint8Array(message.buffer.buffer, 21);\r\n\t\t\t\t\t\t// Play Voice Body\r\n\t\t\t\t\t\toutputPlayerVoice(voiceBody);\r\n\t\t\t\t\t\t// dispatch(setOutputPlayerVoiceFromSS(voiceBody))\r\n\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\"FromSound_FromPlayerScene_PlayerVoice => \",\r\n\t\t\t\t\t\t\tuser_from_voice\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.log(\"Method: Unknown\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(\"WebSocket message received:\", method);\r\n\r\n\t\t\t};\r\n\r\n\t\t\twebSocketSS.onclose = (e) => {\r\n\t\t\t\tconsole.log('Sound Server Socket closed. Trying to reconnect...');\r\n\t\t\t\tconsole.log('Server closed with code => ', e.code);\r\n\r\n\t\t\t\tif (webSocketSS.readyState !== 1) {\r\n\t\t\t\t\tsetConnected(false)\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tstart()\r\n\t\t\t\t\tconsole.log(webSocketSS.readyState);\r\n\t\t\t\t}, 1000);\r\n\r\n\t\t\t}\r\n\r\n\t\t\twebSocketSS.onerror = (err) => {\r\n\t\t\t\tconsole.log('This error happened => ', err);\r\n\t\t\t\twebSocketSS.close()\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\t// if (audioFromPlayer) {\r\n\t\t\t// \tsendPlayerTick({ x: 0, y: 0, z: 0 }, 0, audioFromPlayer)\r\n\t\t\t// \tdispatch(setOutputPlayerVoiceFromClient(null))\r\n\t\t\t// }\r\n\r\n\t\t\tlet sendPlayerTick = (\r\n\t\t\t\tposition,\r\n\t\t\t\tstate,\r\n\t\t\t\tvoiceBody\r\n\t\t\t) => {\r\n\r\n\t\t\t\tconsole.log('the voice body is ', position,\r\n\t\t\t\t\tstate,\r\n\t\t\t\t\tvoiceBody);\r\n\r\n\t\t\t\tconst array = new Uint8Array(4 + 12 + 1 + voiceBody.byteLength);\r\n\r\n\t\t\t\tconst methodBuffer = new Uint8Array(new Uint32Array([ToMovement_ToPlayerScene_PlayerTick]).buffer\r\n\t\t\t\t);\r\n\r\n\t\t\t\tarray.set(methodBuffer, 0); // before 0, after 4\r\n\r\n\t\t\t\tarray.set(new Uint8Array(new Float32Array([position.x]).buffer), 4); // before 4, after 8\r\n\t\t\t\tarray.set(new Uint8Array(new Float32Array([position.y]).buffer), 4 + 4); // before 8, after 12\r\n\t\t\t\tarray.set(new Uint8Array(new Float32Array([position.z]).buffer), 4 + 8); // before 12, after 16\r\n\r\n\t\t\t\tarray.set(new Uint8Array([state]), 4 + 12); // before 16, after 17\r\n\r\n\t\t\t\tarray.set(voiceBody, 4 + 12 + 1); // before 17, after 4\r\n\r\n\t\t\t\tif (!isWSOpen(webSocketSS)) return\r\n\t\t\t\twebSocketSS.send(array)\r\n\t\t\t};\r\n\r\n\t\t\twindow.sendPlayerTick = audioChunk => sendPlayerTick({ x: 0, y: 0, z: 0 }, 0, audioChunk)\r\n\r\n\r\n\t\t};\r\n\r\n\r\n\r\n\t}, [linkForSS]);\r\n\r\n\r\n\treturn (\r\n\t\t<div className={classes.root}>\r\n\t\t\t<AppBar position=\"static\">\r\n\t\t\t\t<Toolbar>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tedge=\"start\"\r\n\t\t\t\t\t\tclassName={classes.menuButton}\r\n\t\t\t\t\t\tcolor=\"inherit\"\r\n\t\t\t\t\t\taria-label=\"menu\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<MenuIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t<Typography variant=\"h6\" className={classes.title}>\r\n\t\t\t\t\t\tConnection Status:\r\n\t\t\t\t\t\t{connected ? ' Connected!' : ' Disconnected!'}\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<Button color=\"inherit\" /* onClick={handleConnect} */>AChat Connection</Button>\r\n\t\t\t\t</Toolbar>\r\n\t\t\t</AppBar>\r\n\t\t</div>\r\n\t);\r\n}\r\n","export const getWayWebSocket = \"wss://getway.dev.viexpo.ru:8010\";\r\n// export const webSocketClient = \"wss://getway.dev.viexpo.ru:10010\";\r\n\r\n\r\nexport const CONST_X_VIEXPO_INTERNAL_TOKEN = 'x-viexpo-internal-token-test'\r\nexport const CONST_X_VIEXPO_SESSION_TOKEN_BODY = 'x-viexpo-session-token'\r\n\r\nexport const ToGetway_FromUnknown_AuthSocket = 0;\r\nexport const FromGetway_AuthSocket_Response = 1;\r\nexport const ToGetway_FromInternal_GetUser = 2;\r\nexport const ToGetway_FromInternal_GetUserFromSession = 3;\r\nexport const FromGetway_ToInternal_GetUserResponse = 4;\r\nexport const ToGetway_FromPlayer_GetMovementServer = 5;\r\nexport const FromGetway_FromPlayer_GetMovementServerResponse = 6;\r\nexport const ToGetway_FromPlayer_GetSoundServer = 7;\r\nexport const FromGetway_FromPlayer_GetSoundServerResponse = 8;\r\n\r\n\r\nexport const ToMovement_ToPlayerScene_PlayerTick = 9991;\r\nexport const FromMovement_FromPlayerScene_PlayerJoin = 9992;\r\nexport const FromMovement_FromPlayerScene_PlayerLeave = 9993;\r\nexport const FromMovement_FromPlayerScene_PlayerList = 9994;\r\nexport const FromMovement_FromPlayerScene_PlayerPosition = 9995;\r\nexport const FromSound_FromPlayerScene_PlayerVoice = 9996;\r\n\r\nexport const timeInterval = 1000;\r\n\r\n","import React, { useState, useRef, useEffect, useMemo, useCallback } from \"react\";\r\nimport { ReactMic } from \"react-mic\";\r\nimport WaveSurfer from \"wavesurfer\";\r\n\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport MicIcon from \"@material-ui/icons/Mic\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport StopIcon from \"@material-ui/icons/Stop\";\r\nimport ReplayIcon from \"@material-ui/icons/Replay\";\r\nimport FiberManualRecordIcon from \"@material-ui/icons/FiberManualRecord\";\r\nimport DoneIcon from \"@material-ui/icons/Done\";\r\nimport CancelIcon from \"@material-ui/icons/Cancel\";\r\nimport PlayArrowIcon from \"@material-ui/icons/PlayArrow\";\r\nimport PauseIcon from \"@material-ui/icons/Pause\";\r\n\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport { green, red, blue } from \"@material-ui/core/colors\";\r\n\r\nimport \"./microphone.css\";\r\nimport { Card } from \"@material-ui/core\";\r\nimport { sendPlayerTick } from \"../../socket/serverConnection\";\r\nimport { setOutputPlayerVoiceFromClient, toggleOnDialog } from \"../../redux/appReducer\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\ticon: {\r\n\t\theight: 38,\r\n\t\twidth: 38\r\n\t},\r\n\treactmic: {\r\n\t\twidth: \"50%\",\r\n\t\theight: 30\r\n\t},\r\n\twavesurfer: {\r\n\t\twidth: \"50%\",\r\n\t\tmargin: \"0 auto\"\r\n\t},\r\n\tflex: {\r\n\t\tflex: 1\r\n\t}\r\n}));\r\n\r\nexport default function Microphone({ pushFile, setCurrentAvatarId }) {\r\n\r\n\tconst dispatch = useDispatch();\r\n\r\n\tconst [record, setRecord] = useState(false);\r\n\tconst [open, setOpen] = useState(false);\r\n\tconst [stopRecord, setStopRecord] = useState(true)\r\n\t// const [audioChunks, setAudioChunks] = useState([]);\r\n\r\n\tlet audioChunks = [];\r\n\r\n\tconst [playerReady, setPlayerReady] = useState(false);\r\n\tconst [isPlaying, setIsPlaying] = useState(false);\r\n\tconst wavesurfer = useRef(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (stopRecord) return\r\n\r\n\r\n\t\tnavigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {\r\n\t\t\tconst mediaRecorder = new window.MediaRecorder(stream);\r\n\t\t\tlet audioChunks = [];\r\n\t\t\tconsole.log(stream.getAudioTracks());\r\n\t\t\tmediaRecorder.start();\r\n\t\t\twindow.str = stream\r\n\r\n\t\t\tmediaRecorder.addEventListener(\r\n\t\t\t\t\"dataavailable\",\r\n\t\t\t\t(event) => {\r\n\t\t\t\t\taudioChunks.push(event.data);\r\n\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tmediaRecorder.addEventListener(\"stop\", () => {\r\n\r\n\r\n\t\t\t\tif (audioChunks.length > 0) {\r\n\r\n\t\t\t\t\tconst mimeType = audioChunks[0].type;\r\n\t\t\t\t\tconst audioBlob = new Blob(audioChunks, { type: mimeType });\r\n\r\n\t\t\t\t\taudioBlob.arrayBuffer().then((arrayBuffer) => {\r\n\t\t\t\t\t\tconst audioBuffer = new Uint8Array(arrayBuffer);\r\n\r\n\t\t\t\t\t\twindow.sendPlayerTick(audioBuffer);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\taudioChunks = [];\r\n\r\n\t\t\t\tif (window.str !== null) {\r\n\t\t\t\t\tmediaRecorder.start();\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tif (mediaRecorder.state !== 'inactive') {\r\n\t\t\t\t\t\t\tmediaRecorder.stop();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 1000);\r\n\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (mediaRecorder.state !== 'inactive') {\r\n\t\t\t\t\tmediaRecorder.stop();\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t}, 1000);\r\n\r\n\r\n\t\t});\r\n\r\n\r\n\t}, [record, stopRecord])\r\n\r\n\tconst continueRecording = () => {\r\n\t\tsetRecord(true);\r\n\r\n\r\n\t};\r\n\r\n\r\n\tconst startRecording = () => {\r\n\t\tsetRecord(true)\r\n\t\tsetStopRecord(false)\r\n\t};\r\n\r\n\tconst stopRecording = () => {\r\n\t\tsetRecord(false);\r\n\r\n\t\t// console.log(btnIsClicked, record, ' on stop');\r\n\t};\r\n\tfunction stopStream() {\r\n\t\tif (!window.streamReference) return;\r\n\r\n\t\twindow.streamReference.getAudioTracks().forEach(function (track) {\r\n\t\t\ttrack.stop();\r\n\t\t});\r\n\r\n\t\twindow.streamReference.getVideoTracks().forEach(function (track) {\r\n\t\t\ttrack.stop();\r\n\t\t});\r\n\r\n\t\twindow.streamReference = null;\r\n\t}\r\n\tconst totallyStop = () => {\r\n\t\tsetRecord(false);\r\n\t\tsetStopRecord(true);\r\n\t\twindow.str.getAudioTracks().forEach(function (track) {\r\n\t\t\ttrack.stop();\r\n\t\t});\r\n\t\twindow.str = null;\r\n\t}\r\n\r\n\tconst onData = recordedBlob => {\r\n\r\n\t};\r\n\r\n\tconst onStop = () => {\r\n\r\n\t};\r\n\r\n\r\n\r\n\tconst classes = useStyles();\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Grid container justify=\"center\">\r\n\t\t\t\t<Grid item>\r\n\r\n\t\t\t\t\t{!record && stopRecord ?\r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t<IconButton onClick={startRecording}>\r\n\t\t\t\t\t\t\t\t<MicIcon className={classes.icon} />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t<IconButton onClick={totallyStop}>\r\n\t\t\t\t\t\t\t<MicIcon className={classes.icon} />\r\n\t\t\t\t\t\t</IconButton>}\r\n\r\n\r\n\t\t\t\t</Grid>\r\n\t\t\t</Grid>\r\n\t\t\t<Card >\r\n\t\t\t\t<DialogTitle className={classes.flex}>Open Micro</DialogTitle>\r\n\t\t\t\t<DialogContent>\r\n\r\n\t\t\t\t\t<div />\r\n\t\t\t\t\t<ReactMic\r\n\t\t\t\t\t\trecord={record}\r\n\t\t\t\t\t\tclassName={classes.reactmic}\r\n\t\t\t\t\t\tvisualSetting=\"frequencyBars\"\r\n\t\t\t\t\t\techoCancellation={true}\r\n\t\t\t\t\t\tnoiseSuppression={true}\r\n\t\t\t\t\t\tonStop={onStop}\r\n\t\t\t\t\t\tonData={onData}\r\n\t\t\t\t\t\tstrokeColor=\"green\"\r\n\t\t\t\t\t\tbackgroundColor=\"white\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</DialogContent>\r\n\t\t\t\t<DialogActions>\r\n\t\t\t\t\t<Grid container>\r\n\t\t\t\t\t\t<Grid item container justify=\"center\" xs={12}>\r\n\t\t\t\t\t\t\t{!record && stopRecord && (\r\n\t\t\t\t\t\t\t\t<IconButton onClick={startRecording}>\r\n\t\t\t\t\t\t\t\t\t<FiberManualRecordIcon\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ color: red[500] }}\r\n\t\t\t\t\t\t\t\t\t\tclassName={classes.icon}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{record && !stopRecord && (\r\n\t\t\t\t\t\t\t\t<IconButton onClick={totallyStop}>\r\n\t\t\t\t\t\t\t\t\t<StopIcon className={classes.icon} />\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\r\n\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</DialogActions>\r\n\t\t\t</Card>\r\n\t\t</>\r\n\t);\r\n}\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport WaveSurfer from \"wavesurfer\";\r\nimport uuidv4 from \"uuid/v4\";\r\n\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardMedia from \"@material-ui/core/CardMedia\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport PlayArrowIcon from \"@material-ui/icons/PlayArrow\";\r\nimport StopIcon from \"@material-ui/icons/Stop\";\r\nimport ChatBubbleIcon from \"@material-ui/icons/ChatBubble\";\r\nimport ShareIcon from \"@material-ui/icons/Share\";\r\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\r\nimport { green, red, blue } from \"@material-ui/core/colors\";\r\n\r\nimport PauseIcon from \"@material-ui/icons/Pause\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\r\n\r\n// const faces = [\r\n// \t\"http://i.pravatar.cc/300?img=1\",\r\n// \t\"http://i.pravatar.cc/300?img=2\",\r\n// \t\"http://i.pravatar.cc/300?img=3\",\r\n// \t\"http://i.pravatar.cc/300?img=4\"\r\n// ];\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\tcard: {\r\n\t\tmaxWidth: 600,\r\n\t\tminWidth: 240,\r\n\t\tmargin: \"20px auto 0\",\r\n\t\ttransition: \"0.3s\",\r\n\t\tboxShadow: \"0 8px 40px -12px rgba(0,0,0,0.3)\",\r\n\t\t\"&:hover\": {\r\n\t\t\tboxShadow: \"0 16px 70px -12.125px rgba(0,0,0,0.3)\"\r\n\t\t}\r\n\t},\r\n\tmedia: {\r\n\t\twidth: \"100%\"\r\n\t},\r\n\tlist: {\r\n\t\tpadding: 0\r\n\t},\r\n\tlistItem: {\r\n\t\t//paddingBottom: 0\r\n\t},\r\n\tbuttons: {\r\n\t\tpadding: theme.spacing(1)\r\n\t},\r\n\tcontrols: {\r\n\t\tminWidth: \"100px\"\r\n\t},\r\n\ticon: {\r\n\t\theight: 18,\r\n\t\twidth: 18\r\n\t},\r\n\tavatar: {\r\n\t\tdisplay: \"inline-block\"\r\n\t}\r\n}));\r\n\r\nfunction AudioPlayer({ file, currentAvatarId }) {\r\n\tconst wavesurfer = useRef(null);\r\n\r\n\r\n\tconst [playerReady, setPlayerReady] = useState(false);\r\n\tconst [isPlaying, setIsPlaying] = useState(false);\r\n\tconst wavesurferId = `wavesurfer--${uuidv4()}`;\r\n\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tif (file) {\r\n\t\t\twavesurfer.current = WaveSurfer.create({\r\n\t\t\t\tcontainer: `#${wavesurferId}`,\r\n\t\t\t\twaveColor: \"grey\",\r\n\t\t\t\tprogressColor: \"tomato\",\r\n\t\t\t\theight: 70,\r\n\t\t\t\tcursorWidth: 1,\r\n\t\t\t\tcursorColor: \"lightgray\",\r\n\t\t\t\tbarWidth: 2,\r\n\t\t\t\tnormalize: true,\r\n\t\t\t\tresponsive: true,\r\n\t\t\t\tfillParent: true\r\n\t\t\t});\r\n\r\n\t\t\tconst wav = file;\r\n\r\n\t\t\t// console.log(\"wav\", wav);\r\n\t\t\twavesurfer.current.load(wav);\r\n\r\n\t\t\twavesurfer.current.on(\"ready\", () => {\r\n\t\t\t\tsetPlayerReady(true);\r\n\t\t\t});\r\n\r\n\t\t\tconst handleResize = wavesurfer.current.util.debounce(() => {\r\n\t\t\t\twavesurfer.current.empty();\r\n\t\t\t\twavesurfer.current.drawBuffer();\r\n\t\t\t}, 150);\r\n\r\n\t\t\twavesurfer.current.on(\"play\", () => setIsPlaying(true));\r\n\t\t\twavesurfer.current.on(\"pause\", () => setIsPlaying(false));\r\n\t\t\twindow.addEventListener(\"resize\", handleResize, false);\r\n\t\t}\r\n\t}, [file]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconsole.log(\"file\", file);\r\n\t\tif (file) {\r\n\t\t\twavesurfer.current.load(file.blobURL);\r\n\t\t}\r\n\t}, [file]);\r\n\r\n\tconst togglePlayback = () => {\r\n\t\tif (!isPlaying) {\r\n\t\t\twavesurfer.current.play();\r\n\t\t} else {\r\n\t\t\twavesurfer.current.pause();\r\n\t\t}\r\n\t};\r\n\r\n\tconst stopPlayback = () => wavesurfer.current.stop();\r\n\r\n\tconst classes = useStyles();\r\n\r\n\tlet transportPlayButton;\r\n\r\n\tif (!isPlaying) {\r\n\t\ttransportPlayButton = (\r\n\t\t\t<IconButton onClick={togglePlayback}>\r\n\t\t\t\t<PlayArrowIcon className={classes.icon} />\r\n\t\t\t</IconButton>\r\n\t\t);\r\n\t} else {\r\n\t\ttransportPlayButton = (\r\n\t\t\t<IconButton onClick={togglePlayback}>\r\n\t\t\t\t<PauseIcon className={classes.icon} />\r\n\t\t\t</IconButton>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{file && <Card className={classes.card}>\r\n\t\t\t\t<Grid container direction=\"column\">\r\n\t\t\t\t\t<Grid item>\r\n\t\t\t\t\t\t<List className={classes.list}>\r\n\t\t\t\t\t\t\t<ListItem alignItems=\"flex-start\" className={classes.listItem}>\r\n\t\t\t\t\t\t\t\t<ListItemAvatar>\r\n\t\t\t\t\t\t\t\t\t<Avatar className={classes.avatar} src={`http://i.pravatar.cc/300?img=${currentAvatarId}`} />\r\n\t\t\t\t\t\t\t\t</ListItemAvatar>\r\n\t\t\t\t\t\t\t\t<ListItemText\r\n\t\t\t\t\t\t\t\t\tprimary=\"Username\"\r\n\t\t\t\t\t\t\t\t\tsecondary=\"@username Â· 2h ago\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t<Grid item id={wavesurferId} />\r\n\t\t\t\t\t<Grid item container className={classes.buttons}>\r\n\t\t\t\t\t\t<Grid item xs={5}>\r\n\t\t\t\t\t\t\t{transportPlayButton}\r\n\t\t\t\t\t\t\t<IconButton onClick={stopPlayback}>\r\n\t\t\t\t\t\t\t\t<StopIcon className={classes.icon} />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t<Grid item xs={7} container justify=\"space-around\">\r\n\t\t\t\t\t\t\t<Grid item>\r\n\t\t\t\t\t\t\t\t<IconButton>\r\n\t\t\t\t\t\t\t\t\t<FavoriteIcon\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ color: blue[500] }}\r\n\t\t\t\t\t\t\t\t\t\tclassName={classes.icon}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t<Grid item>\r\n\t\t\t\t\t\t\t\t<IconButton>\r\n\t\t\t\t\t\t\t\t\t<ShareIcon\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ color: red[500] }}\r\n\t\t\t\t\t\t\t\t\t\tclassName={classes.icon}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t<Grid item>\r\n\t\t\t\t\t\t\t\t<IconButton>\r\n\t\t\t\t\t\t\t\t\t<ChatBubbleIcon\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ color: green[500] }}\r\n\t\t\t\t\t\t\t\t\t\tclassName={classes.icon}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</Grid>\r\n\t\t\t</Card>}\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default AudioPlayer;\r\n","import { createStore, combineReducers, applyMiddleware, compose } from 'redux'\r\nimport thunkMiddleware from 'redux-thunk'\r\n\r\nimport { appReducer } from './appReducer';\r\n\r\n\r\nlet reducers = combineReducers(\r\n\t{\r\n\t\tapp: appReducer\r\n\t}\r\n)\r\n\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\nconst store = createStore(reducers, composeEnhancers(applyMiddleware(thunkMiddleware)));\r\n\r\nwindow.__store__ = store;\r\n\r\nexport default store;\r\n","export default __webpack_public_path__ + \"static/media/preloader.e40a641e.gif\";","import React from 'react'\r\nimport preloader from '../../../assets/src/preloader/preloader.gif'\r\n\r\n\r\nexport const Preloader = () => {\r\n\r\n\r\n\treturn (\r\n\t\t<div className=\"lds-facebook\">\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t</div>\r\n\t)\r\n}","import { useCallback, useContext, useEffect, useMemo, useState } from 'react';\nimport './App.css';\n\nimport Grid from \"@material-ui/core/Grid\";\n\nimport NavBar from \"./components/common/navbar/NavBar\";\nimport Microphone from \"./components/common/microphone/Microphone\";\nimport AudioPlayer from \"./components/common/audioPlayer/AudioPlayer\";\nimport { useDispatch, useSelector } from 'react-redux'\n// import { startRec, stopRec } from './components/micRecorder/mainRecorderSettings';\nimport { getWayConnection } from './components/socket/getWayConnect';\nimport { sendPlayerTick } from './components/socket/serverConnection';\nimport { Preloader } from './components/common/preloader/Preloader'\nimport { getWayWebSocket } from './components/socket/constatns';\nimport { WSSSContext } from './utils/Context';\nimport { setLinkForSS, setSessionUserUUID } from './components/redux/appReducer';\n\n\nfunction App() {\n\n  const dispatch = useDispatch();\n\n  const [loadinglink, setLoaded] = useState(false);\n\n  const [contextWSSS, setContextWSSS] = useState({\n    linkForSS: '',\n    sessionTokenForSS: '',\n    userUUIDForSS: ''\n  })\n\n  //git initial data for SS\n  const linkIsFetched = useSelector(state => state.app.linkIsFetched)\n  const linkForSS = useSelector(state => state.app.linkForSS)\n  const sessionTokenForSS = useSelector(state => state.app.sessionToken)\n  const userUUIDForSS = useSelector(state => state.app.userUUID)\n\n  useMemo(() => {\n    dispatch(setLinkForSS);\n    dispatch(setSessionUserUUID);\n    setContextWSSS({ linkForSS: linkForSS, sessionTokenForSS: sessionTokenForSS, userUUIDForSS: userUUIDForSS })\n\n  }, [linkForSS, sessionTokenForSS, userUUIDForSS])\n\n  useCallback(() => { }, [])\n\n  useEffect(() => {\n    getWayConnection(getWayWebSocket)\n  }, [])\n\n\n  useMemo(() => {\n    setLoaded(linkIsFetched)\n  }, [linkIsFetched]);\n\n  useEffect(() => {\n\n  }, [])\n\n\n  const [files, setFiles] = useState([]);\n  const [currentAvatarId, setCurrentAvatarId] = useState(0)\n\n  const pushFile = file => {\n    setFiles([...files, file]);\n  };\n\n  return (\n    <WSSSContext.Provider value={contextWSSS}>\n      <div className=\"home\" style={{ textAlign: \"center\" }}>\n        {!loadinglink\n          ?\n          <Preloader />\n          :\n          <div>\n            <NavBar\n\n            />\n            <Microphone pushFile={pushFile} setCurrentAvatarId={setCurrentAvatarId} />\n            <Grid container direction=\"column\" spacing={3}>\n              {files.map((file, index) => (\n                <Grid key={index} item>\n                  <AudioPlayer file={file} currentAvatarId={currentAvatarId} />\n                </Grid>\n              ))}\n            </Grid>\n          </div>\n\n        }\n      </div>\n    </WSSSContext.Provider>\n  );\n}\n\nexport default App;\n","import { setLinkForSS, setSessionUserUUID } from '../redux/appReducer';\r\nimport store from '../redux/store'\r\nimport {\r\n\tToGetway_FromUnknown_AuthSocket,\r\n\tFromGetway_AuthSocket_Response,\r\n\tToGetway_FromPlayer_GetSoundServer,\r\n\tFromGetway_FromPlayer_GetSoundServerResponse\r\n} from \"./constatns.js\";\r\n\r\n\r\nexport function getWayConnection(link) {\r\n\r\n\tconst newWS = new WebSocket(link);\r\n\r\n\tconnect();\r\n\r\n\tfunction connect() {\r\n\t\tnewWS.onopen = () => {\r\n\t\t\tconsole.log('GetWay Socket connected');\r\n\t\t\tnewWS.send(JSON.stringify({ method: ToGetway_FromUnknown_AuthSocket, token: \"0e1e703b-059b-4d3d-b275-3fc36ea4e8c4\", type: 1 }))\r\n\t\t}\r\n\t\tnewWS.onmessage = (data) => {\r\n\t\t\tlet dataFromGetWay = JSON.parse(data.data);\r\n\t\t\tconsole.log(dataFromGetWay);\r\n\r\n\t\t\tif (dataFromGetWay.method != undefined) {\r\n\t\t\t\tswitch (dataFromGetWay.method) {\r\n\r\n\t\t\t\t\tcase FromGetway_AuthSocket_Response:\r\n\t\t\t\t\t\tconsole.log(dataFromGetWay.user.session_uuid, dataFromGetWay.user.user_uuid);\r\n\t\t\t\t\t\tstore.dispatch(setSessionUserUUID(dataFromGetWay.user.session_uuid, dataFromGetWay.user.user_uuid))\r\n\t\t\t\t\t\tnewWS.send(JSON.stringify({ method: ToGetway_FromPlayer_GetSoundServer, company_uuid: '1' }))\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase FromGetway_FromPlayer_GetSoundServerResponse:\r\n\t\t\t\t\t\tlet link = `wss://${dataFromGetWay.ip}:${dataFromGetWay.port}`;\r\n\t\t\t\t\t\tstore.dispatch(setLinkForSS(link))\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.log('Unexpected method');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tnewWS.onclose = () => {\r\n\t\t\tconsole.log('Sound Server Socket closed. trying to reconnect...');\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tconnect()\r\n\t\t\t}, 1000);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n// export const getWayConnection = () => {\r\n// let res;\r\n// let interval = 100;\r\n// let timerId = setTimeout(() => {\r\n// \tif (soundServResponse === undefined) {\r\n// \t\tgetWayConnection()\r\n// \t} else {\r\n// \t\tclearTimeout(timerId)\r\n// \t\tconsole.log(soundServResponse);\r\n// \t\tres = soundServResponse.a\r\n// \t\treturn res;\r\n// \t}\r\n// }, interval);\r\n// }","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { Provider } from 'react-redux';\nimport store from './components/redux/store'\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}